{
  "version": 3,
  "sources": ["../../../../../infra/src/handlers/prompts.ts", "../../../../../infra/src/handlers/cors.ts", "../../../../../infra/src/handlers/common.ts", "../../../../../infra/src/lib/session.ts", "../../../../../infra/src/lib/ids.ts", "../../../../../infra/src/lib/dynamo.ts"],
  "sourcesContent": ["import { APIGatewayProxyEventV2 } from 'aws-lambda';\nimport { response } from './cors';\nimport { requireSession } from './common';\nimport { newId } from '../lib/ids';\nimport { putItem, queryByPK, getItem, deleteItem } from '../lib/dynamo';\n\n// NOTE: In Node 18+ on AWS Lambda, 'fetch' is global. \n// If you are on Node 16 or older, ensure 'node-fetch' is installed and uncomment the import.\n// import fetch from 'node-fetch'; \n\nconst OPENAI_BASE = 'https://api.openai.com';\nconst OPENAI_KEY = process.env.OPENAI_KEY || '';\nconst MODEL = 'gpt-4o-mini';\n\n/**\n * Shared helper to call OpenAI with a conversation\n */\nasync function callOpenAI(messages: any[]) {\n  if (!OPENAI_KEY) throw new Error('OpenAI key not configured');\n\n  const res = await fetch(`${OPENAI_BASE}/v1/chat/completions`, {\n    method: 'POST',\n    headers: {\n      Authorization: `Bearer ${OPENAI_KEY}`,\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      model: MODEL,\n      messages,\n      temperature: 0.7,\n    }),\n  });\n\n  const text = await res.text();\n  if (!res.ok) {\n    console.error('openai.error', { status: res.status, body: text });\n    throw new Error(`OpenAI request failed (${res.status}): ${text || res.statusText}`);\n  }\n  \n  try {\n    const json = JSON.parse(text);\n    return json?.choices?.[0]?.message?.content || '';\n  } catch {\n    return '';\n  }\n}\n\nexport const handler = async (event: APIGatewayProxyEventV2) => {\n  const origin = event.headers?.origin || event.headers?.Origin || event.headers?.['origin'] || '';\n  const method = (event.requestContext.http?.method || '').toUpperCase();\n  const path = event.rawPath || event.requestContext.http?.path || '';\n\n  // 1. Handle CORS Preflight\n  if (method === 'OPTIONS') return response(200, { ok: true }, origin);\n\n  // 2. Require Session for ALL routes in this handler\n  const session = requireSession(event);\n  if (!session?.agencyId) {\n    return response(401, { ok: false, error: 'Missing session' }, origin);\n  }\n  const agencyEmail = (session as any).agencyEmail || '';\n\n\n  // =========================================================================\n  // ROUTE: AI Generation (Used by \"Run\" button)\n  // POST /ai/intro\n  // =========================================================================\n  if (method === 'POST' && path.endsWith('/ai/intro')) {\n    if (!event.body) return response(400, { ok: false, error: 'Missing body' }, origin);\n    const body = JSON.parse(event.body || '{}');\n    \n    // Destructure known fields from services/aiRecruiter.ts\n    const { sport, collegeName, coachMessage, tone, qualities = [], additionalInsights } = body;\n\n    // Construct the prompt messages\n    const systemMsg = `You are an expert college recruiting assistant. Write a concise, effective intro email for a high school athlete contacting a college coach. Keep it under 150 words.`;\n    \n    const userMsg = `\n      Context:\n      - Sport: ${sport || 'Not specified'}\n      - Target College: ${collegeName || 'Not specified'}\n      - Tone: ${tone || 'Professional yet personal'}\n      - Key Qualities to highlight: ${qualities.join(', ')}\n      \n      Instructions from User: ${coachMessage || 'Write an intro.'}\n      \n      Additional Data: ${additionalInsights || ''}\n      \n      Write the email body only. Do not include subject lines unless asked.\n    `.trim();\n\n    try {\n      const intro = await callOpenAI([\n        { role: 'system', content: systemMsg },\n        { role: 'user', content: userMsg }\n      ]);\n      return response(200, { ok: true, intro }, origin);\n    } catch (err: any) {\n      console.error('AI Gen Error:', err);\n      return response(500, { ok: false, error: 'AI generation failed' }, origin);\n    }\n  }\n\n\n  // =========================================================================\n  // ROUTE: List Prompts\n  // GET /prompts\n  // =========================================================================\n  if (method === 'GET' && path.endsWith('/prompts')) {\n    // 1. Fetch all prompts for this agency\n    const items = await queryByPK(`AGENCY#${session.agencyId}`, 'PROMPT#');\n    \n    // 2. Map raw Dynamo items to clean objects\n    let prompts = (items || []).map((p: any) => ({\n      id: p.id,\n      agencyEmail: p.agencyEmail,\n      clientId: p.clientId,\n      name: p.name,\n      text: p.text,\n      createdAt: p.createdAt,\n      updatedAt: p.updatedAt,\n    }));\n\n    // 3. Filter by clientId if requested (e.g. playground filtering for specific athlete)\n    const filterClientId = event.queryStringParameters?.clientId;\n    if (filterClientId) {\n      prompts = prompts.filter((p: any) => p.clientId === filterClientId);\n    }\n\n    return response(200, { ok: true, prompts }, origin);\n  }\n\n\n  // =========================================================================\n  // ROUTE: Save/Create Prompt\n  // POST /prompts\n  // =========================================================================\n  if (method === 'POST' && path.endsWith('/prompts')) {\n    if (!event.body) return response(400, { ok: false, error: 'Missing body' }, origin);\n    const body = JSON.parse(event.body || '{}');\n    let { name, text, clientId } = body;\n    \n    // Allow upsert if ID is provided, else new ID\n    const id = body.id || newId('prompt');\n    const now = Date.now();\n\n    // Legacy Support: Generate text on save if 'generate=true' passed (Optional)\n    if ((body.generate || !text)) {\n       // ... existing logic if you still use \"Generate on Save\" ...\n       // For now, we assume the UI uses /ai/intro to generate, then passes 'text' here to save.\n    }\n\n    if (!name || !text) {\n      return response(400, { ok: false, error: 'name and text are required' }, origin);\n    }\n\n    const rec = {\n      PK: `AGENCY#${session.agencyId}`,\n      SK: `PROMPT#${id}`,\n      GSI1PK: `EMAIL#${agencyEmail}`,\n      GSI1SK: `PROMPT#${id}`,\n      id,\n      agencyEmail,\n      clientId: clientId || null,\n      name,\n      text,\n      createdAt: body.createdAt || now, // Preserve creation date on update\n      updatedAt: now,\n    };\n\n    await putItem(rec);\n    return response(200, { ok: true, prompt: rec }, origin);\n  }\n\n\n  // =========================================================================\n  // ROUTE: Delete Prompt\n  // DELETE /prompts/{id}\n  // =========================================================================\n  if (method === 'DELETE' && /\\/prompts\\/[^/]+$/.test(path)) {\n    const id = path.split('/').pop(); // robust way to get ID from path\n    if (!id) return response(400, { ok: false, error: 'Missing id' }, origin);\n    \n    const existing = await getItem({ PK: `AGENCY#${session.agencyId}`, SK: `PROMPT#${id}` });\n    if (existing) {\n      await deleteItem({ PK: `AGENCY#${session.agencyId}`, SK: `PROMPT#${id}` });\n    }\n    return response(200, { ok: true }, origin);\n  }\n\n  return response(404, { ok: false, error: 'Path not found' }, origin);\n};", "export const ALLOWED_ORIGINS = [\n  'https://master.d2yp6hyv6u0efd.amplifyapp.com',\n  'https://myrecruiteragency.com',\n  'https://www.myrecruiteragency.com',\n  'http://localhost:3000',\n  'http://localhost:3001',\n];\n\nexport function buildCors(origin?: string) {\n  const allow = origin && ALLOWED_ORIGINS.includes(origin) ? origin : ALLOWED_ORIGINS[0];\n  return {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': allow,\n    'Access-Control-Allow-Credentials': 'true',\n    'Access-Control-Allow-Headers': 'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token',\n    'Access-Control-Allow-Methods': 'GET,POST,PUT,PATCH,DELETE,OPTIONS',\n  };\n}\n\nexport function response(statusCode: number, body: unknown, origin?: string, extraHeaders?: Record<string, string>) {\n  const cors = buildCors(origin);\n  return {\n    statusCode,\n    headers: { ...cors, ...(extraHeaders || {}) },\n    body: JSON.stringify(body),\n  };\n}\n\n", "import { APIGatewayProxyEventV2, APIGatewayProxyResultV2 } from 'aws-lambda';\nimport { DynamoDBClient } from '@aws-sdk/client-dynamodb';\nimport { DynamoDBDocumentClient } from '@aws-sdk/lib-dynamodb';\nimport { SessionContext } from '../lib/models';\nimport { parseSessionFromRequest } from '../lib/session';\n\nconst client = new DynamoDBClient({});\nexport const docClient = DynamoDBDocumentClient.from(client);\n\nconst DEBUG_SESSION = process.env.DEBUG_SESSION === 'true';\n\nexport type Handler = (event: APIGatewayProxyEventV2) => Promise<APIGatewayProxyResultV2>;\n\nexport function jsonResponse(statusCode: number, body: unknown): APIGatewayProxyResultV2 {\n  return {\n    statusCode,\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify(body),\n  };\n}\n\nexport function notImplemented(resource: string, method: string) {\n  return jsonResponse(501, { ok: false, message: `${method} ${resource} not implemented` });\n}\n\nexport function badRequest(message: string) {\n  return jsonResponse(400, { ok: false, message });\n}\n\nexport function ok(body: unknown) {\n  return jsonResponse(200, body);\n}\n\nexport function getSession(event: APIGatewayProxyEventV2): SessionContext | null {\n  const origin = event.headers?.origin || event.headers?.Origin || (event.headers as any)?.['origin'] || '';\n  const parsed = parseSessionFromRequest(event);\n  if (DEBUG_SESSION) {\n    console.log('session_debug', {\n      origin,\n      hasCookiesArray: Array.isArray(event.cookies) && event.cookies.length > 0,\n      hasCookieHeader: Boolean((event.headers as any)?.cookie || (event.headers as any)?.Cookie),\n      session: parsed,\n      method: event.requestContext?.http?.method,\n      path: event.rawPath,\n    });\n  }\n  if (parsed) return parsed;\n  // Fallback for temporary header-based dev mode\n  const agencyId = (event.headers['x-agency-id'] as string) || (event.headers['X-Agency-Id'] as string);\n  const agencyEmail = (event.headers['x-agency-email'] as string) || (event.headers['X-Agency-Email'] as string);\n  const role = (event.headers['x-role'] as SessionContext['role']) || 'agency';\n  if (!agencyId) return null;\n  const fallback = { agencyId, agencyEmail, role };\n  if (DEBUG_SESSION) {\n    console.log('session_debug_fallback', { origin, fallback });\n  }\n  return fallback;\n}\n\nexport function requireSession(event: APIGatewayProxyEventV2): SessionContext | null {\n  return getSession(event);\n}\n\n", "import { APIGatewayProxyEventV2 } from 'aws-lambda';\nimport { createHmac, timingSafeEqual } from 'crypto';\nimport { SessionContext } from './models';\n\nconst SECRET = process.env.SESSION_SECRET || 'dev-secret-change-me';\nconst COOKIE_NAME = 'an_session';\nconst COOKIE_DOMAIN = process.env.COOKIE_DOMAIN || '.myrecruiteragency.com';\n\nfunction sign(payload: string) {\n  const sig = createHmac('sha256', SECRET).update(payload).digest('base64url');\n  return `${payload}.${sig}`;\n}\n\nfunction verify(token: string) {\n  const idx = token.lastIndexOf('.');\n  if (idx < 0) return null;\n  const payload = token.slice(0, idx);\n  const sig = token.slice(idx + 1);\n  const expected = createHmac('sha256', SECRET).update(payload).digest('base64url');\n  const a = Buffer.from(sig);\n  const b = Buffer.from(expected);\n  if (a.length !== b.length || !timingSafeEqual(a, b)) return null;\n  try {\n    return JSON.parse(Buffer.from(payload, 'base64url').toString('utf8')) as SessionContext;\n  } catch {\n    return null;\n  }\n}\n\nexport function encodeSession(session: SessionContext) {\n  const payload = Buffer.from(JSON.stringify(session)).toString('base64url');\n  return sign(payload);\n}\n\nexport function parseSession(token?: string | null): SessionContext | null {\n  if (!token) return null;\n  return verify(token);\n}\n\nfunction parseCookie(header?: string): Record<string, string> {\n  if (!header) return {};\n  return header.split(';').reduce<Record<string, string>>((acc, part) => {\n    const [k, v] = part.trim().split('=');\n    if (k && v) acc[k] = v;\n    return acc;\n  }, {});\n}\n\nfunction readCookieString(event: APIGatewayProxyEventV2): string | undefined {\n  if (event.cookies && event.cookies.length > 0) {\n    return event.cookies.join('; ');\n  }\n  return event.headers.cookie || (event.headers as any).Cookie;\n}\n\nexport function parseSessionFromRequest(event: APIGatewayProxyEventV2): SessionContext | null {\n  const cookieHeader = readCookieString(event);\n  const cookies = parseCookie(cookieHeader);\n  const token = cookies[COOKIE_NAME];\n  return parseSession(token);\n}\n\nexport function buildSessionCookie(token: string, secure = true) {\n  const attrs = [\n    `${COOKIE_NAME}=${token}`,\n    'HttpOnly',\n    'Path=/',\n    'SameSite=None',\n    `Domain=${COOKIE_DOMAIN}`,\n    ...(secure ? ['Secure'] : []),\n    'Max-Age=604800', // 7d\n  ];\n  return attrs.join('; ');\n}\n\nexport function buildClearCookie(secure = true) {\n  const attrs = [\n    `${COOKIE_NAME}=; Path=/; Max-Age=0; HttpOnly; SameSite=None; Domain=${COOKIE_DOMAIN}${\n      secure ? '; Secure' : ''\n    }`,\n  ];\n  return attrs.join('; ');\n}\n\n", "export function newId(prefix: string) {\n  const rand = globalThis.crypto?.randomUUID?.() ?? `${Date.now()}-${Math.random().toString(36).slice(2, 10)}`;\n  return `${prefix}-${rand}`.replace(/[^a-zA-Z0-9-_]/g, '');\n}\n\n", "import { GetCommand, PutCommand, QueryCommand, UpdateCommand, DeleteCommand, ScanCommand } from '@aws-sdk/lib-dynamodb';\nimport { docClient } from '../handlers/common';\n\nconst TABLE_NAME = process.env.TABLE_NAME || 'agency-narrative-crm';\n\nfunction normalizeCreatedAt(item: Record<string, unknown>) {\n  if (!item) return item;\n  const ca = (item as any).createdAt;\n  if (typeof ca === 'string') {\n    const num = Number(ca) || Date.parse(ca) || Date.now();\n    (item as any).createdAt = num;\n  }\n  return item;\n}\n\nexport async function putItem(item: Record<string, unknown>) {\n  normalizeCreatedAt(item);\n  await docClient.send(new PutCommand({ TableName: TABLE_NAME, Item: item }));\n  return item;\n}\n\nexport async function getItem(key: { PK: string; SK: string }) {\n  const res = await docClient.send(new GetCommand({ TableName: TABLE_NAME, Key: key }));\n  return res.Item;\n}\n\nexport async function queryByPK(PK: string, beginsWith?: string) {\n  const res = await docClient.send(\n    new QueryCommand({\n      TableName: TABLE_NAME,\n      KeyConditionExpression: beginsWith ? 'PK = :pk AND begins_with(SK, :sk)' : 'PK = :pk',\n      ExpressionAttributeValues: beginsWith ? { ':pk': PK, ':sk': beginsWith } : { ':pk': PK },\n    }),\n  );\n  return res.Items ?? [];\n}\n\nexport async function queryGSI1(GSI1PK: string, beginsWith?: string) {\n  const res = await docClient.send(\n    new QueryCommand({\n      TableName: TABLE_NAME,\n      IndexName: 'GSI1',\n      KeyConditionExpression: beginsWith ? 'GSI1PK = :g1pk AND begins_with(GSI1SK, :g1sk)' : 'GSI1PK = :g1pk',\n      ExpressionAttributeValues: beginsWith ? { ':g1pk': GSI1PK, ':g1sk': beginsWith } : { ':g1pk': GSI1PK },\n    }),\n  );\n  return res.Items ?? [];\n}\n\n// Fallback query without specifying IndexName (only works if GSI1PK exists on base table projection)\n// Fallback scan when GSI1 is misconfigured or absent; use sparingly (costly)\nexport async function scanByGSI1PK(GSI1PK: string, beginsWith?: string) {\n  const params: any = {\n    TableName: TABLE_NAME,\n    FilterExpression: beginsWith ? 'GSI1PK = :g1pk AND begins_with(GSI1SK, :g1sk)' : 'GSI1PK = :g1pk',\n    ExpressionAttributeValues: beginsWith\n      ? { ':g1pk': GSI1PK, ':g1sk': beginsWith }\n      : { ':g1pk': GSI1PK },\n  };\n  const res = await docClient.send(new ScanCommand(params));\n  return res.Items ?? [];\n}\n\nexport async function queryClientLists(clientId: string) {\n  const res = await docClient.send(\n    new QueryCommand({\n      TableName: TABLE_NAME,\n      IndexName: 'GSI2ClientLists',\n      KeyConditionExpression: 'clientId = :cid',\n      ExpressionAttributeValues: { ':cid': clientId },\n    }),\n  );\n  return res.Items ?? [];\n}\n\nexport async function updateItem(params: {\n  key: { PK: string; SK: string };\n  updateExpression: string;\n  expressionAttributeValues: Record<string, unknown>;\n  expressionAttributeNames?: Record<string, string>;\n}) {\n  const res = await docClient.send(\n    new UpdateCommand({\n      TableName: TABLE_NAME,\n      Key: params.key,\n      UpdateExpression: params.updateExpression,\n      ExpressionAttributeValues: params.expressionAttributeValues,\n      ExpressionAttributeNames: params.expressionAttributeNames,\n      ReturnValues: 'ALL_NEW',\n    }),\n  );\n  return res.Attributes;\n}\n\nexport async function deleteItem(key: { PK: string; SK: string }) {\n  await docClient.send(new DeleteCommand({ TableName: TABLE_NAME, Key: key }));\n}\n\n// Query GSI3 for username lookups (vanity URLs)\nexport async function queryGSI3(GSI3PK: string, beginsWith?: string) {\n  const res = await docClient.send(\n    new QueryCommand({\n      TableName: TABLE_NAME,\n      IndexName: 'GSI3',\n      KeyConditionExpression: beginsWith ? 'GSI3PK = :g3pk AND begins_with(GSI3SK, :g3sk)' : 'GSI3PK = :g3pk',\n      ExpressionAttributeValues: beginsWith ? { ':g3pk': GSI3PK, ':g3sk': beginsWith } : { ':g3pk': GSI3PK },\n    }),\n  );\n  return res.Items ?? [];\n}\n\n// Scan fallback for GSI3 if index doesn't exist yet\nexport async function scanByGSI3PK(GSI3PK: string) {\n  const params: any = {\n    TableName: TABLE_NAME,\n    FilterExpression: 'GSI3PK = :g3pk',\n    ExpressionAttributeValues: { ':g3pk': GSI3PK },\n  };\n  const res = await docClient.send(new ScanCommand(params));\n  return res.Items ?? [];\n}\n\n"],
  "mappings": "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",
  "names": ["import_lib_dynamodb"]
}
