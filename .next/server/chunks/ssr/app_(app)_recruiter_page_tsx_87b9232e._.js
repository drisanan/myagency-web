module.exports=[84643,a=>{"use strict";var b=a.i(87924),c=a.i(19470),d=a.i(72131),e=a.i(24089),f=a.i(77940),g=a.i(56882),h=a.i(32126),i=a.i(31822),j=a.i(10446),k=a.i(74908),l=a.i(28388),m=a.i(97501),n=a.i(75523),o=a.i(12218),p=a.i(9386),q=a.i(98621),r=a.i(36472),s=a.i(74443),t=a.i(25054),u=a.i(33115),v=a.i(782),w=a.i(44365);let x=d.createContext({});var y=a.i(49185),z=a.i(49126),A=a.i(68604),B=a.i(29297);function C(a){return(0,B.default)("MuiAccordion",a)}let D=(0,A.default)("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),E=(0,s.styled)(w.default,{name:"MuiAccordion",slot:"Root",overridesResolver:(a,b)=>{let{ownerState:c}=a;return[{[`& .${D.region}`]:b.region},b.root,!c.square&&b.rounded,!c.disableGutters&&b.gutters]}})((0,t.default)(({theme:a})=>{let b={duration:a.transitions.duration.shortest};return{position:"relative",transition:a.transitions.create(["margin"],b),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(a.vars||a).palette.divider,transition:a.transitions.create(["opacity","background-color"],b)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${D.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${D.disabled}`]:{backgroundColor:(a.vars||a).palette.action.disabledBackground}}}),(0,t.default)(({theme:a})=>({variants:[{props:a=>!a.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(a.vars||a).shape.borderRadius,borderBottomRightRadius:(a.vars||a).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:a=>!a.disableGutters,style:{[`&.${D.expanded}`]:{margin:"16px 0"}}}]}))),F=(0,s.styled)("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),G=(0,s.styled)("div",{name:"MuiAccordion",slot:"Region"})({}),H=d.forwardRef(function(a,c){let e=(0,u.useDefaultProps)({props:a,name:"MuiAccordion"}),{children:f,className:g,defaultExpanded:h=!1,disabled:i=!1,disableGutters:j=!1,expanded:k,onChange:l,square:m=!1,slots:n={},slotProps:o={},TransitionComponent:p,TransitionProps:s,...t}=e,[w,A]=(0,y.default)({controlled:k,default:h,name:"Accordion",state:"expanded"}),B=d.useCallback(a=>{A(!w),l&&l(a,!w)},[w,l,A]),[D,...H]=d.Children.toArray(f),I=d.useMemo(()=>({expanded:w,disabled:i,disableGutters:j,toggle:B}),[w,i,j,B]),J={...e,square:m,disabled:i,disableGutters:j,expanded:w},K=(a=>{let{classes:b,square:c,expanded:d,disabled:e,disableGutters:f}=a;return(0,r.default)({root:["root",!c&&"rounded",d&&"expanded",e&&"disabled",!f&&"gutters"],heading:["heading"],region:["region"]},C,b)})(J),L={slots:{transition:p,...n},slotProps:{transition:s,...o}},[M,N]=(0,z.default)("root",{elementType:E,externalForwardedProps:{...L,...t},className:(0,q.default)(K.root,g),shouldForwardComponentProp:!0,ownerState:J,ref:c,additionalProps:{square:m}}),[O,P]=(0,z.default)("heading",{elementType:F,externalForwardedProps:L,className:K.heading,ownerState:J}),[Q,R]=(0,z.default)("transition",{elementType:v.default,externalForwardedProps:L,ownerState:J}),[S,T]=(0,z.default)("region",{elementType:G,externalForwardedProps:L,ownerState:J,className:K.region,additionalProps:{"aria-labelledby":D.props.id,id:D.props["aria-controls"],role:"region"}});return(0,b.jsxs)(M,{...N,children:[(0,b.jsx)(O,{...P,children:(0,b.jsx)(x.Provider,{value:I,children:D})}),(0,b.jsx)(Q,{in:w,timeout:"auto",...R,children:(0,b.jsx)(S,{...T,children:H})})]})});var I=a.i(26893);function J(a){return(0,B.default)("MuiAccordionSummary",a)}let K=(0,A.default)("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),L=(0,s.styled)(I.default,{name:"MuiAccordionSummary",slot:"Root"})((0,t.default)(({theme:a})=>{let b={duration:a.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:a.spacing(0,2),transition:a.transitions.create(["min-height","background-color"],b),[`&.${K.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${K.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`&:hover:not(.${K.disabled})`]:{cursor:"pointer"},variants:[{props:a=>!a.disableGutters,style:{[`&.${K.expanded}`]:{minHeight:64}}}]}})),M=(0,s.styled)("span",{name:"MuiAccordionSummary",slot:"Content"})((0,t.default)(({theme:a})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:a=>!a.disableGutters,style:{transition:a.transitions.create(["margin"],{duration:a.transitions.duration.shortest}),[`&.${K.expanded}`]:{margin:"20px 0"}}}]}))),N=(0,s.styled)("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})((0,t.default)(({theme:a})=>({display:"flex",color:(a.vars||a).palette.action.active,transform:"rotate(0deg)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shortest}),[`&.${K.expanded}`]:{transform:"rotate(180deg)"}}))),O=d.forwardRef(function(a,c){let e=(0,u.useDefaultProps)({props:a,name:"MuiAccordionSummary"}),{children:f,className:g,expandIcon:h,focusVisibleClassName:i,onClick:j,slots:k,slotProps:l,...m}=e,{disabled:n=!1,disableGutters:o,expanded:p,toggle:s}=d.useContext(x),t={...e,expanded:p,disabled:n,disableGutters:o},v=(a=>{let{classes:b,expanded:c,disabled:d,disableGutters:e}=a;return(0,r.default)({root:["root",c&&"expanded",d&&"disabled",!e&&"gutters"],focusVisible:["focusVisible"],content:["content",c&&"expanded",!e&&"contentGutters"],expandIconWrapper:["expandIconWrapper",c&&"expanded"]},J,b)})(t),w={slots:k,slotProps:l},[y,A]=(0,z.default)("root",{ref:c,shouldForwardComponentProp:!0,className:(0,q.default)(v.root,g),elementType:L,externalForwardedProps:{...w,...m},ownerState:t,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:n,"aria-expanded":p,focusVisibleClassName:(0,q.default)(v.focusVisible,i)},getSlotProps:a=>({...a,onClick:b=>{a.onClick?.(b),s&&s(b),j&&j(b)}})}),[B,C]=(0,z.default)("content",{className:v.content,elementType:M,externalForwardedProps:w,ownerState:t}),[D,E]=(0,z.default)("expandIconWrapper",{className:v.expandIconWrapper,elementType:N,externalForwardedProps:w,ownerState:t});return(0,b.jsxs)(y,{...A,children:[(0,b.jsx)(B,{...C,children:f}),h&&(0,b.jsx)(D,{...E,children:h})]})});function P(a){return(0,B.default)("MuiAccordionDetails",a)}(0,A.default)("MuiAccordionDetails",["root"]);let Q=(0,s.styled)("div",{name:"MuiAccordionDetails",slot:"Root"})((0,t.default)(({theme:a})=>({padding:a.spacing(1,2,2)}))),R=d.forwardRef(function(a,c){let d=(0,u.useDefaultProps)({props:a,name:"MuiAccordionDetails"}),{className:e,...f}=d,g=(a=>{let{classes:b}=a;return(0,r.default)({root:["root"]},P,b)})(d);return(0,b.jsx)(Q,{className:(0,q.default)(g.root,e),ref:c,ownerState:d,...f})});var S=a.i(9187);let T=(0,a.i(69464).default)((0,b.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var U=a.i(34956),V=a.i(29026),W=a.i(66001),X=a.i(65237),Y=a.i(88723);let Z="email_templates_v1";function $(){try{let a=localStorage.getItem(Z);return a?JSON.parse(a):[]}catch{return[]}}function _(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var aa=a.i(23898),ab=a.i(94195);function ac(){let{session:a}=(0,V.useSession)(),[q,r]=d.default.useState(0),[s,t]=d.default.useState([]),[u,v]=d.default.useState(""),[w,x]=d.default.useState([]),[y,z]=d.default.useState(""),[A,B]=d.default.useState([]),[C,D]=d.default.useState(""),[E,F]=d.default.useState([]),[G,I]=d.default.useState([]),[J,K]=d.default.useState(""),[L,M]=d.default.useState(null),[N,P]=d.default.useState(!1),[Q,ac]=d.default.useState(""),[ad,ae]=d.default.useState(null),[af,ag]=d.default.useState({}),[ah,ai]=d.default.useState(""),[aj,ak]=d.default.useState(null),[al,am]=d.default.useState({accomplishments:!0,motivation:!0,academic:!0,athletic:!0,highlights:!0,contact:!0,coach:!0,references:!0,profilePicture:!1,radarPage:!0}),[an,ao]=d.default.useState({}),[ap,aq]=d.default.useState([]),[ar,as]=d.default.useState(""),[at,au]=d.default.useState(""),[av,aw]=d.default.useState(!1),[ax,ay]=d.default.useState(!1),az=d.default.useRef(null),aA=d.default.useRef(""),aB=d.default.useMemo(()=>s.find(a=>a.id===u)||null,[s,u]),aC=d.default.useMemo(()=>{let a=aB?.radar??{};return{email:aB?.email??"",phone:aB?.phone??"",firstName:aB?.firstName??"",lastName:aB?.lastName??"",school:a.school??"",accomplishments:a.accomplishments??[],motivationalQuotes:a.motivationalQuotes??(a.athleteAdvice?[a.athleteAdvice]:[]),gpa:a.gpa??"",preferredAreaOfStudy:a.preferredAreaOfStudy??"",athleteMetricsTitleOne:a.athleteMetricsTitleOne??"",athleteMetricsValueOne:a.athleteMetricsValueOne??"",athleteMetricsTitleTwo:a.athleteMetricsTitleTwo??"",athleteMetricsValueTwo:a.athleteMetricsValueTwo??"",athleteMetricsTitleThree:a.athleteMetricsTitleThree??"",athleteMetricsValueThree:a.athleteMetricsValueThree??"",athleteMetricsTitleFour:a.athleteMetricsTitleFour??"",athleteMetricsValueFour:a.athleteMetricsValueFour??"",youtubeHighlightUrl:a.youtubeHighlightUrl??"",hudlLink:a.hudlLink??"",instagramProfileUrl:a.instagramProfileUrl??"",newsArticleLinks:a.newsArticleLinks??[],headCoachName:a.headCoachName??"",headCoachEmail:a.headCoachEmail??"",headCoachPhone:a.headCoachPhone??"",referenceOneName:a.referenceOneName??"",referenceOneEmail:a.referenceOneEmail??"",referenceOnePhone:a.referenceOnePhone??"",referenceTwoName:a.referenceTwoName??"",referenceTwoEmail:a.referenceTwoEmail??"",referenceTwoPhone:a.referenceTwoPhone??"",profileImage:a.profileImage??""}},[aB]),aD=d.default.useMemo(()=>{let a=af||{};return N&&L?(L.items||[]).map((a,b)=>({id:String(a.id||`List::${a.school||""}::${a.email||""}::${a.firstName||""}-${a.lastName||""}::${a.title||""}::${b}`),firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",title:a.title||""})).filter(b=>a[b.id]):(ad?.coaches??[]).filter(b=>a[b.id])},[af,ad,N,L]),aE=ad?.schoolInfo?.School||ad?.name||"";function aF(a,b){am(c=>({...c,[a]:b}))}function aG(a,b,c){ao(d=>({...d,[a]:{...d[a]??{},[b]:c}}))}function aH(){let a=aD[0]?.lastName||aD[0]?.LastName||"Coach",b=Object.keys(al).filter(a=>al[a]),c="",d=`${aC.firstName||""} ${aC.lastName||""} - ${aC.school||""}`.trim();if(c+=`<p>Hello Coach ${a||""},</p><p>${d}</p>`,b.includes("accomplishments")){let a=(aC.accomplishments||[]).filter(a=>a&&""!==a.trim()&&"undefined"!==a&&"null"!==a);a.length&&(c+=`<p><strong>Accomplishments:</strong></p><ul>${a.map((b,c)=>{let d=a.length>1?`${c+1}. `:"";return`<li>${d}${b.trim()}</li>`}).join("")}</ul>

`)}if(b.includes("motivation")&&aC.motivationalQuotes?.[0]){let a=aC.motivationalQuotes[0];c+=`<p><strong>Why I'm Ready For The Next Level:</strong></p><p>"${a}"</p>

`}if(b.includes("academic")&&(aC.gpa||aC.preferredAreaOfStudy)&&(c+=`<p><strong>Academic Information:</strong></p><ul>${[aC.gpa?`<li>GPA: ${aC.gpa}</li>`:"",aC.preferredAreaOfStudy?`<li>Preferred Area of Study: ${aC.preferredAreaOfStudy}</li>`:""].filter(Boolean).join("")}</ul>
`),b.includes("athletic")){let a=[{title:aC.athleteMetricsTitleOne,value:aC.athleteMetricsValueOne},{title:aC.athleteMetricsTitleTwo,value:aC.athleteMetricsValueTwo},{title:aC.athleteMetricsTitleThree,value:aC.athleteMetricsValueThree},{title:aC.athleteMetricsTitleFour,value:aC.athleteMetricsValueFour}].filter(a=>a.title&&a.value);a.length?c+=`<p><strong>Athletic Metrics:</strong></p><ul>${a.map((b,c)=>{let d=a.length>1?`${c+1}. `:"";return`<li>${d}${b.title}: ${b.value}</li>`}).join("")}</ul>
`:c+=`<p><strong>Athletic Metrics:</strong></p><p>No athletic metrics available.</p>
`}if(b.includes("highlights")){let a=[aC.youtubeHighlightUrl?{type:"YouTube Highlight",url:`https://www.youtube.com/watch?v=${aC.youtubeHighlightUrl}`}:null,aC.hudlLink?{type:"Hudl Profile",url:`https://www.hudl.com/profile/${aC.hudlLink}`}:null,aC.instagramProfileUrl?{type:"Instagram",url:`https://www.instagram.com/${aC.instagramProfileUrl}`}:null,...(aC.newsArticleLinks||[]).map(a=>({type:"Article",url:a}))||[]].filter(Boolean);a.length?c+=`<p><strong>View My Highlights:</strong></p><ul>${a.map((b,c)=>{let d=a.length>1?`${c+1}. `:"";return`<li>${d}<a href="${b.url}" target="_blank">${b.type}</a></li>`}).join("")}</ul>
`:c+=`<p><strong>View My Highlights:</strong></p><p>No highlights available.</p>
`}return b.includes("contact")&&(aC.email||aC.phone)&&(c+=`<p><strong>Contact Info:</strong></p><ul>${[aC.email?`<li>Email: <a href="mailto:${aC.email}">${aC.email}</a></li>`:"",aC.phone?`<li>Phone: <a href="tel:${aC.phone}">${aC.phone}</a></li>`:""].filter(Boolean).join("")}</ul>
`),b.includes("coach")&&(aC.headCoachName||aC.headCoachEmail||aC.headCoachPhone)&&(c+=`<p><strong>Head Coach Info:</strong></p><ul>${[aC.headCoachName?`<li>Name: ${aC.headCoachName}</li>`:"",aC.headCoachEmail?`<li>Email: <a href="mailto:${aC.headCoachEmail}">${aC.headCoachEmail}</a></li>`:"",aC.headCoachPhone?`<li>Phone: <a href="tel:${aC.headCoachPhone}">${aC.headCoachPhone}</a></li>`:""].filter(Boolean).join("")}</ul>
`),b.includes("references")&&(aC.referenceOneName||aC.referenceTwoName)&&(c+=`<p><strong>References:</strong></p><ul>${[aC.referenceOneName?`<li>${aC.referenceOneName}<br>${aC.referenceOnePhone?`Phone: <a href="tel:${aC.referenceOnePhone}">${aC.referenceOnePhone}</a>`:""} <br>${aC.referenceOneEmail?`Email: <a href="mailto:${aC.referenceOneEmail}">${aC.referenceOneEmail}</a>`:""}</li>`:"",aC.referenceTwoName?`<li>${aC.referenceTwoName}<br>${aC.referenceTwoPhone?`Phone: <a href="tel:${aC.referenceTwoPhone}">${aC.referenceTwoPhone}</a>`:""} <br>${aC.referenceTwoEmail?`Email: <a href="mailto:${aC.referenceTwoEmail}">${aC.referenceTwoEmail}</a>`:""}</li>`:""].filter(Boolean).join("")}</ul>
`),b.includes("profilePicture")&&aC.profileImage&&(c+=`<p><img src="${aC.profileImage}" alt="Profile Picture" width="250px" height="250px" style="max-width: 250px; height: auto; display: block;"></p>`),c+=`<p>Thank you for your time!</p><p>${aC.firstName||""} ${aC.lastName||""} - ${aC.school||""}</p>`,b.includes("radarPage")&&aC.email&&(c+=`
Follow My Radar Page: <a href="https://radar.athletenarrative.com/?username=${encodeURIComponent(aC.email)}" target="_blank">HERE</a>`),c}async function aI(){try{if(!aB?.id)return void ak("Select a client first");aw(!0);let a=await fetch(`/api/google/oauth/url?clientId=${encodeURIComponent(aB.id)}`),b=await a.json();if(!b?.url)throw Error("Failed to start Gmail connection flow");let c=window.top?.outerHeight?Math.max(0,(window.top.outerHeight-700)/2):100,d=window.top?.outerWidth?Math.max(0,(window.top.outerWidth-500)/2):100;if(az.current=window.open(b.url,"an-google-oauth",`toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,height=700,top=${c},left=${d}`),!az.current)throw Error("Popup blocked. Allow popups and retry.")}catch(a){aw(!1),ak(a?.message||"Failed to start Gmail connection")}}async function aJ(){try{let b=aB?.id||aA.current||u||"";if(!b)return void ak("Select a client first");console.info("[gmail-ui:draft:start]",{clientId:b});try{let a=await fetch(`/api/google/status?clientId=${encodeURIComponent(b)}`),c=await a.json();if(console.info("[gmail-ui:status]",{clientId:b,connected:!!c?.connected}),!c?.connected){let a=(0,W.getClientGmailTokens)(b);console.info("[gmail-ui:rehydrate:attempt]",{clientId:b,hasSavedTokens:!!a,hasAccess:!!a?.access_token,hasRefresh:!!a?.refresh_token}),a&&(await fetch("/api/google/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:b,tokens:a})}),ay(!0),console.info("[gmail-ui:rehydrate:result]",{clientId:b,ok:!0}))}}catch{}let c=aD.map(a=>a.email||a.Email).filter(Boolean);if(!c.length)return void ak("Select at least one coach with an email");let d=`Intro: ${aC.firstName||""} ${aC.lastName||""} → ${aE||""}`.trim(),e=aM||aH(),f=(0,W.getClientGmailTokens)(b),g=await fetch("/api/gmail/create-draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:b,to:c,subject:d,html:e,tokens:f||void 0,agencyEmail:a?.email||""})}),h=await g.json();if(!g.ok||!h?.ok)throw Error(h?.error||"Draft creation failed");h.openUrl&&window.open(h.openUrl,"_blank");try{if(aB?.id){let a=aD.map(a=>a.email).filter(Boolean);(0,ab.markMailed)(aB.id,a)}}catch{}}catch(a){console.error(a),ak(a?.message||"Failed to create Gmail draft")}}d.default.useEffect(()=>{function a(a){}return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[]),d.default.useEffect(()=>{aB?.id,ay(!1)},[aB?.id]);let[aK,aL]=d.default.useState(!1),[aM,aN]=d.default.useState(""),[aO,aP]=d.default.useState(!1);async function aQ(){try{aL(!0),ak(null);let a=aB?.sport||"",b=aE||"",c=aD[0]?.lastName||aD[0]?.LastName||"Coach",d=`${aC.firstName||""} ${aC.lastName||""}`.trim(),e=[];al.accomplishments&&aC.accomplishments?.length&&e.push("notable accomplishments"),al.academic&&(aC.gpa||aC.preferredAreaOfStudy)&&e.push("key academic details"),al.athletic&&e.push("athletic metrics and performance"),al.highlights&&e.push("highlight links for review");let f=`This is an introduction email for ${d}. The student-athlete is introducing themselves with ${e.join(", ")||"basic profile details"}. Please use the student's actual name; do not use placeholders.`,g=await (0,U.generateIntro)({sport:a,collegeName:b,coachMessage:f,tone:"A highschool kid who loves sports",qualities:["Passionate","Hardworking","Determined"],additionalInsights:`Student full name: ${d}. Use this exact name; do not output placeholders like [StudentName].`}),h=String(g).replace(/\[StudentName\]/gi,d),i=aH(),j=i.replace(/^<p>Hello Coach[\s\S]*?<\/p>\s*<p>[\s\S]*?<\/p>/,"")||i,k=`<p>Hello Coach ${c},</p><p>${h}</p>${j}`;aN(k)}catch(a){ak(a?.message||"AI generation failed")}finally{aL(!1)}}async function aR(){let a=aD[0]?.lastName||aD[0]?.LastName||"Coach",b=`${aC.firstName||""} ${aC.lastName||""}`.trim(),c=aB?.sport||"",d=aE||"",e=[];al.accomplishments&&aC.accomplishments?.length&&e.push("notable accomplishments"),al.academic&&(aC.gpa||aC.preferredAreaOfStudy)&&e.push("academic information"),al.athletic&&e.push("athletic metrics"),al.highlights&&e.push("highlights");let f=`This is an introduction email for ${b}. The student-athlete is introducing themselves with ${e.join(", ")||"basic profile details"}. Please use the student's actual name; do not use placeholders.`,g=String(await (0,U.generateIntro)({sport:c,collegeName:d,coachMessage:f,tone:"A highschool kid who loves sports",qualities:["Passionate","Hardworking","Determined"],additionalInsights:`Student full name: ${b}. Use this exact name; do not output placeholders like [StudentName].`})).replace(/\[StudentName\]/gi,b),h=aH(),i=h.replace(/^<[^>]*>Hello\s+Coach[\s\S]*?<\/p>\s*<p>[\s\S]*?<\/p>/i,"")||h;return`<p>Hello Coach ${a},</p><p>${g}</p>${i}`}d.default.useEffect(()=>{a&&"agency"===a.role&&((0,W.listClientsByAgencyEmail)(a.email).then(t),(0,X.getDivisions)().then(x),I((0,aa.listLists)(a.email)))},[a]),d.default.useEffect(()=>{if(!y){B([]),D(""),F([]);return}(0,X.getStates)(y).then(B),D(""),F([])},[y]),d.default.useEffect(()=>{if(y&&C&&u){let a=s.find(a=>a.id===u)||null,b=a?.sport||"";if(!b)return void F([]);let c=Y.DIVISION_API_MAPPING[y]||y;(0,Y.listUniversities)({sport:b,division:c,state:C}).then(F).catch(a=>{F([]),ak(a?.message||"Failed to load universities")})}else F([])},[y,C,u,s]),d.default.useEffect(()=>{if(!Q){ae(null),ag({});return}let a=s.find(a=>a.id===u)||null,b=a?.sport||"";if(!b||!y||!C)return void ae(null);let c=Y.DIVISION_API_MAPPING[y]||y;(0,Y.getUniversityDetails)({sport:b,division:c,state:C,school:Q}).then(a=>{ae(a),ag({})}).catch(a=>{ae(null),ag({}),ak(a?.message||"Failed to load university")})},[Q,u,y,C,s]),d.default.useEffect(()=>{ak(null)},[y,C,Q,u]),d.default.useEffect(()=>{if(a?.email){var b;aq((b={agencyEmail:a.email,clientId:u},$().filter(a=>a.agencyEmail===b.agencyEmail&&(!b.clientId||a.clientId===b.clientId)).sort((a,b)=>b.createdAt-a.createdAt)))}},[a,u]);let aS=3===q,aT=0===q&&!!u||1===q&&(!!J||!!y&&!!C&&E.length>0)||2===q&&(N?aD.length>0:!!Q)||3===q,aU=async()=>{if(aS){try{aP(!0),ak(null);let a=await aR();aN(a),ai(a)}catch(a){ak(a?.message||"Failed to generate email")}finally{aP(!1)}return}r(a=>a+1)};function aV(){let a=aC.firstName||"",b=aC.lastName||"",c=`${a} ${b}`.trim(),d=aE||ad?.schoolInfo?.School||ad?.name||"";return{studentFirstName:a,studentLastName:b,studentFullName:c,universityName:d,primaryCoachLastName:aD[0]?.lastName||aD[0]?.LastName||"",coachList:(aD||[]).map(a=>`${a.firstName||a.FirstName||""} ${a.lastName||a.LastName||""}`.trim()).filter(Boolean).join(", ")}}return(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(i.Stepper,{activeStep:q,alternativeLabel:!0,sx:{mb:3},children:["Select Client","Universities","Details & Coaches","Draft"].map(a=>(0,b.jsx)(g.Step,{children:(0,b.jsx)(h.StepLabel,{children:a})},a))}),(0,b.jsxs)(e.Box,{sx:{mb:2},children:[aj&&(0,b.jsx)(c.Typography,{color:"error",sx:{mb:2},children:aj}),0===q&&(0,b.jsx)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,maxWidth:700},children:(0,b.jsx)(j.TextField,{select:!0,label:"Client",value:u,onChange:a=>v(a.target.value),SelectProps:{MenuProps:{disablePortal:!0}},inputProps:{"data-testid":"recruiter-client-select"},children:s.map(a=>(0,b.jsxs)(o.MenuItem,{value:a.id,children:[a.email," ",a.firstName?`- ${a.firstName} ${a.lastName}`:""]},a.id))})}),1===q&&(0,b.jsxs)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,maxWidth:800},children:[(0,b.jsx)(j.TextField,{select:!0,label:"Division",value:y,onChange:a=>z(a.target.value),SelectProps:{MenuProps:{disablePortal:!0}},inputProps:{"data-testid":"recruiter-division"},children:w.map(a=>(0,b.jsx)(o.MenuItem,{value:a,children:a},a))}),(0,b.jsx)(j.TextField,{select:!0,label:"State",value:C,onChange:a=>D(a.target.value),disabled:!y,SelectProps:{MenuProps:{disablePortal:!0}},inputProps:{"data-testid":"recruiter-state"},children:A.map(a=>(0,b.jsx)(o.MenuItem,{value:a.code,children:a.name},a.code))}),(0,b.jsxs)(j.TextField,{select:!0,label:"List",value:J,onChange:a=>{let b=String(a.target.value);K(b);let c=G.find(a=>a.id===b)||null;if(M(c),c){P(!0);let a={};(c.items||[]).forEach((b,c)=>{a[String(b.id||`List::${b.school||""}::${b.email||""}::${b.firstName||""}-${b.lastName||""}::${b.title||""}::${c}`)]=!0}),ag(a),ac(""),ae(null),r(2)}else P(!1),ag({})},SelectProps:{MenuProps:{disablePortal:!0}},children:[(0,b.jsx)(o.MenuItem,{value:"",children:"(Select a list)"}),G.map(a=>(0,b.jsx)(o.MenuItem,{value:a.id,children:a.name},a.id))]}),(0,b.jsxs)(e.Box,{sx:{gridColumn:"1 / -1"},children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",sx:{mb:1},children:"Universities"}),(0,b.jsx)(p.Stack,{direction:"row",spacing:2,sx:{flexWrap:"wrap"},children:E.map(a=>(0,b.jsx)(k.Card,{onClick:()=>ac(a.name),sx:{width:260,cursor:"pointer",outline:Q===a.name?"2px solid #1976d2":"none"},children:(0,b.jsx)(l.CardContent,{children:(0,b.jsx)(c.Typography,{children:a.name})})},a.name))})]})]}),2===q&&N&&L&&(0,b.jsxs)(e.Box,{sx:{maxWidth:1e3},children:[(0,b.jsx)(c.Typography,{variant:"h6",gutterBottom:!0,children:L.name}),(0,b.jsxs)(p.Stack,{direction:"row",spacing:1,sx:{mb:1},children:[(0,b.jsx)(f.Button,{size:"small",variant:"outlined",onClick:()=>{let a={};(L.items||[]).forEach((b,c)=>{a[String(b.id||`List::${b.school||""}::${b.email||""}::${b.firstName||""}-${b.lastName||""}::${b.title||""}::${c}`)]=!0}),ag(a)},children:"Select All"}),(0,b.jsx)(f.Button,{size:"small",onClick:()=>ag({}),children:"Deselect All"})]}),(0,b.jsx)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:1},children:(L.items||[]).map((a,c)=>{let d=String(a.id||`List::${a.school||""}::${a.email||""}::${a.firstName||""}-${a.lastName||""}::${a.title||""}::${c}`),e=!!aB?.id&&!!a.email&&(0,ab.hasMailed)(aB.id,a.email),f=`${a.firstName||""} ${a.lastName||""}`.trim()||a.email||"";return(0,b.jsx)(n.FormControlLabel,{control:(0,b.jsx)(m.Checkbox,{checked:!!af[d],onChange:()=>ag(a=>({...a,[d]:!a[d]}))}),label:`${f}${a.title?` — ${a.title}`:""}${a.email?` (${a.email})`:""}${e?" — Mailed":""}`},d)})})]}),2===q&&!N&&ad&&(0,b.jsxs)(e.Box,{sx:{maxWidth:1e3},children:[(0,b.jsx)(c.Typography,{variant:"h6",gutterBottom:!0,children:ad?.schoolInfo?.School||ad?.name||"—"}),(0,b.jsxs)(e.Box,{sx:{mb:2},children:[(0,b.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",children:["Location: ",ad?.schoolInfo?.City||"—",", ",ad?.schoolInfo?.State||"—"]}),(0,b.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",children:["Division: ",ad?.division||"—"]}),(0,b.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",children:["Conference: ",ad?.schoolInfo?.Conference||ad?.conference||"—"]}),(0,b.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",children:["Type: ",ad?.schoolInfo?.PrivatePublic||ad?.privatePublic||"—"]})]}),(0,b.jsxs)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(4, 1fr)"},gap:2,mb:2},children:[(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"GPA"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.AverageGPA||"—"})]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"SAT Math"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.SATMath||"—"})]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"SAT Reading"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.SATReading||"—"})]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"ACT"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.ACTComposite||"—"})]})]}),(0,b.jsxs)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(3, 1fr)"},gap:2,mb:2},children:[(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"Acceptance Rate"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.AcceptanceRate||"—"})]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"Yearly Cost"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.YearlyCost||"—"})]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"subtitle2",color:"text.secondary",children:"US News Ranking"}),(0,b.jsx)(c.Typography,{children:ad?.schoolInfo?.USNewsRanking?`#${ad.schoolInfo.USNewsRanking}`:"—"})]})]}),(0,b.jsxs)(e.Box,{sx:{display:"flex",gap:2,flexWrap:"wrap",mb:3},children:[ad?.schoolInfo?.MajorsOfferedLink&&(0,b.jsx)(f.Button,{size:"small",variant:"outlined",onClick:()=>window.open(ad.schoolInfo.MajorsOfferedLink,"_blank"),children:"View Majors"}),ad?.schoolInfo?.Questionnaire&&(0,b.jsx)(f.Button,{size:"small",variant:"outlined",onClick:()=>window.open(ad.schoolInfo.Questionnaire,"_blank"),children:"Recruiting Questionnaire"}),ad?.schoolInfo?.LandingPage&&(0,b.jsx)(f.Button,{size:"small",variant:"outlined",onClick:()=>window.open(ad.schoolInfo.LandingPage,"_blank"),children:"Team Website"}),ad?.schoolInfo?.SchoolTwitter&&"-"!==ad.schoolInfo.SchoolTwitter&&(0,b.jsx)(f.Button,{size:"small",variant:"text",onClick:()=>window.open(ad.schoolInfo.SchoolTwitter,"_blank"),children:"Twitter"}),ad?.schoolInfo?.SchoolInstagram&&"-"!==ad.schoolInfo.SchoolInstagram&&(0,b.jsx)(f.Button,{size:"small",variant:"text",onClick:()=>window.open(ad.schoolInfo.SchoolInstagram,"_blank"),children:"Instagram"})]}),(0,b.jsx)(c.Typography,{variant:"subtitle1",sx:{mb:1},children:"Coaches"}),(0,b.jsx)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:1},children:(ad.coaches??[]).map(a=>{let c=a.id,d=a.firstName||a.FirstName||"",e=a.lastName||a.LastName||"",f=a.title||a.Position||"",g=a.email||a.Email;return(0,b.jsx)(n.FormControlLabel,{control:(0,b.jsx)(m.Checkbox,{checked:!!af[c],onChange:()=>ag(a=>({...a,[c]:!a[c]}))}),label:`${d} ${e} — ${f}${g?` (${g})`:""}`},c)})})]}),3===q&&(0,b.jsxs)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1.2fr 1fr"},gap:3},children:[(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"h6",gutterBottom:!0,children:"Selected Targets"}),(0,b.jsx)(c.Typography,{variant:"body2",children:N&&L?(0,b.jsxs)(b.Fragment,{children:["List: ",L.name]}):(0,b.jsxs)(b.Fragment,{children:["University: ",aE||"—"]})}),(0,b.jsx)(c.Typography,{variant:"body2",sx:{mt:1,mb:2},children:`Coaches: ${aD.length?aD.map(a=>`${a.firstName||a.FirstName||""} ${a.lastName||a.LastName||""}`.trim()||a.email||"").join(", "):"—"}`}),(0,b.jsxs)(e.Box,{sx:{mb:2,display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:1},children:[(0,b.jsx)(j.TextField,{label:"Template name",value:ar,onChange:a=>as(a.target.value),size:"small"}),(0,b.jsx)(f.Button,{variant:"outlined",onClick:function(){var b,c;let d,e;if(!a?.email)return;let f=function(a,b){let c=String(a),d={[b.studentFullName]:"{{StudentFullName}}",[b.studentFirstName]:"{{StudentFirstName}}",[b.studentLastName]:"{{StudentLastName}}",[b.universityName]:"{{UniversityName}}"};for(let[a,e]of(b.primaryCoachLastName&&(d[b.primaryCoachLastName]="{{PrimaryCoachLastName}}"),b.coachList&&(d[b.coachList]="{{CoachList}}"),Object.entries(d)))if(a&&a.trim().length){let b=RegExp(_(a),"g");c=c.replace(b,e)}return c}(aM||aH(),aV());aq([(b={agencyEmail:a.email,clientId:u,name:ar||`Template ${new Date().toLocaleString()}`,html:f,enabledSections:al},d=$(),c=[e={...b,id:Math.random().toString(36).slice(2)+Date.now().toString(36),createdAt:Date.now()},...d],localStorage.setItem(Z,JSON.stringify(c)),e),...ap]),as("")},disabled:!(aM||aH())||!a?.email,children:"Save as Template"}),(0,b.jsxs)(j.TextField,{select:!0,label:"Templates",value:at,onChange:a=>(function(a){let b=ap.find(b=>b.id===a);if(!b)return;let c=function(a,b){let c=String(a);for(let[a,d]of Object.entries({"{{StudentFirstName}}":b.studentFirstName||"","{{StudentLastName}}":b.studentLastName||"","{{StudentFullName}}":b.studentFullName||"","{{UniversityName}}":b.universityName||"","{{PrimaryCoachLastName}}":b.primaryCoachLastName||"","{{CoachList}}":b.coachList||""})){let b=RegExp(_(a),"g");c=c.replace(b,d)}return c}(b.html,aV());aN(c),ai(c),b.enabledSections&&am(b.enabledSections),au(a)})(String(a.target.value)),size:"small",children:[(0,b.jsx)(o.MenuItem,{value:"",children:"(Select a template)"}),ap.map(a=>(0,b.jsx)(o.MenuItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(c.Typography,{variant:"h6",gutterBottom:!0,children:"Email Sections"}),Object.entries(al).map(([a,d])=>(0,b.jsxs)(H,{expanded:d,onChange:(b,c)=>aF(a,c),sx:{mb:1},children:[(0,b.jsx)(O,{expandIcon:(0,b.jsx)(T,{}),children:(0,b.jsxs)(e.Box,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,b.jsx)(S.Switch,{checked:d,onChange:b=>aF(a,b.target.checked)}),(0,b.jsx)(c.Typography,{sx:{textTransform:"capitalize"},children:a})]})}),(0,b.jsx)(R,{children:d?(0,b.jsxs)(e.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:1},children:["accomplishments"===a&&(aC.accomplishments||[]).map((a,c)=>(0,b.jsx)(n.FormControlLabel,{control:(0,b.jsx)(m.Checkbox,{checked:!!an.accomplishments?.[`acc-${c}`],onChange:a=>aG("accomplishments",`acc-${c}`,a.target.checked)}),label:a},`acc-${c}`)),"athletic"===a&&[{k:"m1",label:`${aC.athleteMetricsTitleOne||""}: ${aC.athleteMetricsValueOne||""}`.trim()},{k:"m2",label:`${aC.athleteMetricsTitleTwo||""}: ${aC.athleteMetricsValueTwo||""}`.trim()},{k:"m3",label:`${aC.athleteMetricsTitleThree||""}: ${aC.athleteMetricsValueThree||""}`.trim()},{k:"m4",label:`${aC.athleteMetricsTitleFour||""}: ${aC.athleteMetricsValueFour||""}`.trim()}].filter(a=>":"!==a.label).map(a=>(0,b.jsx)(n.FormControlLabel,{control:(0,b.jsx)(m.Checkbox,{checked:!!an.athletic?.[a.k],onChange:b=>aG("athletic",a.k,b.target.checked)}),label:a.label},a.k))]}):(0,b.jsx)(c.Typography,{variant:"body2",color:"text.secondary",children:"Section disabled"})})]},a))]}),(0,b.jsxs)(e.Box,{children:[(0,b.jsx)(c.Typography,{variant:"h6",gutterBottom:!0,children:"Preview"}),(0,b.jsx)(e.Box,{sx:{border:"1px solid #ddd",borderRadius:1,p:2,minHeight:200,bgcolor:"#fafafa"},children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:aM||aH()}})}),(0,b.jsxs)(e.Box,{sx:{display:"flex",gap:1,mt:2},children:[(0,b.jsx)(f.Button,{onClick:()=>navigator.clipboard.writeText(aM||aH()),children:"Copy HTML"}),(0,b.jsx)(f.Button,{onClick:async()=>{let a=aM||aH();try{{let b=document.createElement("div");b.innerHTML=a,await navigator.clipboard.writeText(b.textContent||"")}}catch(a){console.error("Clipboard copy failed",a)}},children:"Copy Rich Text"}),(0,b.jsx)(f.Button,{variant:"outlined",onClick:aI,children:ax?"Gmail Connected":av?"Connecting…":"Connect Gmail"}),(0,b.jsx)(f.Button,{variant:"outlined",onClick:aJ,disabled:!aD.length||!ax,children:"Create Gmail Draft"}),(0,b.jsx)(f.Button,{variant:"contained",onClick:()=>ai(aM||aH()),children:"Lock In"}),(0,b.jsx)(f.Button,{variant:"outlined",onClick:aQ,disabled:!aM&&!aM&&(aK||!aD.length||!aE),children:aM?"Improve…":"Improve with AI"})]})]})]})]}),(0,b.jsxs)(e.Box,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,b.jsx)(f.Button,{disabled:0===q,onClick:()=>r(a=>Math.max(0,a-1)),children:"Back"}),(0,b.jsx)(f.Button,{variant:"contained",onClick:aU,disabled:!aT||aS&&aO,children:aS?aO?"Generating…":"Generate":"Next"})]})]})}function ad(){return(0,b.jsxs)("main",{style:{padding:24},children:[(0,b.jsx)(c.Typography,{variant:"h4",gutterBottom:!0,children:"Recruiter"}),(0,b.jsx)(ac,{})]})}a.s(["default",()=>ad],84643)}];

//# sourceMappingURL=app_%28app%29_recruiter_page_tsx_87b9232e._.js.map