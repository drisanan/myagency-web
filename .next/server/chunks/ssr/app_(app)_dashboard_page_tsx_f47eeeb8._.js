module.exports=[51739,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(29026),e=a.i(33217),f=a.i(89381),g=a.i(66001),h=a.i(19470),i=a.i(24089),j=a.i(77311),k=a.i(94195),l=a.i(48617),m=a.i(74908),n=a.i(28388);function o(a,b){let c=a.replace("#","");if(6!==c.length)return`rgba(0,0,0,${b})`;let d=parseInt(c.slice(0,2),16),e=parseInt(c.slice(2,4),16),f=parseInt(c.slice(4,6),16);return`rgba(${d},${e},${f},${b})`}function p({title:a,value:c,icon:d,footer:e,bgColor:f,textColor:g,bgImage:j,overlayOpacity:k=.82}){let l=j?`linear-gradient(${o(f||"#000000",k)}, ${o(f||"#000000",k)}), url(${j})`:void 0;return(0,b.jsx)(m.Card,{sx:{borderRadius:"20px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",border:`1px solid ${f||"#dcdfe4"}`,backgroundColor:f,backgroundImage:l,backgroundSize:l?"cover":void 0,backgroundPosition:l?"center":void 0,backgroundRepeat:l?"no-repeat":void 0,color:g},children:(0,b.jsxs)(n.CardContent,{sx:{p:0},children:[(0,b.jsx)(i.Box,{sx:{px:2,pt:1,pb:.6,borderBottom:e?"1px solid #dcdfe4":"none"},children:(0,b.jsxs)(i.Box,{sx:{display:"grid",gridTemplateColumns:d?"auto 1fr":"1fr",gridTemplateRows:"auto auto",columnGap:1.5*!!d,rowGap:.75,alignItems:"start"},children:[d?(0,b.jsx)(i.Box,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:g?`${g}1a`:"#FFFFFF",color:g||"#000000",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 10px rgba(0,0,0,0.12)",gridRow:"1 / span 2"},children:d}):null,(0,b.jsx)(h.Typography,{variant:"subtitle2",color:g?void 0:"text.secondary",sx:{fontSize:"0.95rem",color:g},children:a}),(0,b.jsx)(h.Typography,{variant:"h3",sx:{fontSize:"2.1rem",lineHeight:1.05,color:g},children:c})]})}),e?(0,b.jsx)(i.Box,{sx:{display:"flex",alignItems:"center",gap:1,mt:1,px:2,pb:.35,color:"#667085"},children:e}):null]})})}var q=a.i(7946),r=a.i(9386),s=a.i(74653),t=a.i(16941),t=t,u=a.i(12218),v=a.i(98424);let w={dead:"#f04438",contact:"#15b79f",quiet:"#5D4AFB",eval:"#5D4AFB",test:"#5D4AFB",other:"#999DAA"};function x(){let a=(0,v.getSports)(),[d,f]=c.default.useState(a[0]||"Football"),{data:g=[],isLoading:j}=(0,e.useQuery)({queryKey:["recruiting-periods",d],queryFn:async()=>{let a=await fetch(`/api/recruiting-periods?sport=${encodeURIComponent(d||"Football")}`);if(!a.ok)throw Error("Failed to load periods");let b=await a.json();return b?.data||[]}}),k=new Date,l=Array.from({length:7}).map((a,b)=>{let c=new Date(k);return c.setDate(k.getDate()+b),c.setHours(0,0,0,0),c});return(0,b.jsxs)(q.Paper,{variant:"outlined",sx:{p:2,mb:3,borderRadius:"16px"},children:[(0,b.jsxs)(r.Stack,{direction:{xs:"column",md:"row"},alignItems:"center",justifyContent:"space-between",spacing:2,sx:{mb:2},children:[(0,b.jsx)(h.Typography,{variant:"h6",children:"Recruiting Calendar"}),(0,b.jsx)(t.default,{size:"small",value:d,onChange:a=>f(a.target.value),"data-testid":"recruiting-calendar-sport",children:a.map(a=>(0,b.jsx)(u.MenuItem,{value:a,children:(0,v.formatSportLabel)(a)},a))})]}),(0,b.jsxs)(r.Stack,{direction:"row",spacing:1,sx:{mb:2,flexWrap:"wrap"},children:[(0,b.jsx)(s.Chip,{size:"small",label:"Dead",sx:{bgcolor:w.dead,color:"#fff"}}),(0,b.jsx)(s.Chip,{size:"small",label:"Contact",sx:{bgcolor:w.contact,color:"#fff"}}),(0,b.jsx)(s.Chip,{size:"small",label:"Quiet",sx:{bgcolor:w.quiet,color:"#fff"}}),(0,b.jsx)(s.Chip,{size:"small",label:"Other/Test",sx:{bgcolor:w.test,color:"#fff"}}),(0,b.jsx)(s.Chip,{size:"small",label:"Today",sx:{bgcolor:"#fff",color:"#14151E",border:"1px solid #dcdfe4"}})]}),j?(0,b.jsx)(h.Typography,{color:"text.secondary",children:"Loading periods…"}):0===g.length?(0,b.jsx)(h.Typography,{color:"text.secondary",children:"No periods available."}):(0,b.jsx)(i.Box,{sx:{display:"grid",gridTemplateColumns:"repeat(7, minmax(110px, 1fr))",gap:1},children:l.map(a=>{var c,d;let e,f,i=g.filter(b=>{let c=new Date(b.startDate),d=new Date(b.endDate);return c.setHours(0,0,0,0),d.setHours(23,59,59,999),a>=c&&a<=d}),j=i[0]?w[i[0].type]||w.other:"#dcdfe4",l=a.toDateString()===k.toDateString();return(0,b.jsxs)(q.Paper,{"data-testid":"calendar-day",variant:"outlined",sx:{position:"relative",p:1.25,borderRadius:"12px",minHeight:90,bgcolor:l?"#fff":i[0]?`${j}1a`:"#fff",border:`1px solid ${l?"#dcdfe4":i[0]?j:"#dcdfe4"}`},children:[(0,b.jsxs)(r.Stack,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:[(0,b.jsx)(h.Typography,{variant:"subtitle2",children:a.toLocaleDateString(void 0,{month:"short",day:"numeric"})}),(0,b.jsxs)(r.Stack,{direction:"row",spacing:.5,justifyContent:"flex-end",sx:{flexWrap:"wrap",maxWidth:"70%"},children:[i.slice(0,2).map(a=>{let c=w[a.type]||w.other;return(0,b.jsx)(s.Chip,{size:"small",label:a.label,sx:{bgcolor:c,color:"#fff"},"data-testid":"calendar-period-chip"},a.id)}),i.length>2?(0,b.jsx)(s.Chip,{size:"small",label:`+${i.length-2}`,sx:{bgcolor:"#999DAA",color:"#fff"}}):null]})]}),i.length>0?(0,b.jsx)(h.Typography,{variant:"caption",color:"text.secondary",children:(c=i[0].startDate,d=i[0].endDate,e=new Date(c).toLocaleDateString(),e===(f=new Date(d).toLocaleDateString())?e:`${e} – ${f}`)}):(0,b.jsx)(h.Typography,{variant:"caption",color:"text.secondary",children:"No period"})]},a.toISOString())})})]})}var y=a.i(27049),y=y,z=a.i(44968),z=z,A=a.i(36982),A=A,B=a.i(81923),B=B,C=a.i(36970),C=C,D=a.i(10446);let E=["QB","RB","WR","DL","LB","CB","S","TE","OL"],F=["PG","SG","SF","PF","C"],G=["ESPN","Rivals","247Sports"],H=["Alabama","Georgia","Ohio State","Texas","Duke","Kentucky","Kansas","Gonzaga","Michigan"];function I(a,b,c){return Array.from({length:50}).map((d,e)=>{var f;let g;return{id:`${b}-${e+1}`,sport:a,list:"recent",name:`${a} Recent ${e+1}`,position:c[e%c.length],university:H[e%H.length],commitDate:(f=5*e+1,(g=new Date).setDate(g.getDate()-f),g.toISOString().slice(0,10)),source:G[e%G.length]}})}function J(a,b,c){return Array.from({length:50}).map((d,e)=>({id:`${b}-${e+1}`,sport:a,list:"top",rank:e+1,name:`${a} Top ${e+1}`,position:c[e%c.length],university:H[e%H.length],stars:5-e%3||5,source:G[e%G.length]}))}function K(a){}let L=[...I("Football","fb-rec",E),...I("Basketball","bb-rec",F),...J("Football","fb-top",E),...J("Basketball","bb-top",F)];async function M(){try{let{scrapeBasketballTop:b}=await a.A(11865),c=await b();if(c.length){let a=c.slice(0,50).map(a=>({id:a.id,sport:"Basketball",list:"top",rank:a.rank,name:a.name,position:a.position,university:a.university,stars:5,logo:a.logo,classYear:a.classYear,hometown:a.hometown,highSchool:a.highSchool,source:"ESPN 300"})),b=a.map((a,b)=>({...a,id:`${a.id}-recent`,list:"recent",rank:void 0,commitDate:new Date(Date.now()-24*b*36e5).toISOString().slice(0,10)}));L=[...L.filter(a=>"Football"===a.sport),...a,...b],K(L)}else L=L.map(a=>"Basketball"===a.sport?{...a,name:`${a.name} (placeholder)`}:a),K(L)}catch(a){}}function N({title:a,rows:d,showRank:e,dataTestId:f}){var g;let[j,k]=c.default.useState(""),[l,m]=c.default.useState(""),n=(g={position:j,university:l},d.filter(a=>{let b=!g.position||(a.position||"").toLowerCase().includes(g.position.toLowerCase()),c=!g.university||(a.university||"").toLowerCase().includes(g.university.toLowerCase());return b&&c}));return(0,b.jsxs)(q.Paper,{variant:"outlined",sx:{p:2,borderRadius:2},children:[(0,b.jsxs)(r.Stack,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[(0,b.jsx)(h.Typography,{variant:"h6",children:a}),(0,b.jsxs)(r.Stack,{direction:"row",spacing:1,children:[(0,b.jsx)(D.TextField,{size:"small",label:"Position",value:j,onChange:a=>k(a.target.value),"data-testid":`${f}-filter-position`}),(0,b.jsx)(D.TextField,{size:"small",label:"University",value:l,onChange:a=>m(a.target.value),"data-testid":`${f}-filter-university`})]})]}),(0,b.jsx)(i.Box,{sx:{maxHeight:420,overflow:"auto"},children:(0,b.jsxs)(y.default,{size:"small",stickyHeader:!0,"data-testid":f,children:[(0,b.jsx)(z.default,{children:(0,b.jsxs)(A.default,{children:[e&&(0,b.jsx)(B.default,{children:"Rank"}),(0,b.jsx)(B.default,{children:"Name"}),(0,b.jsx)(B.default,{children:"Position"}),(0,b.jsx)(B.default,{children:"University"}),(0,b.jsx)(B.default,{children:"Logo"}),!e&&(0,b.jsx)(B.default,{children:"Commit Date"}),(0,b.jsx)(B.default,{children:"Source"})]})}),(0,b.jsxs)(C.default,{children:[n.map(a=>(0,b.jsxs)(A.default,{children:[e&&(0,b.jsx)(B.default,{children:a.rank??"-"}),(0,b.jsx)(B.default,{children:a.name}),(0,b.jsx)(B.default,{children:a.position||"-"}),(0,b.jsx)(B.default,{children:a.university||"-"}),(0,b.jsx)(B.default,{children:a.logo?(0,b.jsx)(i.Box,{component:"img",src:a.logo,alt:a.university||"logo",sx:{width:28,height:28,objectFit:"contain"}}):"-"}),!e&&(0,b.jsx)(B.default,{children:a.commitDate||"-"}),(0,b.jsx)(B.default,{children:a.source||"-"})]},a.id)),0===n.length&&(0,b.jsx)(A.default,{children:(0,b.jsx)(B.default,{colSpan:5,align:"center",children:"No commits match the filters."})})]})]})})]})}async function O(a,b){let c=await fetch(`/api/commits?sport=${a}&list=${b}`);if(!c.ok)throw Error("Failed to load commits");let d=await c.json();return d?.data||[]}function P({sport:a}){let c={staleTime:864e5,gcTime:9e7,refetchOnWindowFocus:!1,refetchOnMount:!1},d=(0,e.useQuery)({queryKey:["commits",a,"recent"],queryFn:()=>O(a,"recent"),...c}),f=(0,e.useQuery)({queryKey:["commits",a,"top"],queryFn:()=>O(a,"top"),...c});return(0,b.jsxs)(r.Stack,{spacing:2,children:[(0,b.jsxs)(h.Typography,{variant:"h5",children:[a," Commits"]}),(0,b.jsx)(N,{title:"Recent Commits (last 365 days)",rows:d.data||[],showRank:!1,dataTestId:`commits-${a.toLowerCase()}-recent-table`}),(0,b.jsx)(N,{title:"Top 50 Recruits",rows:f.data||[],showRank:!0,dataTestId:`commits-${a.toLowerCase()}-top-table`})]})}function Q(a,b){let c=Math.max(1,b);return{current:a.slice(-c),previous:a.slice(-(2*c),-c)}}function R(a,b){return a.reduce((a,c)=>a+(Number(c?.[b])||0),0)}function S(a,b){return b>0?(a-b)/b*100:100*(a>0)}function T(a){let b=Math.round(a||0);return`${b>=0?"+":""}${b}%`}function U(){let a,{session:m}=(0,d.useSession)(),n=m?.role==="parent",o=(0,e.useQuery)({queryKey:["dashboard",m?.role,m?.agencyId],queryFn:()=>n?(0,f.listAgencies)():(0,g.listClientsByAgencyEmail)(m.email)}),[q,r]=c.default.useState(""),[s,t]=c.default.useState(null);if(c.default.useEffect(()=>{m?.email},[m?.email,n]),!m||!o.data)return null;if(n){let a=o.data;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Typography,{variant:"h4",gutterBottom:!0,children:"Dashboard"}),(0,b.jsx)("div",{style:{height:520},children:(0,b.jsx)(j.DataGrid,{rows:a,columns:[{field:"name",headerName:"Agency",flex:1}],getRowId:a=>a.id})})]})}let u=o.data,v=new Set(u.map(a=>a.id)),w=u.length,y=(0,k.getMailEntries)().filter(a=>v.has(a.clientId)).length,z=Number(process.env.NEXT_PUBLIC_OPEN_RATE_PLACEHOLDER??""),{emailsSent:A,deltaPct:B}=function(a,b,c=30){let{current:d,previous:e}=Q(a?.days??[],c),f=R(d,"sends"),g=R(e,"sends");return{emailsSent:f||a?.totals?.sends||b||0,deltaPct:S(f,g)}}(s,y),{openRate:C,deltaPct:D}=function(a,b,c=30){let{current:d,previous:e}=Q(a?.days??[],c),f=R(d,"sends"),g=R(d,"opens"),h=R(e,"sends"),i=R(e,"opens"),j=Number.isFinite(b)&&b>=0?b:void 0,k=f>0?g/f:a?.openRate??0,l=j??k,m=S(l,h>0?i/h:l);return{openRate:l,deltaPct:m}}(s,Number.isFinite(z)?z:void 0),E=(a=new Date,u.reduce((b,c)=>{if(!c?.createdAt)return b;let d=new Date(c.createdAt);return Number.isNaN(d.getTime())?b:d.getFullYear()===a.getFullYear()&&d.getMonth()===a.getMonth()?b+1:b},0)),F=new Date().getFullYear(),G=[F,F+1,F+2,F+3],H={[G[0]]:0,[G[1]]:0,[G[2]]:0,[G[3]]:0};return u.forEach(a=>{let b=Number(a?.radar?.graduationYear||a?.graduationYear||0);G.includes(b)&&(H[b]=(H[b]||0)+1)}),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Typography,{variant:"h4",gutterBottom:!0,children:"Dashboard"}),(0,b.jsx)(x,{}),(0,b.jsxs)(i.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(3, 1fr)"},gap:2,mb:3},children:[(0,b.jsx)(p,{title:"Emails Sent",value:A,icon:(0,b.jsx)(l.IoPaperPlaneOutline,{size:20}),footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.IoTrendingUpOutline,{color:"#15b79f",size:18}),(0,b.jsxs)(h.Typography,{variant:"body2",sx:{color:"#667085"},children:[(0,b.jsx)(i.Box,{component:"span",sx:{color:"#15b79f"},children:T(B)})," vs last 30d"]})]})}),(0,b.jsx)(p,{title:"Open Rate",value:`${Math.round(100*(C||0))}%`,icon:(0,b.jsx)(l.IoMailOpenOutline,{size:20}),footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.IoTrendingUpOutline,{color:"#15b79f",size:18}),(0,b.jsxs)(h.Typography,{variant:"body2",sx:{color:"#667085"},children:[(0,b.jsx)(i.Box,{component:"span",sx:{color:"#15b79f"},children:T(D)})," vs last 30d"]})]})}),(0,b.jsx)(p,{title:"Total Athletes",value:w,icon:(0,b.jsx)(l.IoPersonAddOutline,{size:20}),footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.IoTrendingUpOutline,{color:"#15b79f",size:18}),(0,b.jsxs)(h.Typography,{variant:"body2",sx:{color:"#667085"},children:[(0,b.jsxs)(i.Box,{component:"span",sx:{color:"#15b79f"},children:["+",E]})," added this month"]})]})})]}),(0,b.jsx)(i.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(4, 1fr)"},gap:2,mb:3},children:G.map((a,c)=>(0,b.jsx)(p,{title:`Class of ${a}`,value:H[a]||0,icon:(0,b.jsx)(l.IoFastFoodOutline,{size:20}),bgColor:0===c?"#5D4AFB":void 0,textColor:0===c?"#FFFFFF":void 0,bgImage:0===c?"/marketing/bg-an.png":void 0},a))}),(0,b.jsxs)(i.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:3,mb:4},children:[(0,b.jsx)(P,{sport:"Football"}),(0,b.jsx)(P,{sport:"Basketball"})]})]})}(async function(){try{let{scrapeFootballTop:b}=await a.A(11865),c=await b();if(c.length){let a=c.slice(0,50).map(a=>({id:a.id,sport:"Football",list:"top",rank:a.rank,name:a.name,position:a.position,university:a.university,stars:5,logo:a.logo,classYear:a.classYear,hometown:a.hometown,highSchool:a.highSchool,source:"ESPN 300"})),b=a.map((a,b)=>({...a,id:`${a.id}-recent`,list:"recent",rank:void 0,commitDate:new Date(Date.now()-24*b*36e5).toISOString().slice(0,10)}));L=[...L.filter(a=>"Basketball"===a.sport),...a,...b],K(L)}else L=L.map(a=>"Football"===a.sport?{...a,name:`${a.name} (placeholder)`}:a),K(L)}catch(a){}})(),M(),a.s(["default",()=>U],51739)}];

//# sourceMappingURL=app_%28app%29_dashboard_page_tsx_f47eeeb8._.js.map