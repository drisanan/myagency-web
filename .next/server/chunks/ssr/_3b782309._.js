module.exports=[48385,31796,43672,68386,a=>{"use strict";var b=a.i(47315);a.s(["Dialog",()=>b.default],48385);var c=a.i(73784);a.s(["DialogActions",()=>c.default],31796);var d=a.i(57641);a.s(["DialogContent",()=>d.default],43672);var e=a.i(82317);a.s(["DialogTitle",()=>e.default],68386)},51529,a=>{"use strict";var b=a.i(70025),c=a.i(33217),d=a.i(37927);async function e(a,b){let c=new URLSearchParams;c.set("agencyEmail",a),b&&c.set("athleteId",b);let d=await fetch(`/api/tasks?${c.toString()}`),e=await d.json();return e?.data||[]}async function f(a,b){let c=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...b,agencyEmail:a})});if(!c.ok)throw Error("Failed to create task");return c.json()}async function g(a,b){let c=await fetch("/api/tasks",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...b,agencyEmail:a})});if(!c.ok)throw Error("Failed to update task");return c.json()}async function h(a,b){let c=await fetch("/api/tasks",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:b,agencyEmail:a})});if(!c.ok)throw Error("Failed to delete task");return c.json()}function i(a,i){let j=(0,d.useQueryClient)(),k=["tasks",a,i||"all"],l=(0,c.useQuery)({queryKey:k,enabled:!!a,queryFn:()=>e(a,i)}),m=(0,b.useMutation)({mutationFn:b=>f(a,b),onSuccess:()=>j.invalidateQueries({queryKey:k})}),n=(0,b.useMutation)({mutationFn:b=>g(a,b),onSuccess:()=>j.invalidateQueries({queryKey:k})}),o=(0,b.useMutation)({mutationFn:b=>h(a,b),onSuccess:()=>j.invalidateQueries({queryKey:k})});return{query:l,tasks:l.data??[],createTask:m.mutateAsync,updateTask:n.mutateAsync,deleteTask:o.mutateAsync,creating:"pending"===m.status,updating:"pending"===n.status,deleting:"pending"===o.status}}a.s(["useTasks",()=>i])},71682,a=>{"use strict";var b=a.i(42343);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 348.106V80c0-26.51-21.49-48-48-48H48C21.49 32 0 53.49 0 80v351.988c0 26.51 21.49 48 48 48h268.118a48 48 0 0 0 33.941-14.059l83.882-83.882A48 48 0 0 0 448 348.106zm-128 80v-76.118h76.118L320 428.106zM400 80v223.988H296c-13.255 0-24 10.745-24 24v104H48V80h352z"},child:[]}]})(a)}a.s(["FaBell",()=>c,"FaEdit",()=>d,"FaRegStickyNote",()=>f,"FaTrash",()=>e])},69237,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(24089),e=a.i(77940),f=a.i(74653),g=a.i(48385),h=a.i(31796),i=a.i(43672),j=a.i(68386),k=a.i(15937),l=a.i(12218),m=a.i(7946),n=a.i(9386),o=a.i(10446),p=a.i(19470),q=a.i(51529),r=a.i(71682),s=a.i(29026),t=a.i(33217),u=a.i(66001);let v=[{value:"todo",label:"To do"},{value:"in-progress",label:"In progress"},{value:"done",label:"Done"}];function w({athleteId:a}){let{session:w}=(0,s.useSession)(),x=w?.email||"",{tasks:y,query:z,createTask:A,updateTask:B,deleteTask:C}=(0,q.useTasks)(x,a),D=(0,t.useQuery)({queryKey:["tasks-clients",x],queryFn:()=>(0,u.listClientsByAgencyEmail)(x),enabled:!!(x&&!a)}),[E,F]=c.default.useState(!1),[G,H]=c.default.useState(null),[I,J]=c.default.useState(""),[K,L]=c.default.useState(""),[M,N]=c.default.useState("todo"),[O,P]=c.default.useState(""),[Q,R]=c.default.useState(""),[S,T]=c.default.useState(""),U=async()=>{if(!I.trim())return void T("Title is required");let b=O?new Date(O).getTime():void 0;G?await B({id:G,title:I.trim(),description:K,status:M,dueAt:b??null}):await A({title:I.trim(),description:K,status:M,dueAt:b,athleteId:(a??Q)||null}),F(!1)},V=async a=>{await C(a)},W=c.default.useMemo(()=>{let a={};return(D.data||[]).forEach(b=>{a[b.id]=`${b.firstName||""} ${b.lastName||""}`.trim()||b.id}),a},[D.data]);return(0,b.jsxs)(d.Box,{children:[(0,b.jsxs)(n.Stack,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[(0,b.jsx)(p.Typography,{variant:"h6",children:"Tasks"}),(0,b.jsx)(e.Button,{variant:"contained",onClick:()=>{H(null),J(""),L(""),N("todo"),P(""),R(""),T(""),F(!0)},startIcon:(0,b.jsx)(r.FaBell,{}),children:"Add task"})]}),z.isLoading?(0,b.jsx)(p.Typography,{children:"Loading..."}):0===y.length?(0,b.jsx)(p.Typography,{color:"text.secondary",children:"No tasks yet."}):(0,b.jsx)(n.Stack,{spacing:1.5,children:y.map(a=>(0,b.jsxs)(m.Paper,{variant:"outlined",sx:{p:1.5,display:"flex",gap:1,alignItems:"flex-start"},"data-testid":"task-item",children:[(0,b.jsxs)(n.Stack,{spacing:.5,sx:{flex:1,minWidth:0},children:[(0,b.jsxs)(n.Stack,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,b.jsx)(f.Chip,{size:"small",label:v.find(b=>b.value===a.status)?.label||a.status}),a.dueAt?(0,b.jsx)(f.Chip,{size:"small",color:"warning",label:`Due ${new Date(a.dueAt).toLocaleString()}`}):null,a.athleteId&&W[a.athleteId]?(0,b.jsx)(f.Chip,{size:"small",label:W[a.athleteId]}):null]}),(0,b.jsx)(p.Typography,{variant:"subtitle1",sx:{fontWeight:700},children:a.title}),a.description?(0,b.jsx)(p.Typography,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-wrap"},children:a.description}):null]}),(0,b.jsxs)(n.Stack,{direction:"row",spacing:1,children:[(0,b.jsx)(k.IconButton,{"aria-label":"Edit task",onClick:()=>{var b;let c;return b=a.id,void((c=y.find(a=>a.id===b))&&(H(b),J(c.title),L(c.description||""),N(c.status),P(c.dueAt?new Date(c.dueAt).toISOString().slice(0,16):""),R(c.athleteId||""),T(""),F(!0)))},size:"small",children:(0,b.jsx)(r.FaEdit,{})}),(0,b.jsx)(k.IconButton,{"aria-label":"Delete task",onClick:()=>V(a.id),size:"small",children:(0,b.jsx)(r.FaTrash,{})})]})]},a.id))}),(0,b.jsxs)(g.Dialog,{open:E,onClose:()=>F(!1),fullWidth:!0,maxWidth:"sm",children:[(0,b.jsx)(j.DialogTitle,{children:G?"Edit task":"Add task"}),(0,b.jsxs)(i.DialogContent,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,b.jsx)(o.TextField,{label:"Title",value:I,onChange:a=>J(a.target.value),required:!0}),(0,b.jsx)(o.TextField,{label:"Description",value:K,onChange:a=>L(a.target.value),multiline:!0,minRows:3}),a?null:(0,b.jsxs)(o.TextField,{select:!0,label:"Assign athlete (optional)",value:Q,onChange:a=>R(a.target.value),SelectProps:{displayEmpty:!0},children:[(0,b.jsx)(l.MenuItem,{value:"",children:"Unassigned"}),(D.data||[]).map(a=>(0,b.jsxs)(l.MenuItem,{value:a.id,children:[a.firstName," ",a.lastName]},a.id))]}),(0,b.jsx)(o.TextField,{select:!0,label:"Status",value:M,onChange:a=>N(a.target.value),children:v.map(a=>(0,b.jsx)(l.MenuItem,{value:a.value,children:a.label},a.value))}),(0,b.jsx)(o.TextField,{label:"Due date/time",type:"datetime-local",value:O,onChange:a=>P(a.target.value),InputLabelProps:{shrink:!0}}),S?(0,b.jsx)(p.Typography,{color:"error",variant:"body2",children:S}):null]}),(0,b.jsxs)(h.DialogActions,{children:[(0,b.jsx)(e.Button,{onClick:()=>F(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{variant:"contained",onClick:U,children:"Save"})]})]})]})}a.s(["TasksPanel",()=>w])}];

//# sourceMappingURL=_3b782309._.js.map