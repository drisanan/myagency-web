{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/commits.ts"],"sourcesContent":["export type Commit = {\n  id: string;\n  sport: 'Football' | 'Basketball';\n  list: 'recent' | 'top';\n  rank?: number; // top only\n  name: string;\n  position?: string;\n  stars?: number;\n  university?: string;\n  commitDate?: string; // ISO for recent\n  source?: string;\n  logo?: string;\n  classYear?: string;\n  hometown?: string;\n  highSchool?: string;\n};\n\nconst STORAGE_KEY = 'commits_data';\n\nconst footballPositions = ['QB', 'RB', 'WR', 'DL', 'LB', 'CB', 'S', 'TE', 'OL'];\nconst basketballPositions = ['PG', 'SG', 'SF', 'PF', 'C'];\nconst sources = ['ESPN', 'Rivals', '247Sports'];\nconst universities = ['Alabama', 'Georgia', 'Ohio State', 'Texas', 'Duke', 'Kentucky', 'Kansas', 'Gonzaga', 'Michigan'];\n\nfunction isoDaysAgo(days: number) {\n  const d = new Date();\n  d.setDate(d.getDate() - days);\n  return d.toISOString().slice(0, 10);\n}\n\nfunction makeRecent(sport: Commit['sport'], prefix: string, positions: string[]): Commit[] {\n  return Array.from({ length: 50 }).map((_, i) => ({\n    id: `${prefix}-${i + 1}`,\n    sport,\n    list: 'recent' as const,\n    name: `${sport} Recent ${i + 1}`,\n    position: positions[i % positions.length],\n    university: universities[i % universities.length],\n    commitDate: isoDaysAgo(i * 5 + 1), // spread across ~250 days\n    source: sources[i % sources.length],\n  }));\n}\n\nfunction makeTop(sport: Commit['sport'], prefix: string, positions: string[]): Commit[] {\n  return Array.from({ length: 50 }).map((_, i) => ({\n    id: `${prefix}-${i + 1}`,\n    sport,\n    list: 'top' as const,\n    rank: i + 1,\n    name: `${sport} Top ${i + 1}`,\n    position: positions[i % positions.length],\n    university: universities[i % universities.length],\n    stars: 5 - (i % 3) || 5,\n    source: sources[i % sources.length],\n  }));\n}\n\nconst SEED: Commit[] = [\n  ...makeRecent('Football', 'fb-rec', footballPositions),\n  ...makeRecent('Basketball', 'bb-rec', basketballPositions),\n  ...makeTop('Football', 'fb-top', footballPositions),\n  ...makeTop('Basketball', 'bb-top', basketballPositions),\n];\n\nfunction readStore(): Commit[] {\n  if (typeof window === 'undefined') return [...SEED];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [...SEED];\n  try {\n    const parsed = JSON.parse(raw) as Commit[];\n    return parsed.length ? parsed : [...SEED];\n  } catch {\n    return [...SEED];\n  }\n}\n\nfunction writeStore(items: Commit[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nlet COMMITS: Commit[] = readStore();\nlet SCRAPED_FOOTBALL = false;\nlet SCRAPED_BASKETBALL = false;\n\nexport function listCommits(sport: Commit['sport'], list: Commit['list']) {\n  if (typeof window !== 'undefined') COMMITS = readStore();\n  const filtered = COMMITS.filter((c) => c.sport === sport && c.list === list);\n  if (list === 'recent') {\n    return filtered\n      .sort((a, b) => (b.commitDate || '').localeCompare(a.commitDate || ''))\n      .slice(0, 50);\n  }\n  return filtered\n    .sort((a, b) => (a.rank ?? 9999) - (b.rank ?? 9999))\n    .slice(0, 50);\n}\n\nexport function filterCommits(commits: Commit[], filters: { position?: string; university?: string }) {\n  return commits.filter((c) => {\n    const posMatch = filters.position ? (c.position || '').toLowerCase().includes(filters.position.toLowerCase()) : true;\n    const uniMatch = filters.university ? (c.university || '').toLowerCase().includes(filters.university.toLowerCase()) : true;\n    return posMatch && uniMatch;\n  });\n}\n\nexport function upsertCommits(commits: Commit[]) {\n  COMMITS = commits;\n  writeStore(COMMITS);\n  return COMMITS;\n}\n\nexport function footballScrapeStatus() {\n  return { scraped: SCRAPED_FOOTBALL };\n}\n\nexport function basketballScrapeStatus() {\n  return { scraped: SCRAPED_BASKETBALL };\n}\n\nexport function listCommitsServer(sport: Commit['sport'], list: Commit['list']) {\n  // server-side version that does not touch localStorage\n  const filtered = COMMITS.filter((c) => c.sport === sport && c.list === list);\n  if (list === 'recent') {\n    return filtered\n      .sort((a, b) => (b.commitDate || '').localeCompare(a.commitDate || ''))\n      .slice(0, 50);\n  }\n  return filtered\n    .sort((a, b) => (a.rank ?? 9999) - (b.rank ?? 9999))\n    .slice(0, 50);\n}\n\n// Load live football data from scraper (server-side only) at startup\nasync function loadFootballFromScrape() {\n  if (typeof window !== 'undefined') return; // client skip\n  try {\n    const { scrapeFootballTop } = await import('./commitsScraper');\n    const top = await scrapeFootballTop();\n    if (top.length) {\n      SCRAPED_FOOTBALL = true;\n      const topMapped: Commit[] = top.slice(0, 50).map((c) => ({\n        id: c.id,\n        sport: 'Football',\n        list: 'top',\n        rank: c.rank,\n        name: c.name,\n        position: c.position,\n        university: c.university,\n        stars: 5,\n        logo: c.logo,\n        classYear: c.classYear,\n        hometown: c.hometown,\n        highSchool: c.highSchool,\n        source: 'ESPN 300',\n      }));\n      const recent: Commit[] = topMapped.map((c, idx) => ({\n        ...c,\n        id: `${c.id}-recent`,\n        list: 'recent',\n        rank: undefined,\n        commitDate: new Date(Date.now() - idx * 24 * 3600 * 1000).toISOString().slice(0, 10),\n      }));\n      // Merge: keep basketball from current store (may be scraped), replace football\n      const existing = COMMITS.filter((c) => c.sport === 'Basketball');\n      COMMITS = [...existing, ...topMapped, ...recent];\n      writeStore(COMMITS);\n    } else {\n      // mark placeholders so tests can detect non-live data\n      COMMITS = COMMITS.map((c) =>\n        c.sport === 'Football' ? { ...c, name: `${c.name} (placeholder)` } : c\n      );\n      writeStore(COMMITS);\n    }\n  } catch (e) {\n    // ignore and keep seed\n  }\n}\n\nasync function loadBasketballFromScrape() {\n  if (typeof window !== 'undefined') return; // client skip\n  try {\n    const { scrapeBasketballTop } = await import('./commitsScraper');\n    const top = await scrapeBasketballTop();\n    if (top.length) {\n      SCRAPED_BASKETBALL = true;\n      const topMapped: Commit[] = top.slice(0, 50).map((c) => ({\n        id: c.id,\n        sport: 'Basketball',\n        list: 'top',\n        rank: c.rank,\n        name: c.name,\n        position: c.position,\n        university: c.university,\n        stars: 5,\n        logo: c.logo,\n        classYear: c.classYear,\n        hometown: c.hometown,\n        highSchool: c.highSchool,\n        source: 'ESPN 300',\n      }));\n      const recent: Commit[] = topMapped.map((c, idx) => ({\n        ...c,\n        id: `${c.id}-recent`,\n        list: 'recent',\n        rank: undefined,\n        commitDate: new Date(Date.now() - idx * 24 * 3600 * 1000).toISOString().slice(0, 10),\n      }));\n      // Merge: keep football from current store (may be scraped), replace basketball\n      const existing = COMMITS.filter((c) => c.sport === 'Football');\n      COMMITS = [...existing, ...topMapped, ...recent];\n      writeStore(COMMITS);\n    } else {\n      COMMITS = COMMITS.map((c) =>\n        c.sport === 'Basketball' ? { ...c, name: `${c.name} (placeholder)` } : c\n      );\n      writeStore(COMMITS);\n    }\n  } catch (e) {\n    // ignore and keep seed\n  }\n}\n\n// Trigger server-side load\nloadFootballFromScrape();\nloadBasketballFromScrape();\n\n\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAiBA,MAAM,cAAc;AAEpB,MAAM,oBAAoB;IAAC;IAAM;IAAM;IAAM;IAAM;IAAM;IAAM;IAAK;IAAM;CAAK;AAC/E,MAAM,sBAAsB;IAAC;IAAM;IAAM;IAAM;IAAM;CAAI;AACzD,MAAM,UAAU;IAAC;IAAQ;IAAU;CAAY;AAC/C,MAAM,eAAe;IAAC;IAAW;IAAW;IAAc;IAAS;IAAQ;IAAY;IAAU;IAAW;CAAW;AAEvH,SAAS,WAAW,IAAY;IAC9B,MAAM,IAAI,IAAI;IACd,EAAE,OAAO,CAAC,EAAE,OAAO,KAAK;IACxB,OAAO,EAAE,WAAW,GAAG,KAAK,CAAC,GAAG;AAClC;AAEA,SAAS,WAAW,KAAsB,EAAE,MAAc,EAAE,SAAmB;IAC7E,OAAO,MAAM,IAAI,CAAC;QAAE,QAAQ;IAAG,GAAG,GAAG,CAAC,CAAC,GAAG,IAAM,CAAC;YAC/C,IAAI,GAAG,OAAO,CAAC,EAAE,IAAI,GAAG;YACxB;YACA,MAAM;YACN,MAAM,GAAG,MAAM,QAAQ,EAAE,IAAI,GAAG;YAChC,UAAU,SAAS,CAAC,IAAI,UAAU,MAAM,CAAC;YACzC,YAAY,YAAY,CAAC,IAAI,aAAa,MAAM,CAAC;YACjD,YAAY,WAAW,IAAI,IAAI;YAC/B,QAAQ,OAAO,CAAC,IAAI,QAAQ,MAAM,CAAC;QACrC,CAAC;AACH;AAEA,SAAS,QAAQ,KAAsB,EAAE,MAAc,EAAE,SAAmB;IAC1E,OAAO,MAAM,IAAI,CAAC;QAAE,QAAQ;IAAG,GAAG,GAAG,CAAC,CAAC,GAAG,IAAM,CAAC;YAC/C,IAAI,GAAG,OAAO,CAAC,EAAE,IAAI,GAAG;YACxB;YACA,MAAM;YACN,MAAM,IAAI;YACV,MAAM,GAAG,MAAM,KAAK,EAAE,IAAI,GAAG;YAC7B,UAAU,SAAS,CAAC,IAAI,UAAU,MAAM,CAAC;YACzC,YAAY,YAAY,CAAC,IAAI,aAAa,MAAM,CAAC;YACjD,OAAO,IAAK,IAAI,KAAM;YACtB,QAAQ,OAAO,CAAC,IAAI,QAAQ,MAAM,CAAC;QACrC,CAAC;AACH;AAEA,MAAM,OAAiB;OAClB,WAAW,YAAY,UAAU;OACjC,WAAW,cAAc,UAAU;OACnC,QAAQ,YAAY,UAAU;OAC9B,QAAQ,cAAc,UAAU;CACpC;AAED,SAAS;IACP,wCAAmC,OAAO;WAAI;KAAK;;;IACnD,MAAM;AAQR;AAEA,SAAS,WAAW,KAAe;IACjC,wCAAmC;;;AAErC;AAEA,IAAI,UAAoB;AACxB,IAAI,mBAAmB;AACvB,IAAI,qBAAqB;AAElB,SAAS,YAAY,KAAsB,EAAE,IAAoB;IACtE;;IACA,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,SAAS,EAAE,IAAI,KAAK;IACvE,IAAI,SAAS,UAAU;QACrB,OAAO,SACJ,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,UAAU,IAAI,EAAE,EAAE,aAAa,CAAC,EAAE,UAAU,IAAI,KAClE,KAAK,CAAC,GAAG;IACd;IACA,OAAO,SACJ,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,CAAC,EAAE,IAAI,IAAI,IAAI,GACjD,KAAK,CAAC,GAAG;AACd;AAEO,SAAS,cAAc,OAAiB,EAAE,OAAmD;IAClG,OAAO,QAAQ,MAAM,CAAC,CAAC;QACrB,MAAM,WAAW,QAAQ,QAAQ,GAAG,CAAC,EAAE,QAAQ,IAAI,EAAE,EAAE,WAAW,GAAG,QAAQ,CAAC,QAAQ,QAAQ,CAAC,WAAW,MAAM;QAChH,MAAM,WAAW,QAAQ,UAAU,GAAG,CAAC,EAAE,UAAU,IAAI,EAAE,EAAE,WAAW,GAAG,QAAQ,CAAC,QAAQ,UAAU,CAAC,WAAW,MAAM;QACtH,OAAO,YAAY;IACrB;AACF;AAEO,SAAS,cAAc,OAAiB;IAC7C,UAAU;IACV,WAAW;IACX,OAAO;AACT;AAEO,SAAS;IACd,OAAO;QAAE,SAAS;IAAiB;AACrC;AAEO,SAAS;IACd,OAAO;QAAE,SAAS;IAAmB;AACvC;AAEO,SAAS,kBAAkB,KAAsB,EAAE,IAAoB;IAC5E,uDAAuD;IACvD,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,SAAS,EAAE,IAAI,KAAK;IACvE,IAAI,SAAS,UAAU;QACrB,OAAO,SACJ,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,UAAU,IAAI,EAAE,EAAE,aAAa,CAAC,EAAE,UAAU,IAAI,KAClE,KAAK,CAAC,GAAG;IACd;IACA,OAAO,SACJ,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,CAAC,EAAE,IAAI,IAAI,IAAI,GACjD,KAAK,CAAC,GAAG;AACd;AAEA,qEAAqE;AACrE,eAAe;IACb;;KAA2C,cAAc;IACzD,IAAI;QACF,MAAM,EAAE,iBAAiB,EAAE,GAAG;QAC9B,MAAM,MAAM,MAAM;QAClB,IAAI,IAAI,MAAM,EAAE;YACd,mBAAmB;YACnB,MAAM,YAAsB,IAAI,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,IAAM,CAAC;oBACvD,IAAI,EAAE,EAAE;oBACR,OAAO;oBACP,MAAM;oBACN,MAAM,EAAE,IAAI;oBACZ,MAAM,EAAE,IAAI;oBACZ,UAAU,EAAE,QAAQ;oBACpB,YAAY,EAAE,UAAU;oBACxB,OAAO;oBACP,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,SAAS;oBACtB,UAAU,EAAE,QAAQ;oBACpB,YAAY,EAAE,UAAU;oBACxB,QAAQ;gBACV,CAAC;YACD,MAAM,SAAmB,UAAU,GAAG,CAAC,CAAC,GAAG,MAAQ,CAAC;oBAClD,GAAG,CAAC;oBACJ,IAAI,GAAG,EAAE,EAAE,CAAC,OAAO,CAAC;oBACpB,MAAM;oBACN,MAAM;oBACN,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,MAAM,KAAK,OAAO,MAAM,WAAW,GAAG,KAAK,CAAC,GAAG;gBACnF,CAAC;YACD,+EAA+E;YAC/E,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;YACnD,UAAU;mBAAI;mBAAa;mBAAc;aAAO;YAChD,WAAW;QACb,OAAO;YACL,sDAAsD;YACtD,UAAU,QAAQ,GAAG,CAAC,CAAC,IACrB,EAAE,KAAK,KAAK,aAAa;oBAAE,GAAG,CAAC;oBAAE,MAAM,GAAG,EAAE,IAAI,CAAC,cAAc,CAAC;gBAAC,IAAI;YAEvE,WAAW;QACb;IACF,EAAE,OAAO,GAAG;IACV,uBAAuB;IACzB;AACF;AAEA,eAAe;IACb;;KAA2C,cAAc;IACzD,IAAI;QACF,MAAM,EAAE,mBAAmB,EAAE,GAAG;QAChC,MAAM,MAAM,MAAM;QAClB,IAAI,IAAI,MAAM,EAAE;YACd,qBAAqB;YACrB,MAAM,YAAsB,IAAI,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,IAAM,CAAC;oBACvD,IAAI,EAAE,EAAE;oBACR,OAAO;oBACP,MAAM;oBACN,MAAM,EAAE,IAAI;oBACZ,MAAM,EAAE,IAAI;oBACZ,UAAU,EAAE,QAAQ;oBACpB,YAAY,EAAE,UAAU;oBACxB,OAAO;oBACP,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,SAAS;oBACtB,UAAU,EAAE,QAAQ;oBACpB,YAAY,EAAE,UAAU;oBACxB,QAAQ;gBACV,CAAC;YACD,MAAM,SAAmB,UAAU,GAAG,CAAC,CAAC,GAAG,MAAQ,CAAC;oBAClD,GAAG,CAAC;oBACJ,IAAI,GAAG,EAAE,EAAE,CAAC,OAAO,CAAC;oBACpB,MAAM;oBACN,MAAM;oBACN,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,MAAM,KAAK,OAAO,MAAM,WAAW,GAAG,KAAK,CAAC,GAAG;gBACnF,CAAC;YACD,+EAA+E;YAC/E,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;YACnD,UAAU;mBAAI;mBAAa;mBAAc;aAAO;YAChD,WAAW;QACb,OAAO;YACL,UAAU,QAAQ,GAAG,CAAC,CAAC,IACrB,EAAE,KAAK,KAAK,eAAe;oBAAE,GAAG,CAAC;oBAAE,MAAM,GAAG,EAAE,IAAI,CAAC,cAAc,CAAC;gBAAC,IAAI;YAEzE,WAAW;QACb;IACF,EAAE,OAAO,GAAG;IACV,uBAAuB;IACzB;AACF;AAEA,2BAA2B;AAC3B;AACA"}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/commitsCache.ts"],"sourcesContent":["import { listCommitsServer, type Commit } from './commits';\n\nconst ONE_DAY_MS = 24 * 60 * 60 * 1000;\n\ntype CacheKey = `${Commit['sport']}-${Commit['list']}`;\n\ntype CacheEntry = {\n  data: Commit[];\n  ts: number;\n};\n\nconst cache = new Map<CacheKey, CacheEntry>();\n\nexport async function getCachedCommits(\n  sport: Commit['sport'],\n  list: Commit['list'],\n  ttlMs = ONE_DAY_MS,\n) {\n  const key: CacheKey = `${sport}-${list}`;\n  const now = Date.now();\n  const hit = cache.get(key);\n  if (hit && now - hit.ts < ttlMs) {\n    return hit.data;\n  }\n  const data = listCommitsServer(sport, list);\n  cache.set(key, { data, ts: now });\n  return data;\n}\n\nexport function clearCommitsCache() {\n  cache.clear();\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,aAAa,KAAK,KAAK,KAAK;AASlC,MAAM,QAAQ,IAAI;AAEX,eAAe,iBACpB,KAAsB,EACtB,IAAoB,EACpB,QAAQ,UAAU;IAElB,MAAM,MAAgB,GAAG,MAAM,CAAC,EAAE,MAAM;IACxC,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,MAAM,MAAM,GAAG,CAAC;IACtB,IAAI,OAAO,MAAM,IAAI,EAAE,GAAG,OAAO;QAC/B,OAAO,IAAI,IAAI;IACjB;IACA,MAAM,OAAO,IAAA,0IAAiB,EAAC,OAAO;IACtC,MAAM,GAAG,CAAC,KAAK;QAAE;QAAM,IAAI;IAAI;IAC/B,OAAO;AACT;AAEO,SAAS;IACd,MAAM,KAAK;AACb"}},
    {"offset": {"line": 330, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/api/commits/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { getCachedCommits } from '@/services/commitsCache';\n\nexport async function GET(req: NextRequest) {\n  const { searchParams } = new URL(req.url);\n  const sport = (searchParams.get('sport') as 'Football' | 'Basketball') || 'Football';\n  const list = (searchParams.get('list') as 'recent' | 'top') || 'recent';\n  const data = await getCachedCommits(sport, list);\n  return NextResponse.json(\n    { ok: true, data },\n    {\n      headers: {\n        // small client cache plus stale-while-revalidate hint\n        'Cache-Control': 'public, max-age=300, stale-while-revalidate=86400',\n      },\n    },\n  );\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,QAAQ,AAAC,aAAa,GAAG,CAAC,YAA0C;IAC1E,MAAM,OAAO,AAAC,aAAa,GAAG,CAAC,WAAgC;IAC/D,MAAM,OAAO,MAAM,IAAA,8IAAgB,EAAC,OAAO;IAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;QAAE,IAAI;QAAM;IAAK,GACjB;QACE,SAAS;YACP,sDAAsD;YACtD,iBAAiB;QACnB;IACF;AAEJ"}}]
}