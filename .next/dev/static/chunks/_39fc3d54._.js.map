{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/audit.ts"],"sourcesContent":["export type AuditEventType = 'impersonation_start' | 'impersonation_end' | 'navigation' | 'action';\nexport type AuditEvent = {\n  id: string;\n  type: AuditEventType;\n  timestamp: number;\n  actorEmail: string;\n  actorRole: string;\n  targetAgencyEmail?: string;\n  details?: Record<string, any>;\n};\n\nconst STORAGE_KEY = 'audit_log';\n\nfunction readLog(): AuditEvent[] {\n  if (typeof window === 'undefined') return [];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [];\n  try {\n    return JSON.parse(raw) as AuditEvent[];\n  } catch {\n    return [];\n  }\n}\n\nfunction writeLog(events: AuditEvent[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(events));\n}\n\nexport function logEvent(event: Omit<AuditEvent, 'id' | 'timestamp'>) {\n  const ev: AuditEvent = {\n    ...event,\n    id: `${Date.now()}-${Math.random().toString(36).slice(2)}`,\n    timestamp: Date.now(),\n  };\n  const current = readLog();\n  current.push(ev);\n  writeLog(current);\n  return ev.id;\n}\n\nexport function logImpersonationStart(parentEmail: string, agencyEmail: string) {\n  return logEvent({\n    type: 'impersonation_start',\n    actorEmail: parentEmail,\n    actorRole: 'parent',\n    targetAgencyEmail: agencyEmail,\n  });\n}\n\nexport function logImpersonationEnd(parentEmail: string, agencyEmail: string) {\n  return logEvent({\n    type: 'impersonation_end',\n    actorEmail: parentEmail,\n    actorRole: 'parent',\n    targetAgencyEmail: agencyEmail,\n  });\n}\n\nexport function listAuditLog(): AuditEvent[] {\n  return readLog();\n}\n\nexport function clearAuditLog() {\n  writeLog([]);\n}\n\n\n"],"names":[],"mappings":";;;;;;;;;;;;AAWA,MAAM,cAAc;AAEpB,SAAS;IACP;;IACA,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;IACxC,IAAI,CAAC,KAAK,OAAO,EAAE;IACnB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,SAAS,MAAoB;IACpC;;IACA,OAAO,YAAY,CAAC,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;AAC1D;AAEO,SAAS,SAAS,KAA2C;IAClE,MAAM,KAAiB;QACrB,GAAG,KAAK;QACR,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,IAAI;QAC1D,WAAW,KAAK,GAAG;IACrB;IACA,MAAM,UAAU;IAChB,QAAQ,IAAI,CAAC;IACb,SAAS;IACT,OAAO,GAAG,EAAE;AACd;AAEO,SAAS,sBAAsB,WAAmB,EAAE,WAAmB;IAC5E,OAAO,SAAS;QACd,MAAM;QACN,YAAY;QACZ,WAAW;QACX,mBAAmB;IACrB;AACF;AAEO,SAAS,oBAAoB,WAAmB,EAAE,WAAmB;IAC1E,OAAO,SAAS;QACd,MAAM;QACN,YAAY;QACZ,WAAW;QACX,mBAAmB;IACrB;AACF;AAEO,SAAS;IACd,OAAO;AACT;AAEO,SAAS;IACd,SAAS,EAAE;AACb"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/app-shell.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { Box, CssBaseline, AppBar, Toolbar, Typography, Drawer, List, ListItemButton, ListItemText, Button, Alert, Stack } from '@mui/material';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { useSession } from '@/features/auth/session';\nimport { logImpersonationEnd } from '@/services/audit';\nimport { colors } from '@/theme/colors';\nimport { IoAppsOutline, IoBarbellOutline, IoFlaskOutline, IoClipboardOutline, IoSchoolOutline } from 'react-icons/io5';\nconst drawerWidth = 240;\n\nexport function AppShell({ children }: { children: React.ReactNode }) {\n  const { session, setSession } = useSession();\n  const pathname = usePathname();\n\n  const stopImpersonation = React.useCallback(() => {\n    if (typeof window === 'undefined') return;\n    const baseRaw = window.localStorage.getItem('session_impersonation_base');\n    if (session?.impersonatedBy && baseRaw) {\n      const base = JSON.parse(baseRaw);\n      logImpersonationEnd(base.email, session.email);\n      setSession(base);\n      window.localStorage.removeItem('session_impersonation_base');\n    }\n  }, [session, setSession]);\n\n  const navItemSx = {\n    width: 'calc(100% - 20px)', // leave 10px inset on each side\n    mx: '10px',\n    px: 1.25, // ~10px horizontal padding inside\n    color: colors.sidebarText,\n    borderRadius: '5px',\n    py: 0.5,\n    '&:hover': {\n      bgcolor: 'rgba(255, 255, 255, 0.04)',\n    },\n    '&.Mui-selected, &.Mui-selected:hover': {\n      bgcolor: colors.navActiveBg,\n      color: colors.navActiveText,\n    },\n    justifyContent: 'flex-start',\n  };\n\n  const navItems = [\n    { href: '/dashboard', label: 'Dashboard', icon: <IoAppsOutline /> },\n    ...(session?.role === 'parent' && !session?.impersonatedBy ? [{ href: '/agencies', label: 'Agencies', icon: <IoAppsOutline /> }] : []),\n    { href: '/clients', label: 'Athletes', icon: <IoBarbellOutline /> },\n    { href: '/ai/prompts', label: 'Prompts', icon: <IoFlaskOutline /> },\n    { href: '/lists', label: 'Lists', icon: <IoClipboardOutline /> },\n    { href: '/recruiter', label: 'Recruiter', icon: <IoSchoolOutline /> },\n  ];\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        minHeight: '100vh',\n        backgroundImage: 'url(/marketing/bg-an.png)',\n        backgroundRepeat: 'no-repeat',\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n      }}\n    >\n      <CssBaseline />\n      <AppBar\n        position=\"fixed\"\n        sx={{\n          zIndex: (t) => t.zIndex.drawer + 1,\n          bgcolor: 'transparent',\n          boxShadow: 'none',\n          color: 'inherit',\n        }}\n      >\n        <Toolbar sx={{ justifyContent: 'space-between', px: 2 }}>\n          <Box sx={{ display: 'flex', alignItems: 'center', minHeight: 48 }}>\n            {session?.agencyLogo ? (\n              <img src={session.agencyLogo} alt=\"Agency Logo\" style={{ height: 32, objectFit: 'contain' }} />\n            ) : (\n              <img src=\"/marketing/an-logo.png\" alt=\"Athlete Narrative\" style={{ height: 32, objectFit: 'contain' }} />\n            )}\n          </Box>\n          {session?.impersonatedBy && (\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n              <Typography variant=\"body2\" sx={{ color: '#212636' }}>\n                Impersonating drisanjames@gmail.com as admin\n              </Typography>\n              <Button color=\"inherit\" variant=\"outlined\" onClick={stopImpersonation}>Stop Impersonating</Button>\n            </Box>\n          )}\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        variant=\"permanent\"\n        sx={{\n          width: drawerWidth,\n          '& .MuiDrawer-paper': {\n            width: drawerWidth,\n            boxSizing: 'border-box',\n            bgcolor: colors.sidebarBg,\n            color: colors.sidebarText,\n          },\n        }}\n      >\n        <Toolbar />\n        <List sx={{ display: 'flex', flexDirection: 'column', gap: '5px', mt: 2.5 /* ~20px */ }}>\n          {navItems.map((item) => {\n            const selected = pathname === item.href || pathname?.startsWith(`${item.href}/`);\n            return (\n              <ListItemButton\n                key={item.href}\n                LinkComponent={Link}\n                href={item.href}\n                sx={navItemSx}\n                selected={selected}\n              >\n                <Stack direction=\"row\" spacing={2} alignItems=\"center\">\n                  {item.icon}\n                  <ListItemText primary={item.label} />\n                </Stack>\n              </ListItemButton>\n            );\n          })}\n        </List>\n      </Drawer>\n      <Box\n        component=\"main\"\n        sx={{\n          flexGrow: 1,\n          p: 3,\n        }}\n      >\n        <Toolbar />\n        {session?.impersonatedBy && (\n          <Alert severity=\"error\" sx={{ mb: 2 }}>\n            You are impersonating agency account: {session.email}. Actions will be logged.\n          </Alert>\n        )}\n        {children}\n      </Box>\n    </Box>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 435, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/guard.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useSession } from '@/features/auth/session';\n\nexport function AuthGuard({ children }: { children: React.ReactNode }) {\n  const { session, loading } = useSession();\n  const router = useRouter();\n  React.useEffect(() => { if (!loading && !session) router.replace('/auth/login'); }, [loading, session, router]);\n  if (loading) return null;\n  return <>{children}</>;\n}\n\n\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAKO,SAAS,UAAU,EAAE,QAAQ,EAAiC;;IACnE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,IAAA,6IAAU;IACvC,MAAM,SAAS,IAAA,kJAAS;IACxB,wKAAK,CAAC,SAAS;+BAAC;YAAQ,IAAI,CAAC,WAAW,CAAC,SAAS,OAAO,OAAO,CAAC;QAAgB;8BAAG;QAAC;QAAS;QAAS;KAAO;IAC9G,IAAI,SAAS,OAAO;IACpB,qBAAO;kBAAG;;AACZ;GANgB;;QACe,6IAAU;QACxB,kJAAS;;;KAFV"}}]
}