{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/agencies.ts"],"sourcesContent":["const STORAGE_KEY = 'agencies_data';\n\nfunction readStore(): Agency[] {\n  if (typeof window === 'undefined') return [];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [];\n  try {\n    return JSON.parse(raw) as Agency[];\n  } catch {\n    return [];\n  }\n}\n\nfunction writeStore(items: Agency[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nexport type AgencySettings = {\n  primaryColor?: string;\n  secondaryColor?: string;\n  logoDataUrl?: string;\n};\nexport type Agency = {\n  id: string;\n  name: string;\n  email: string;\n  password?: string;\n  ownerFirstName?: string;\n  ownerLastName?: string;\n  ownerEmail?: string;\n  ownerPhone?: string;\n  active?: boolean;\n  settings?: AgencySettings;\n};\n\nconst SEED_AGENCIES: Agency[] = [\n  { id: 'agency-001', name: 'Prime Sports', email: 'agency1@an.test', settings: { primaryColor: '#1976d2' } },\n  { id: 'agency-002', name: 'NextGen', email: 'agency2@an.test', settings: { primaryColor: '#9c27b0' } },\n  { id: 'agency-003', name: 'Elite Edge', email: 'agency3@an.test', settings: { primaryColor: '#2e7d32' } },\n];\n\nlet AGENCIES: Agency[] = (() => {\n  const fromStore = readStore();\n  if (fromStore.length > 0) return fromStore;\n  writeStore(SEED_AGENCIES);\n  return [...SEED_AGENCIES];\n})();\n\nexport { AGENCIES };\n\nexport async function listAgencies() {\n  return AGENCIES.map(a => ({ id: a.id, name: a.name }));\n}\n\nexport async function getAgencies() {\n  return [...AGENCIES];\n}\n\nexport async function getAgencyByEmail(email: string) {\n  return AGENCIES.find(a => a.email === email) ?? null;\n}\n\nexport async function getAgencyById(id: string) {\n  return AGENCIES.find(a => a.id === id) ?? null;\n}\n\nexport async function getAgencySettings(email: string) {\n  const a = AGENCIES.find(x => x.email === email);\n  return a?.settings ?? {};\n}\n\nexport async function updateAgencySettings(email: string, settings: AgencySettings) {\n  const a = AGENCIES.find(x => x.email === email);\n  if (!a) return { ok: false };\n  a.settings = { ...(a.settings ?? {}), ...settings };\n  writeStore(AGENCIES);\n  return { ok: true, settings: a.settings };\n}\n\ntype UpsertInput = Omit<Agency, 'id'> & { id?: string };\nexport async function upsertAgency(input: UpsertInput) {\n  if (input.id) {\n    const idx = AGENCIES.findIndex(a => a.id === input.id);\n    if (idx >= 0) {\n      AGENCIES[idx] = { ...AGENCIES[idx], ...input, id: input.id };\n      writeStore(AGENCIES);\n      return { id: input.id };\n    }\n  }\n  const id = `agency-${(Math.random() * 1e6).toFixed(0)}`;\n  AGENCIES.push({\n    id,\n    name: input.name,\n    email: input.email,\n    password: input.password,\n    ownerFirstName: input.ownerFirstName,\n    ownerLastName: input.ownerLastName,\n    ownerEmail: input.ownerEmail,\n    ownerPhone: input.ownerPhone,\n    active: input.active ?? true,\n    settings: input.settings ?? {},\n  });\n  writeStore(AGENCIES);\n  return { id };\n}\n\nexport async function deleteAgency(id: string) {\n  const idx = AGENCIES.findIndex(a => a.id === id);\n  if (idx >= 0) {\n    AGENCIES.splice(idx, 1);\n    writeStore(AGENCIES);\n    return { ok: true };\n  }\n  return { ok: false };\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/clients.ts"],"sourcesContent":["import { getAgencyById } from '@/services/agencies';\n\ntype Client = {\n  id: string;\n  email: string;\n  firstName: string;\n  lastName: string;\n  sport: string;\n  agencyEmail: string;\n  agencyId?: string;\n  password?: string;\n  radar?: any;\n  gmailTokens?: any;\n  gmailConnected?: boolean;\n};\n\nconst STORAGE_KEY = 'clients_data';\n\nconst SEED_CLIENTS: Client[] = [\n  { id: 'ag1-c1', email: 'a1@athletes.test', firstName: 'Ava', lastName: 'Smith', sport: 'Football', agencyEmail: 'agency1@an.test' },\n  { id: 'ag1-c2', email: 'a2@athletes.test', firstName: 'Ben', lastName: 'Jones', sport: 'Basketball', agencyEmail: 'agency1@an.test' },\n  { id: 'ag2-c1', email: 'b1@athletes.test', firstName: 'Cara', lastName: 'Lee', sport: 'Baseball', agencyEmail: 'agency2@an.test' },\n  { id: 'ag3-c1', email: 'c1@athletes.test', firstName: 'Dan', lastName: 'Kim', sport: 'Soccer', agencyEmail: 'agency3@an.test' },\n];\n\nfunction readStore(): Client[] {\n  if (typeof window === 'undefined') return [...SEED_CLIENTS];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [...SEED_CLIENTS];\n  try {\n    const parsed = JSON.parse(raw) as Client[];\n    return parsed.length ? parsed : [...SEED_CLIENTS];\n  } catch {\n    return [...SEED_CLIENTS];\n  }\n}\n\nfunction writeStore(items: Client[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nlet CLIENTS: Client[] = readStore();\n\nexport async function listClientsByAgencyEmail(agencyEmail: string) {\n  if (typeof window !== 'undefined') {\n    CLIENTS = readStore();\n  }\n  return CLIENTS.filter(c => c.agencyEmail === agencyEmail);\n}\n\nexport async function listClientsByAgency(agencyId: string) {\n  const agency = await getAgencyById(agencyId);\n  if (!agency) return [];\n  return listClientsByAgencyEmail(agency.email);\n}\nexport async function upsertClient(input: any) {\n  const id = input.id ?? `c-${(Math.random() * 1e6).toFixed(0)}`;\n  const idx = CLIENTS.findIndex(c => c.id === id);\n  if (typeof window !== 'undefined') {\n    // helpful for e2e debugging\n    // eslint-disable-next-line no-console\n    console.debug('[clients] upsertClient payload', input);\n  }\n  const next: Client = { ...CLIENTS[idx] , ...input, id };\n  if (idx >= 0) {\n    CLIENTS[idx] = next;\n  } else {\n    CLIENTS.push(next);\n  }\n  writeStore(CLIENTS);\n  return next;\n}\nexport async function getClient(id: string) {\n  if (typeof window !== 'undefined') {\n    CLIENTS = readStore();\n  }\n  if (typeof window !== 'undefined') {\n    try {\n      const raw = window.localStorage.getItem(STORAGE_KEY);\n      if (raw) {\n        const list = JSON.parse(raw) as Client[];\n        const hit = list.find((c) => c.id === id);\n        if (hit) {\n          CLIENTS = list;\n          return hit;\n        }\n      }\n    } catch {\n      // ignore\n    }\n  }\n  let found = CLIENTS.find(c => c.id === id);\n  if (!found) {\n    CLIENTS = readStore();\n    found = CLIENTS.find(c => c.id === id);\n  }\n  return found ?? { id, email: 'athlete1@example.com', firstName: 'A1', lastName: 'L1', sport: 'Football', agencyEmail: '' };\n}\nexport async function deleteClient(id: string) {\n  const idx = CLIENTS.findIndex(c => c.id === id);\n  if (idx >= 0) {\n    CLIENTS.splice(idx, 1);\n    writeStore(CLIENTS);\n  }\n  return { ok: true };\n}\nexport async function getClients() {\n  // Determine current session from localStorage to enforce tenancy\n  const raw = typeof window !== 'undefined' ? window.localStorage.getItem('session') : null;\n  if (raw) {\n    try {\n      const s = JSON.parse(raw) as { role: 'parent' | 'agency'; email: string };\n      if (s.role === 'agency') {\n        const list = await listClientsByAgencyEmail(s.email);\n        if (typeof window !== 'undefined') {\n          // eslint-disable-next-line no-console\n          console.debug('[clients] getClients list size', list.length);\n        }\n        return list;\n      }\n    } catch {\n      // fall through\n    }\n  }\n  return [];\n}\n\nexport function setClientGmailTokens(clientId: string, tokens: any) {\n  const idx = CLIENTS.findIndex(c => c.id === clientId);\n  if (idx >= 0) {\n    CLIENTS[idx] = { ...CLIENTS[idx], gmailTokens: tokens, gmailConnected: true };\n    writeStore(CLIENTS);\n  }\n}\n\nexport function getClientGmailTokens(clientId: string): any | null {\n  const found = CLIENTS.find(c => c.id === clientId);\n  return found?.gmailTokens ?? null;\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 361, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/mailStatus.ts"],"sourcesContent":["const STORAGE_KEY = 'mail_log_v1';\n\ntype MailEntry = { clientId: string; email: string; mailedAt: number };\n\nfunction read(): MailEntry[] {\n  if (typeof window === 'undefined') return [];\n  try {\n    const raw = window.localStorage.getItem(STORAGE_KEY);\n    return raw ? (JSON.parse(raw) as MailEntry[]) : [];\n  } catch {\n    return [];\n  }\n}\n\nfunction write(items: MailEntry[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nexport function hasMailed(clientId: string, email: string): boolean {\n  const all = read();\n  return all.some((e) => e.clientId === clientId && e.email === email);\n}\n\nexport function markMailed(clientId: string, emails: string[]) {\n  const now = Date.now();\n  const all = read();\n  const next = [...all];\n  emails.forEach((e) => {\n    const email = (e || '').trim();\n    if (!email) return;\n    if (!next.some((x) => x.clientId === clientId && x.email === email)) {\n      next.push({ clientId, email, mailedAt: now });\n    }\n  });\n  write(next);\n}\n\nexport function getMailEntries() {\n  return read();\n}\n\n\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,cAAc;AAIpB,SAAS;IACP;;IACA,IAAI;QACF,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;QACxC,OAAO,MAAO,KAAK,KAAK,CAAC,OAAuB,EAAE;IACpD,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,MAAM,KAAkB;IAC/B;;IACA,OAAO,YAAY,CAAC,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;AAC1D;AAEO,SAAS,UAAU,QAAgB,EAAE,KAAa;IACvD,MAAM,MAAM;IACZ,OAAO,IAAI,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,YAAY,EAAE,KAAK,KAAK;AAChE;AAEO,SAAS,WAAW,QAAgB,EAAE,MAAgB;IAC3D,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,MAAM;IACZ,MAAM,OAAO;WAAI;KAAI;IACrB,OAAO,OAAO,CAAC,CAAC;QACd,MAAM,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI;QAC5B,IAAI,CAAC,OAAO;QACZ,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,YAAY,EAAE,KAAK,KAAK,QAAQ;YACnE,KAAK,IAAI,CAAC;gBAAE;gBAAU;gBAAO,UAAU;YAAI;QAC7C;IACF;IACA,MAAM;AACR;AAEO,SAAS;IACd,OAAO;AACT"}},
    {"offset": {"line": 418, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/clients/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport {\n  Avatar,\n  Box,\n  Button,\n  Card,\n  CardContent,\n  Chip,\n  Collapse,\n  Divider,\n  List,\n  ListItem,\n  ListItemText,\n  Menu,\n  MenuItem,\n  Stack,\n  Tab,\n  Tabs,\n  Typography,\n} from '@mui/material';\nimport { IoChevronDownOutline } from 'react-icons/io5';\nimport { useParams, useRouter } from 'next/navigation';\nimport { getClient } from '@/services/clients';\nimport { getMailEntries } from '@/services/mailStatus';\n\ntype MailEntry = ReturnType<typeof getMailEntries>[number] & {\n  id?: string;\n  to?: string;\n  recipientFirstName?: string;\n  recipientLastName?: string;\n  university?: string;\n  position?: string;\n  subject?: string;\n  body?: string;\n  html?: string;\n  sentAt?: number;\n  date?: number;\n};\n\nexport default function ClientProfilePage() {\n  const params = useParams();\n  const router = useRouter();\n  const id = Array.isArray(params?.id) ? params?.id[0] : (params?.id as string | undefined);\n\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const [tab, setTab] = React.useState(0);\n  const [expandedId, setExpandedId] = React.useState<string | null>(null);\n  const [client, setClient] = React.useState<any | null>(null);\n\n  React.useEffect(() => {\n    let mounted = true;\n    (async () => {\n      if (!id) return;\n      const c = await getClient(id);\n      if (mounted) setClient(c);\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, [id]);\n\n  const mails: MailEntry[] = React.useMemo(() => {\n    if (!client?.id) return [];\n    return (getMailEntries() as MailEntry[]).filter((m) => m.clientId === client.id);\n  }, [client?.id]);\n\n  if (!client) {\n    return (\n      <Box sx={{ p: 3 }}>\n        <Typography variant=\"h6\">Athlete not found</Typography>\n      </Box>\n    );\n  }\n\n  const name = `${client.firstName ?? ''} ${client.lastName ?? ''}`.trim() || 'Unknown Athlete';\n  const formatSport = (raw?: string) => {\n    if (!raw) return 'Unknown sport';\n    // Insert space before capital letters for camel-cased sports like MensSwimming -> Mens Swimming\n    return raw.replace(/([a-z])([A-Z])/g, '$1 $2');\n  };\n  const sport = formatSport(client.sport);\n  const photo = client.photoUrl || client.profileImageUrl || '/marketing/an-logo.png';\n\n  const handleMenuOpen = (e: React.MouseEvent<HTMLElement>) => setAnchorEl(e.currentTarget);\n  const handleMenuClose = () => setAnchorEl(null);\n\n  return (\n    <Box sx={{ p: 3, bgcolor: '#fff', borderRadius: 2 }}>\n      <Stack direction=\"row\" alignItems=\"center\" spacing={2} sx={{ mb: 2 }}>\n        <Avatar src={photo} alt={name} sx={{ width: 56, height: 56 }} />\n        <Box sx={{ flex: 1, minWidth: 0 }}>\n          <Typography variant=\"h6\" noWrap>{name}</Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\" noWrap>{sport}</Typography>\n        </Box>\n        <Button\n          variant=\"outlined\"\n          endIcon={<IoChevronDownOutline />}\n          onClick={handleMenuOpen}\n        >\n          Actions\n        </Button>\n        <Menu anchorEl={anchorEl} open={Boolean(anchorEl)} onClose={handleMenuClose}>\n          <MenuItem onClick={() => { handleMenuClose(); router.push(`/clients/${client.id}/edit`); }}>Edit</MenuItem>\n          <MenuItem\n            onClick={() => { handleMenuClose(); router.push(`/clients/${client.id}/delete`); }}\n            sx={{ color: '#f04438' }}\n          >\n            Delete account\n          </MenuItem>\n        </Menu>\n      </Stack>\n\n      <Divider sx={{ mb: 2 }} />\n\n      <Tabs value={tab} onChange={(_, v) => setTab(v)} sx={{ mb: 1 }}>\n        <Tab label=\"Emails\" />\n      </Tabs>\n\n      {tab === 0 && (\n        <Card variant=\"outlined\" sx={{ borderRadius: 2 }}>\n          <CardContent sx={{ p: 0 }}>\n            <Box sx={{ px: 2, pt: 2, pb: 1, display: 'flex', alignItems: 'center', gap: 2 }}>\n              <Chip label=\"Sent\" color=\"primary\" variant=\"outlined\" />\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                {mails.length} sent\n              </Typography>\n            </Box>\n            <Divider />\n            <List disablePadding>\n              {mails.map((m) => {\n                const key = m.id || `${m.email || m.to || ''}-${m.subject || ''}-${(m as any).mailedAt || m.sentAt || m.date || ''}`;\n                const isOpen = expandedId === key;\n                const sent = m.sentAt || m.date || (m as any).mailedAt || Date.now();\n                return (\n                  <React.Fragment key={key}>\n                    <ListItem\n                      secondaryAction={\n                        <Stack alignItems=\"flex-end\" spacing={0.5}>\n                          <Typography variant=\"body2\" color=\"text.secondary\">\n                            {new Date(sent).toLocaleDateString()} {new Date(sent).toLocaleTimeString()}\n                          </Typography>\n                          <Button size=\"small\" onClick={() => setExpandedId(isOpen ? null : key)}>\n                            {isOpen ? 'Hide' : 'View'}\n                          </Button>\n                        </Stack>\n                      }\n                    >\n                      <ListItemText\n                        primary={\n                          <Stack direction=\"row\" spacing={1} alignItems=\"center\" flexWrap=\"wrap\">\n                            <Typography variant=\"subtitle2\">\n                              {(m.recipientFirstName || 'First') + ' ' + (m.recipientLastName || 'Last')}\n                            </Typography>\n                            <Typography variant=\"body2\" color=\"text.secondary\">\n                              • {m.university || 'University'}\n                            </Typography>\n                            <Typography variant=\"body2\" color=\"text.secondary\">\n                              • {m.position || 'Position'}\n                            </Typography>\n                          </Stack>\n                        }\n                        secondary={\n                          <Typography variant=\"body2\" color=\"text.secondary\" noWrap>\n                            {m.subject || '(No subject)'}\n                          </Typography>\n                        }\n                      />\n                    </ListItem>\n                    <Collapse in={isOpen} timeout=\"auto\" unmountOnExit>\n                      <Box sx={{ px: 3, pb: 2 }}>\n                        <Typography variant=\"body2\" color=\"text.primary\" sx={{ whiteSpace: 'pre-wrap' }}>\n                          {m.body || m.html || '(No content)'}\n                        </Typography>\n                      </Box>\n                    </Collapse>\n                    <Divider />\n                  </React.Fragment>\n                );\n              })}\n              {mails.length === 0 && (\n                <Box sx={{ px: 3, py: 4 }}>\n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    No sent emails yet.\n                  </Typography>\n                </Box>\n              )}\n            </List>\n          </CardContent>\n        </Card>\n      )}\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}