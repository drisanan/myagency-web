{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/agencies.ts"],"sourcesContent":["const STORAGE_KEY = 'agencies_data';\n\nfunction readStore(): Agency[] {\n  if (typeof window === 'undefined') return [];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [];\n  try {\n    return JSON.parse(raw) as Agency[];\n  } catch {\n    return [];\n  }\n}\n\nfunction writeStore(items: Agency[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nexport type AgencySettings = {\n  primaryColor?: string;\n  secondaryColor?: string;\n  logoDataUrl?: string;\n};\nexport type Agency = {\n  id: string;\n  name: string;\n  email: string;\n  password?: string;\n  ownerFirstName?: string;\n  ownerLastName?: string;\n  ownerEmail?: string;\n  ownerPhone?: string;\n  active?: boolean;\n  settings?: AgencySettings;\n};\n\nconst SEED_AGENCIES: Agency[] = [\n  { id: 'agency-001', name: 'Prime Sports', email: 'agency1@an.test', settings: { primaryColor: '#1976d2' } },\n  { id: 'agency-002', name: 'NextGen', email: 'agency2@an.test', settings: { primaryColor: '#9c27b0' } },\n  { id: 'agency-003', name: 'Elite Edge', email: 'agency3@an.test', settings: { primaryColor: '#2e7d32' } },\n];\n\nlet AGENCIES: Agency[] = (() => {\n  const fromStore = readStore();\n  if (fromStore.length > 0) return fromStore;\n  writeStore(SEED_AGENCIES);\n  return [...SEED_AGENCIES];\n})();\n\nexport { AGENCIES };\n\nexport async function listAgencies() {\n  return AGENCIES.map(a => ({ id: a.id, name: a.name }));\n}\n\nexport async function getAgencies() {\n  return [...AGENCIES];\n}\n\nexport async function getAgencyByEmail(email: string) {\n  return AGENCIES.find(a => a.email === email) ?? null;\n}\n\nexport async function getAgencyById(id: string) {\n  return AGENCIES.find(a => a.id === id) ?? null;\n}\n\nexport async function getAgencySettings(email: string) {\n  const a = AGENCIES.find(x => x.email === email);\n  return a?.settings ?? {};\n}\n\nexport async function updateAgencySettings(email: string, settings: AgencySettings) {\n  const a = AGENCIES.find(x => x.email === email);\n  if (!a) return { ok: false };\n  a.settings = { ...(a.settings ?? {}), ...settings };\n  writeStore(AGENCIES);\n  return { ok: true, settings: a.settings };\n}\n\ntype UpsertInput = Omit<Agency, 'id'> & { id?: string };\nexport async function upsertAgency(input: UpsertInput) {\n  if (input.id) {\n    const idx = AGENCIES.findIndex(a => a.id === input.id);\n    if (idx >= 0) {\n      AGENCIES[idx] = { ...AGENCIES[idx], ...input, id: input.id };\n      writeStore(AGENCIES);\n      return { id: input.id };\n    }\n  }\n  const id = `agency-${(Math.random() * 1e6).toFixed(0)}`;\n  AGENCIES.push({\n    id,\n    name: input.name,\n    email: input.email,\n    password: input.password,\n    ownerFirstName: input.ownerFirstName,\n    ownerLastName: input.ownerLastName,\n    ownerEmail: input.ownerEmail,\n    ownerPhone: input.ownerPhone,\n    active: input.active ?? true,\n    settings: input.settings ?? {},\n  });\n  writeStore(AGENCIES);\n  return { id };\n}\n\nexport async function deleteAgency(id: string) {\n  const idx = AGENCIES.findIndex(a => a.id === id);\n  if (idx >= 0) {\n    AGENCIES.splice(idx, 1);\n    writeStore(AGENCIES);\n    return { ok: true };\n  }\n  return { ok: false };\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/clients.ts"],"sourcesContent":["import { getAgencyById } from '@/services/agencies';\n\ntype Client = {\n  id: string;\n  email: string;\n  firstName: string;\n  lastName: string;\n  sport: string;\n  agencyEmail: string;\n  agencyId?: string;\n  password?: string;\n  radar?: any;\n  gmailTokens?: any;\n  gmailConnected?: boolean;\n};\n\nconst STORAGE_KEY = 'clients_data';\n\nconst SEED_CLIENTS: Client[] = [\n  { id: 'ag1-c1', email: 'a1@athletes.test', firstName: 'Ava', lastName: 'Smith', sport: 'Football', agencyEmail: 'agency1@an.test' },\n  { id: 'ag1-c2', email: 'a2@athletes.test', firstName: 'Ben', lastName: 'Jones', sport: 'Basketball', agencyEmail: 'agency1@an.test' },\n  { id: 'ag2-c1', email: 'b1@athletes.test', firstName: 'Cara', lastName: 'Lee', sport: 'Baseball', agencyEmail: 'agency2@an.test' },\n  { id: 'ag3-c1', email: 'c1@athletes.test', firstName: 'Dan', lastName: 'Kim', sport: 'Soccer', agencyEmail: 'agency3@an.test' },\n];\n\nfunction readStore(): Client[] {\n  if (typeof window === 'undefined') return [...SEED_CLIENTS];\n  const raw = window.localStorage.getItem(STORAGE_KEY);\n  if (!raw) return [...SEED_CLIENTS];\n  try {\n    const parsed = JSON.parse(raw) as Client[];\n    return parsed.length ? parsed : [...SEED_CLIENTS];\n  } catch {\n    return [...SEED_CLIENTS];\n  }\n}\n\nfunction writeStore(items: Client[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nlet CLIENTS: Client[] = readStore();\n\nexport async function listClientsByAgencyEmail(agencyEmail: string) {\n  if (typeof window !== 'undefined') {\n    CLIENTS = readStore();\n  }\n  return CLIENTS.filter(c => c.agencyEmail === agencyEmail);\n}\n\nexport async function listClientsByAgency(agencyId: string) {\n  const agency = await getAgencyById(agencyId);\n  if (!agency) return [];\n  return listClientsByAgencyEmail(agency.email);\n}\nexport async function upsertClient(input: any) {\n  const id = input.id ?? `c-${(Math.random() * 1e6).toFixed(0)}`;\n  const idx = CLIENTS.findIndex(c => c.id === id);\n  if (typeof window !== 'undefined') {\n    // helpful for e2e debugging\n    // eslint-disable-next-line no-console\n    console.debug('[clients] upsertClient payload', input);\n  }\n  const next: Client = { ...CLIENTS[idx] , ...input, id };\n  if (idx >= 0) {\n    CLIENTS[idx] = next;\n  } else {\n    CLIENTS.push(next);\n  }\n  writeStore(CLIENTS);\n  return next;\n}\nexport async function getClient(id: string) {\n  if (typeof window !== 'undefined') {\n    CLIENTS = readStore();\n  }\n  if (typeof window !== 'undefined') {\n    try {\n      const raw = window.localStorage.getItem(STORAGE_KEY);\n      if (raw) {\n        const list = JSON.parse(raw) as Client[];\n        const hit = list.find((c) => c.id === id);\n        if (hit) {\n          CLIENTS = list;\n          return hit;\n        }\n      }\n    } catch {\n      // ignore\n    }\n  }\n  let found = CLIENTS.find(c => c.id === id);\n  if (!found) {\n    CLIENTS = readStore();\n    found = CLIENTS.find(c => c.id === id);\n  }\n  return found ?? { id, email: 'athlete1@example.com', firstName: 'A1', lastName: 'L1', sport: 'Football', agencyEmail: '' };\n}\nexport async function deleteClient(id: string) {\n  const idx = CLIENTS.findIndex(c => c.id === id);\n  if (idx >= 0) {\n    CLIENTS.splice(idx, 1);\n    writeStore(CLIENTS);\n  }\n  return { ok: true };\n}\nexport async function getClients() {\n  // Determine current session from localStorage to enforce tenancy\n  const raw = typeof window !== 'undefined' ? window.localStorage.getItem('session') : null;\n  if (raw) {\n    try {\n      const s = JSON.parse(raw) as { role: 'parent' | 'agency'; email: string };\n      if (s.role === 'agency') {\n        const list = await listClientsByAgencyEmail(s.email);\n        if (typeof window !== 'undefined') {\n          // eslint-disable-next-line no-console\n          console.debug('[clients] getClients list size', list.length);\n        }\n        return list;\n      }\n    } catch {\n      // fall through\n    }\n  }\n  return [];\n}\n\nexport function setClientGmailTokens(clientId: string, tokens: any) {\n  const idx = CLIENTS.findIndex(c => c.id === clientId);\n  if (idx >= 0) {\n    CLIENTS[idx] = { ...CLIENTS[idx], gmailTokens: tokens, gmailConnected: true };\n    writeStore(CLIENTS);\n  }\n}\n\nexport function getClientGmailTokens(clientId: string): any | null {\n  const found = CLIENTS.find(c => c.id === clientId);\n  return found?.gmailTokens ?? null;\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 361, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/prompts.ts"],"sourcesContent":["const STORAGE_KEY = 'ai_prompts_v1';\n\nexport type PromptRecord = {\n  id: string;\n  agencyEmail: string;\n  clientId?: string;\n  name: string;\n  text: string;\n  createdAt: number;\n  updatedAt: number;\n};\n\nfunction read(): PromptRecord[] {\n  if (typeof window === 'undefined') return [];\n  try {\n    const raw = window.localStorage.getItem(STORAGE_KEY);\n    return raw ? (JSON.parse(raw) as PromptRecord[]) : [];\n  } catch {\n    return [];\n  }\n}\n\nfunction write(items: PromptRecord[]) {\n  if (typeof window === 'undefined') return;\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n}\n\nexport function listPrompts(input: { agencyEmail: string; clientId?: string }): PromptRecord[] {\n  const all = read();\n  return all\n    .filter(p => p.agencyEmail === input.agencyEmail && (input.clientId ? p.clientId === input.clientId : true))\n    .sort((a, b) => b.updatedAt - a.updatedAt);\n}\n\nexport function savePrompt(input: { agencyEmail: string; clientId?: string; name: string; text: string }): PromptRecord {\n  const all = read();\n  const id = `p-${Math.random().toString(36).slice(2, 10)}`;\n  const now = Date.now();\n  const rec: PromptRecord = {\n    id,\n    agencyEmail: input.agencyEmail,\n    clientId: input.clientId,\n    name: input.name,\n    text: input.text,\n    createdAt: now,\n    updatedAt: now,\n  };\n  write([rec, ...all]);\n  return rec;\n}\n\nexport function deletePrompt(id: string) {\n  const all = read();\n  write(all.filter(p => p.id !== id));\n}\n\n\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,cAAc;AAYpB,SAAS;IACP;;IACA,IAAI;QACF,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;QACxC,OAAO,MAAO,KAAK,KAAK,CAAC,OAA0B,EAAE;IACvD,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,MAAM,KAAqB;IAClC;;IACA,OAAO,YAAY,CAAC,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;AAC1D;AAEO,SAAS,YAAY,KAAiD;IAC3E,MAAM,MAAM;IACZ,OAAO,IACJ,MAAM,CAAC,CAAA,IAAK,EAAE,WAAW,KAAK,MAAM,WAAW,IAAI,CAAC,MAAM,QAAQ,GAAG,EAAE,QAAQ,KAAK,MAAM,QAAQ,GAAG,IAAI,GACzG,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,GAAG,EAAE,SAAS;AAC7C;AAEO,SAAS,WAAW,KAA6E;IACtG,MAAM,MAAM;IACZ,MAAM,KAAK,CAAC,EAAE,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,KAAK;IACzD,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,MAAoB;QACxB;QACA,aAAa,MAAM,WAAW;QAC9B,UAAU,MAAM,QAAQ;QACxB,MAAM,MAAM,IAAI;QAChB,MAAM,MAAM,IAAI;QAChB,WAAW;QACX,WAAW;IACb;IACA,MAAM;QAAC;WAAQ;KAAI;IACnB,OAAO;AACT;AAEO,SAAS,aAAa,EAAU;IACrC,MAAM,MAAM;IACZ,MAAM,IAAI,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AACjC"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/aiRecruiter.ts"],"sourcesContent":["'use client';\n\nconst INTRO_URL = '/api/ai/intro';\n\ntype IntroBody = {\n  sport: string;\n  collegeName: string;\n  coachMessage: string;\n  tone: string;\n  qualities: string[];\n  additionalInsights?: string;\n};\n\nexport async function generateIntro(body: IntroBody): Promise<string> {\n  const res = await fetch(INTRO_URL, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json',\n    },\n    body: JSON.stringify(body),\n  });\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`HTTP ${res.status}: ${text || res.statusText}`);\n  }\n  const data = await res.json();\n  if (data?.error) {\n    throw new Error(data.error);\n  }\n  return String(data.intro ?? '');\n}\n\nexport async function generateContentDraft(_body: unknown): Promise<string> {\n  // Placeholder: will implement once the content endpoint is provided\n  return '';\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA;AAEA,MAAM,YAAY;AAWX,eAAe,cAAc,IAAe;IACjD,MAAM,MAAM,MAAM,MAAM,WAAW;QACjC,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,UAAU;QACZ;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;QAC1C,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE,IAAI,MAAM,CAAC,EAAE,EAAE,QAAQ,IAAI,UAAU,EAAE;IACjE;IACA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI,MAAM,OAAO;QACf,MAAM,IAAI,MAAM,KAAK,KAAK;IAC5B;IACA,OAAO,OAAO,KAAK,KAAK,IAAI;AAC9B;AAEO,eAAe,qBAAqB,KAAc;IACvD,oEAAoE;IACpE,OAAO;AACT"}},
    {"offset": {"line": 457, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/ai/prompts/page.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { Box, Button, TextField, Typography, MenuItem, Stack, Divider, Paper, Chip } from '@mui/material';\nimport { useSession } from '@/features/auth/session';\nimport { listClientsByAgencyEmail } from '@/services/clients';\nimport { listPrompts, savePrompt, deletePrompt, PromptRecord } from '@/services/prompts';\nimport { generateIntro } from '@/services/aiRecruiter';\nimport { getAgencyByEmail } from '@/services/agencies';\n\ntype ClientRow = { id: string; email: string; firstName?: string; lastName?: string; sport?: string };\n\nexport default function PromptPlaygroundPage() {\n  const { session } = useSession();\n  const [clients, setClients] = React.useState<ClientRow[]>([]);\n  const [clientId, setClientId] = React.useState('');\n  const [prompt, setPrompt] = React.useState<string>('');\n  const [templates, setTemplates] = React.useState<PromptRecord[]>([]);\n  const [templateName, setTemplateName] = React.useState('');\n  const [runName, setRunName] = React.useState('');\n  const [selectedTemplateId, setSelectedTemplateId] = React.useState('');\n  const [response, setResponse] = React.useState<string>('');\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n  const [agencyName, setAgencyName] = React.useState<string>('');\n\n  const currentClient = React.useMemo(\n    () => clients.find(c => c.id === clientId) || null,\n    [clients, clientId]\n  );\n\n  React.useEffect(() => {\n    if (!session?.email) return;\n    listClientsByAgencyEmail(session.email).then(setClients);\n    // Load agency name for use as collegeName in prompts\n    getAgencyByEmail(session.email).then(a => setAgencyName(a?.name || ''));\n  }, [session?.email]);\n\n  React.useEffect(() => {\n    if (!session?.email) return;\n    setTemplates(listPrompts({ agencyEmail: session.email, clientId }));\n  }, [session?.email, clientId]);\n\n  async function handleRun() {\n    try {\n      setLoading(true);\n      setError(null);\n      setResponse('');\n      const firstName = currentClient?.firstName || '';\n      const lastName = currentClient?.lastName || '';\n      const sport = currentClient?.sport || '';\n      const fullName = `${firstName} ${lastName}`.trim();\n\n      const intro = await generateIntro({\n        sport,\n        collegeName: agencyName || '',\n        coachMessage: prompt || 'Write a concise, friendly intro email.',\n        tone: 'A highschool kid who loves sports',\n        qualities: ['Passionate', 'Hardworking', 'Determined'],\n        additionalInsights: `Student full name: ${fullName}. FirstName: ${firstName}. LastName: ${lastName}. Sport: ${sport}. Use the student’s actual name; no placeholders.`,\n      });\n\n      setResponse(String(intro));\n    } catch (e: any) {\n      setError(e?.message || 'Failed to run prompt');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function handleSave() {\n    if (!session?.email) return;\n    const name = templateName || `Prompt ${new Date().toLocaleString()}`;\n    const rec = savePrompt({ agencyEmail: session.email, clientId, name, text: prompt });\n    setTemplates([rec, ...templates]);\n    setTemplateName('');\n  }\n\n  function handleApplyTemplate(id: string) {\n    const t = templates.find(x => x.id === id);\n    if (!t) return;\n    setPrompt(t.text);\n    setSelectedTemplateId(id);\n  }\n\n  function handleDeleteTemplate(id: string) {\n    deletePrompt(id);\n    setTemplates(templates.filter(t => t.id !== id));\n    if (selectedTemplateId === id) setSelectedTemplateId('');\n  }\n\n  return (\n    <Box sx={{ display: 'grid', gap: 2 }}>\n      <Paper variant=\"outlined\" sx={{ p: 2, borderRadius: 2.5, borderColor: '#dcdfe4' }}>\n        <Box sx={{ display: 'grid', gap: 2 }}>\n        <Typography variant=\"h5\">AI Prompt Playground (Playground)</Typography>\n        <Typography variant=\"body2\" color=\"text.secondary\">\n          This area is used for testing, generating, and saving your prompts for athletes. You can name prompts (e.g., “John Doe – introduction”) and reuse them when generating that athlete’s introduction email.\n        </Typography>\n        {error && (\n          <Typography color=\"error\">{error}</Typography>\n        )}\n\n        <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: '1fr 1fr' }, gap: 2 }}>\n          <TextField\n            select\n            label=\"Athlete\"\n            value={clientId}\n            onChange={(e) => setClientId(e.target.value)}\n            SelectProps={{ MenuProps: { disablePortal: true } }}\n          >\n            <MenuItem value=\"\">(Select a client)</MenuItem>\n            {clients.map(c => (\n              <MenuItem key={c.id} value={c.id}>\n                {c.email} {c.firstName ? `- ${c.firstName} ${c.lastName}` : ''}\n              </MenuItem>\n            ))}\n          </TextField>\n\n          <TextField\n            select\n            label=\"Saved Prompts\"\n            value={selectedTemplateId}\n            onChange={(e) => handleApplyTemplate(String(e.target.value))}\n            SelectProps={{ MenuProps: { disablePortal: true } }}\n          >\n            <MenuItem value=\"\">(Select a prompt)</MenuItem>\n            {templates.map(t => (\n              <MenuItem key={t.id} value={t.id}>{t.name}</MenuItem>\n            ))}\n          </TextField>\n        </Box>\n\n        <TextField\n          label=\"Prompt\"\n          multiline\n          minRows={6}\n          value={prompt}\n          onChange={(e) => setPrompt(e.target.value)}\n          placeholder=\"e.g., Write a warm, concise introduction that highlights the athlete’s drive and recent accomplishments...\"\n        />\n\n        <Stack\n          direction={{ xs: 'column', md: 'row' }}\n          spacing={1}\n          alignItems={{ xs: 'stretch', md: 'center' }}\n          justifyContent=\"space-between\"\n        >\n          <Stack direction=\"row\" spacing={1} alignItems=\"center\" flexWrap=\"wrap\">\n            <TextField\n              size=\"small\"\n              label=\"Run name\"\n              value={runName}\n              onChange={(e) => setRunName(e.target.value)}\n              sx={{ minWidth: 180 }}\n            />\n            <Button variant=\"contained\" onClick={handleRun} disabled={loading || !clientId}>\n              {loading ? 'Running…' : 'Run'}\n            </Button>\n          </Stack>\n        </Stack>\n\n        </Box>\n      </Paper>\n\n      <Box sx={{ p: 2, borderRadius: 2.5 }}>\n        <Typography variant=\"subtitle1\" sx={{ mb: 0.5 }}>Response</Typography>\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 1 }}>\n          The response is where you determine if what’s being generated satisfies your needs.\n        </Typography>\n        <Paper variant=\"outlined\" sx={{ p: 2, minHeight: 160, whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>\n          {response || '—'}\n        </Paper>\n        <Box\n          sx={{\n            pt: 1.5,\n            mt: 2,\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: 1,\n            justifyContent: 'flex-end'\n          }}\n        >\n          <TextField\n            size=\"small\"\n            label=\"Prompt name\"\n            value={templateName}\n            onChange={(e) => setTemplateName(e.target.value)}\n            sx={{ width: 220 }}\n          />\n          <Button variant=\"outlined\" onClick={handleSave} disabled={!session?.email || !prompt}>Save Prompt</Button>\n          <Button\n            variant=\"outlined\"\n            color=\"error\"\n            onClick={() => { if (selectedTemplateId) handleDeleteTemplate(selectedTemplateId); }}\n            disabled={!selectedTemplateId}\n          >\n            Delete Prompt\n          </Button>\n          <Button\n            variant=\"text\"\n            onClick={() => navigator.clipboard.writeText(response || '')}\n            disabled={!response}\n          >\n            Copy Response\n          </Button>\n        </Box>\n      </Box>\n    </Box>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}