{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/clients.ts"],"sourcesContent":["import { getAgencyById } from '@/services/agencies';\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || process.env.API_BASE_URL;\n\nfunction requireApiBase() {\n  if (!API_BASE_URL) throw new Error('API_BASE_URL is not configured');\n  return API_BASE_URL;\n}\n\nasync function apiFetch(path: string, init?: RequestInit) {\n  const base = requireApiBase();\n  if (typeof fetch === 'undefined') {\n    throw new Error('fetch is not available');\n  }\n  const headers: Record<string, string> = { 'Content-Type': 'application/json', ...(init?.headers as any) };\n  const res = await fetch(`${base}${path}`, { ...init, headers });\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(`API ${path} failed: ${res.status} ${text}`);\n  }\n  return res.json();\n}\n\ntype Client = {\n  id: string;\n  email: string;\n  firstName: string;\n  lastName: string;\n  sport: string;\n  agencyEmail: string;\n  agencyId?: string;\n  password?: string;\n  radar?: any;\n  gmailTokens?: any;\n  gmailConnected?: boolean;\n  createdAt?: string;\n};\n\nexport async function listClientsByAgencyEmail(agencyEmail: string) {\n  const data = await apiFetch('/clients');\n  return data?.clients ?? [];\n}\n\nexport async function listClientsByAgency(agencyId: string) {\n  const agency = await getAgencyById(agencyId);\n  if (!agency) return [];\n  return listClientsByAgencyEmail(agency.email);\n}\nexport async function upsertClient(input: any) {\n  const data = await apiFetch('/clients', { method: 'POST', body: JSON.stringify(input) });\n  return data?.client;\n}\nexport async function getClient(id: string) {\n  const data = await apiFetch(`/clients/${id}`);\n  return data?.client ?? null;\n}\nexport async function deleteClient(id: string) {\n  await apiFetch(`/clients/${id}`, { method: 'DELETE' });\n  return { ok: true };\n}\nexport async function getClients() {\n  const data = await apiFetch('/clients');\n  return data?.clients ?? [];\n}\n\nexport function setClientGmailTokens(clientId: string, tokens: any) {\n  // No-op; tokens are stored server-side via API.\n}\n\nexport function getClientGmailTokens(clientId: string): any | null {\n  // No-op on client; tokens handled server-side.\n  return null;\n}\n\n\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAEqB;AAFrB;;AAEA,MAAM,eAAe,8FAAwC,2KAAO,CAAC,GAAG,CAAC,YAAY;AAErF,SAAS;IACP;;IACA,OAAO;AACT;AAEA,eAAe,SAAS,IAAY,EAAE,IAAkB;IACtD,MAAM,OAAO;IACb,IAAI,OAAO,UAAU,aAAa;QAChC,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,UAAkC;QAAE,gBAAgB;QAAoB,GAAI,MAAM,OAAO;IAAS;IACxG,MAAM,MAAM,MAAM,MAAM,GAAG,OAAO,MAAM,EAAE;QAAE,GAAG,IAAI;QAAE;IAAQ;IAC7D,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,KAAK,SAAS,EAAE,IAAI,MAAM,CAAC,CAAC,EAAE,MAAM;IAC7D;IACA,OAAO,IAAI,IAAI;AACjB;AAiBO,eAAe,yBAAyB,WAAmB;IAChE,MAAM,OAAO,MAAM,SAAS;IAC5B,OAAO,MAAM,WAAW,EAAE;AAC5B;AAEO,eAAe,oBAAoB,QAAgB;IACxD,MAAM,SAAS,MAAM,IAAA,wIAAa,EAAC;IACnC,IAAI,CAAC,QAAQ,OAAO,EAAE;IACtB,OAAO,yBAAyB,OAAO,KAAK;AAC9C;AACO,eAAe,aAAa,KAAU;IAC3C,MAAM,OAAO,MAAM,SAAS,YAAY;QAAE,QAAQ;QAAQ,MAAM,KAAK,SAAS,CAAC;IAAO;IACtF,OAAO,MAAM;AACf;AACO,eAAe,UAAU,EAAU;IACxC,MAAM,OAAO,MAAM,SAAS,CAAC,SAAS,EAAE,IAAI;IAC5C,OAAO,MAAM,UAAU;AACzB;AACO,eAAe,aAAa,EAAU;IAC3C,MAAM,SAAS,CAAC,SAAS,EAAE,IAAI,EAAE;QAAE,QAAQ;IAAS;IACpD,OAAO;QAAE,IAAI;IAAK;AACpB;AACO,eAAe;IACpB,MAAM,OAAO,MAAM,SAAS;IAC5B,OAAO,MAAM,WAAW,EAAE;AAC5B;AAEO,SAAS,qBAAqB,QAAgB,EAAE,MAAW;AAChE,gDAAgD;AAClD;AAEO,SAAS,qBAAqB,QAAgB;IACnD,+CAA+C;IAC/C,OAAO;AACT"}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/mailStatus.ts"],"sourcesContent":["// Mail status now tracked server-side; frontend no-ops to avoid local storage.\nexport function hasMailed(_: string, __: string): boolean {\n  return false;\n}\n\nexport function markMailed(_: string, __: string[]) {}\n\nexport function getMailEntries() {\n  return [];\n}\n\n\n"],"names":[],"mappings":"AAAA,+EAA+E;;;;;;;;;AACxE,SAAS,UAAU,CAAS,EAAE,EAAU;IAC7C,OAAO;AACT;AAEO,SAAS,WAAW,CAAS,EAAE,EAAY,GAAG;AAE9C,SAAS;IACd,OAAO,EAAE;AACX"}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/scholarships.ts"],"sourcesContent":["const KEY = 'dashboard_scholarships_v1';\n\ntype Store = { [agencyEmail: string]: number };\n\nexport function getScholarships(agencyEmail: string): number {\n  if (typeof window === 'undefined') return 0;\n  try {\n    const raw = localStorage.getItem(KEY);\n    const obj = raw ? (JSON.parse(raw) as Store) : {};\n    return obj[agencyEmail] ?? 0;\n  } catch {\n    return 0;\n  }\n}\n\nexport function setScholarships(agencyEmail: string, n: number) {\n  if (typeof window === 'undefined') return;\n  try {\n    const raw = localStorage.getItem(KEY);\n    const obj = raw ? (JSON.parse(raw) as Store) : {};\n    obj[agencyEmail] = Math.max(0, Number(n) || 0);\n    localStorage.setItem(KEY, JSON.stringify(obj));\n  } catch {}\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,MAAM;AAIL,SAAS,gBAAgB,WAAmB;IACjD;;IACA,IAAI;QACF,MAAM,MAAM,aAAa,OAAO,CAAC;QACjC,MAAM,MAAM,MAAO,KAAK,KAAK,CAAC,OAAiB,CAAC;QAChD,OAAO,GAAG,CAAC,YAAY,IAAI;IAC7B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,gBAAgB,WAAmB,EAAE,CAAS;IAC5D;;IACA,IAAI;QACF,MAAM,MAAM,aAAa,OAAO,CAAC;QACjC,MAAM,MAAM,MAAO,KAAK,KAAK,CAAC,OAAiB,CAAC;QAChD,GAAG,CAAC,YAAY,GAAG,KAAK,GAAG,CAAC,GAAG,OAAO,MAAM;QAC5C,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;IAC3C,EAAE,OAAM,CAAC;AACX"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/dashboard/MetricCard.tsx"],"sourcesContent":["'use client';\n\nimport { Box, Card, CardContent, Typography } from '@mui/material';\nimport React from 'react';\n\ntype MetricCardProps = {\n  title: string;\n  value: React.ReactNode;\n  icon?: React.ReactNode;\n  footer?: React.ReactNode;\n  bgColor?: string;\n  textColor?: string;\n  bgImage?: string;\n  overlayOpacity?: number;\n};\n\nfunction toRgba(hex: string, alpha: number) {\n  const normalized = hex.replace('#', '');\n  if (normalized.length !== 6) return `rgba(0,0,0,${alpha})`;\n  const r = parseInt(normalized.slice(0, 2), 16);\n  const g = parseInt(normalized.slice(2, 4), 16);\n  const b = parseInt(normalized.slice(4, 6), 16);\n  return `rgba(${r},${g},${b},${alpha})`;\n}\n\nexport function MetricCard({\n  title,\n  value,\n  icon,\n  footer,\n  bgColor,\n  textColor,\n  bgImage,\n  overlayOpacity = 0.82,\n}: MetricCardProps) {\n  const blendedBackground = bgImage\n    ? `linear-gradient(${toRgba(bgColor || '#000000', overlayOpacity)}, ${toRgba(\n        bgColor || '#000000',\n        overlayOpacity,\n      )}), url(${bgImage})`\n    : undefined;\n\n  return (\n    <Card\n      sx={{\n        borderRadius: '20px',\n        boxShadow: '0 4px 12px rgba(0,0,0,0.08)',\n        border: `1px solid ${bgColor || '#dcdfe4'}`,\n        backgroundColor: bgColor,\n        backgroundImage: blendedBackground,\n        backgroundSize: blendedBackground ? 'cover' : undefined,\n        backgroundPosition: blendedBackground ? 'center' : undefined,\n        backgroundRepeat: blendedBackground ? 'no-repeat' : undefined,\n        color: textColor,\n      }}\n    >\n      <CardContent sx={{ p: 0 }}>\n        <Box\n          sx={{\n            px: 2,\n            pt: 1,\n            pb: 0.6,\n            borderBottom: footer ? '1px solid #dcdfe4' : 'none',\n          }}\n        >\n          <Box\n            sx={{\n              display: 'grid',\n              gridTemplateColumns: icon ? 'auto 1fr' : '1fr',\n              gridTemplateRows: 'auto auto',\n              columnGap: icon ? 1.5 : 0,\n              rowGap: 0.75,\n              alignItems: 'start',\n            }}\n          >\n            {icon ? (\n              <Box\n                sx={{\n                  width: 40,\n                  height: 40,\n                  borderRadius: '50%',\n                  bgcolor: textColor ? `${textColor}1a` : '#FFFFFF',\n                  color: textColor || '#000000',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  boxShadow: '0 4px 10px rgba(0,0,0,0.12)',\n                  gridRow: '1 / span 2',\n                }}\n              >\n                {icon}\n              </Box>\n            ) : null}\n            <Typography\n              variant=\"subtitle2\"\n              color={textColor ? undefined : 'text.secondary'}\n              sx={{ fontSize: '0.95rem', color: textColor }}\n            >\n              {title}\n            </Typography>\n            <Typography\n              variant=\"h3\"\n              sx={{ fontSize: '2.1rem', lineHeight: 1.05, color: textColor }}\n            >\n              {value}\n            </Typography>\n          </Box>\n        </Box>\n        {footer ? (\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 1,\n              mt: 1,\n              px: 2,\n              pb: 0.35,\n              color: '#667085',\n            }}\n          >\n            {footer}\n          </Box>\n        ) : null}\n      </CardContent>\n    </Card>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAFA;;;AAgBA,SAAS,OAAO,GAAW,EAAE,KAAa;IACxC,MAAM,aAAa,IAAI,OAAO,CAAC,KAAK;IACpC,IAAI,WAAW,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;IAC1D,MAAM,IAAI,SAAS,WAAW,KAAK,CAAC,GAAG,IAAI;IAC3C,MAAM,IAAI,SAAS,WAAW,KAAK,CAAC,GAAG,IAAI;IAC3C,MAAM,IAAI,SAAS,WAAW,KAAK,CAAC,GAAG,IAAI;IAC3C,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;AACxC;AAEO,SAAS,WAAW,EACzB,KAAK,EACL,KAAK,EACL,IAAI,EACJ,MAAM,EACN,OAAO,EACP,SAAS,EACT,OAAO,EACP,iBAAiB,IAAI,EACL;IAChB,MAAM,oBAAoB,UACtB,CAAC,gBAAgB,EAAE,OAAO,WAAW,WAAW,gBAAgB,EAAE,EAAE,OAClE,WAAW,WACX,gBACA,OAAO,EAAE,QAAQ,CAAC,CAAC,GACrB;IAEJ,qBACE,6LAAC,sMAAI;QACH,IAAI;YACF,cAAc;YACd,WAAW;YACX,QAAQ,CAAC,UAAU,EAAE,WAAW,WAAW;YAC3C,iBAAiB;YACjB,iBAAiB;YACjB,gBAAgB,oBAAoB,UAAU;YAC9C,oBAAoB,oBAAoB,WAAW;YACnD,kBAAkB,oBAAoB,cAAc;YACpD,OAAO;QACT;kBAEA,cAAA,6LAAC,kOAAW;YAAC,IAAI;gBAAE,GAAG;YAAE;;8BACtB,6LAAC,kMAAG;oBACF,IAAI;wBACF,IAAI;wBACJ,IAAI;wBACJ,IAAI;wBACJ,cAAc,SAAS,sBAAsB;oBAC/C;8BAEA,cAAA,6LAAC,kMAAG;wBACF,IAAI;4BACF,SAAS;4BACT,qBAAqB,OAAO,aAAa;4BACzC,kBAAkB;4BAClB,WAAW,OAAO,MAAM;4BACxB,QAAQ;4BACR,YAAY;wBACd;;4BAEC,qBACC,6LAAC,kMAAG;gCACF,IAAI;oCACF,OAAO;oCACP,QAAQ;oCACR,cAAc;oCACd,SAAS,YAAY,GAAG,UAAU,EAAE,CAAC,GAAG;oCACxC,OAAO,aAAa;oCACpB,SAAS;oCACT,YAAY;oCACZ,gBAAgB;oCAChB,WAAW;oCACX,SAAS;gCACX;0CAEC;;;;;uCAED;0CACJ,6LAAC,8NAAU;gCACT,SAAQ;gCACR,OAAO,YAAY,YAAY;gCAC/B,IAAI;oCAAE,UAAU;oCAAW,OAAO;gCAAU;0CAE3C;;;;;;0CAEH,6LAAC,8NAAU;gCACT,SAAQ;gCACR,IAAI;oCAAE,UAAU;oCAAU,YAAY;oCAAM,OAAO;gCAAU;0CAE5D;;;;;;;;;;;;;;;;;gBAIN,uBACC,6LAAC,kMAAG;oBACF,IAAI;wBACF,SAAS;wBACT,YAAY;wBACZ,KAAK;wBACL,IAAI;wBACJ,IAAI;wBACJ,IAAI;wBACJ,OAAO;oBACT;8BAEC;;;;;2BAED;;;;;;;;;;;;AAIZ;KArGgB"}},
    {"offset": {"line": 304, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/features/recruiter/divisionMapping.ts"],"sourcesContent":["export const DIVISION_MAPPING: Record<string, string[]> = {\n  Football: ['D1', 'D1AA', 'D2', 'D3', 'JUCO', 'NAIA'],\n  Baseball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  Softball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensSoccer: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensSoccer: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensBasketball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensBasketball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensTrack: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensVolleyball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensSwimming: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensTrack: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensSwimming: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensTennis: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensTennis: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  Dance: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensGymnastics: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensGymnastics: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensHockey: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensHockey: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  Cheerleading: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensFlagFootball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensGolf: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensGolf: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensVolleyball: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensLacrosse: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensLacrosse: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  WomensCrossCountry: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n  MensCrossCountry: ['D1', 'D2', 'D3', 'JUCO', 'NAIA'],\n};\n\nexport function getSports(): string[] {\n  return Object.keys(DIVISION_MAPPING);\n}\n\nexport function getSportsForGender(gender: 'Mens' | 'Womens'): string[] {\n  const all = Object.keys(DIVISION_MAPPING);\n  const genderPrefix = gender;\n  const gendered = all.filter(s => s.startsWith(genderPrefix));\n  const neutral = all.filter(s => !s.startsWith('Mens') && !s.startsWith('Womens'));\n  return [...gendered, ...neutral];\n}\n\nexport function getDivisionsForSport(sport: string): string[] {\n  return DIVISION_MAPPING[sport] ?? [];\n}\n\nexport function formatSportLabel(sport: string): string {\n  // Insert a space before capitals when preceded by a lowercase letter\n  // e.g., WomensSoccer -> Womens Soccer, CrossCountry -> Cross Country\n  return sport.replace(/([a-z])([A-Z])/g, '$1 $2');\n}\n\n\n"],"names":[],"mappings":";;;;;;;;;;;;AAAO,MAAM,mBAA6C;IACxD,UAAU;QAAC;QAAM;QAAQ;QAAM;QAAM;QAAQ;KAAO;IACpD,UAAU;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC5C,UAAU;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC5C,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,YAAY;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC9C,gBAAgB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAClD,kBAAkB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACpD,aAAa;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC/C,kBAAkB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACpD,gBAAgB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAClD,WAAW;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC7C,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,YAAY;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC9C,OAAO;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACzC,gBAAgB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAClD,kBAAkB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACpD,YAAY;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC9C,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,oBAAoB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACtD,UAAU;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC5C,YAAY;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAC9C,gBAAgB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAClD,cAAc;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAChD,gBAAgB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IAClD,oBAAoB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;IACtD,kBAAkB;QAAC;QAAM;QAAM;QAAM;QAAQ;KAAO;AACtD;AAEO,SAAS;IACd,OAAO,OAAO,IAAI,CAAC;AACrB;AAEO,SAAS,mBAAmB,MAAyB;IAC1D,MAAM,MAAM,OAAO,IAAI,CAAC;IACxB,MAAM,eAAe;IACrB,MAAM,WAAW,IAAI,MAAM,CAAC,CAAA,IAAK,EAAE,UAAU,CAAC;IAC9C,MAAM,UAAU,IAAI,MAAM,CAAC,CAAA,IAAK,CAAC,EAAE,UAAU,CAAC,WAAW,CAAC,EAAE,UAAU,CAAC;IACvE,OAAO;WAAI;WAAa;KAAQ;AAClC;AAEO,SAAS,qBAAqB,KAAa;IAChD,OAAO,gBAAgB,CAAC,MAAM,IAAI,EAAE;AACtC;AAEO,SAAS,iBAAiB,KAAa;IAC5C,qEAAqE;IACrE,qEAAqE;IACrE,OAAO,MAAM,OAAO,CAAC,mBAAmB;AAC1C"}},
    {"offset": {"line": 543, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/features/recruiter/RecruitingCalendarCard.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { Box, Paper, Typography, Stack, Chip, Select, MenuItem, SelectChangeEvent } from '@mui/material';\nimport { useQuery } from '@tanstack/react-query';\nimport { getSports, formatSportLabel } from '@/features/recruiter/divisionMapping';\n\ntype RecruitingPeriod = {\n  id: string;\n  sport: string;\n  label: string;\n  type: 'dead' | 'contact' | 'quiet' | 'eval' | 'test' | 'other';\n  startDate: string;\n  endDate: string;\n};\n\nconst typeColor: Record<RecruitingPeriod['type'], string> = {\n  dead: '#f04438', // red\n  contact: '#15b79f', // green\n  quiet: '#5D4AFB',\n  eval: '#5D4AFB',\n  test: '#5D4AFB',\n  other: '#999DAA',\n};\n\nfunction useRecruitingPeriods(sport: string) {\n  return useQuery({\n    queryKey: ['recruiting-periods', sport],\n    queryFn: async () => {\n      const res = await fetch(`/api/recruiting-periods?sport=${encodeURIComponent(sport || 'Football')}`);\n      if (!res.ok) throw new Error('Failed to load periods');\n      const data = await res.json();\n      return (data?.data as RecruitingPeriod[]) || [];\n    },\n  });\n}\n\nfunction formatRange(start: string, end: string) {\n  const s = new Date(start).toLocaleDateString();\n  const e = new Date(end).toLocaleDateString();\n  return s === e ? s : `${s} – ${e}`;\n}\n\nfunction getWeekDays(from: Date) {\n  return Array.from({ length: 7 }).map((_, i) => {\n    const d = new Date(from);\n    d.setDate(from.getDate() + i);\n    d.setHours(0, 0, 0, 0);\n    return d;\n  });\n}\n\nfunction findDayPeriods(day: Date, periods: RecruitingPeriod[]) {\n  return periods.filter((p) => {\n    const start = new Date(p.startDate);\n    const end = new Date(p.endDate);\n    start.setHours(0, 0, 0, 0);\n    end.setHours(23, 59, 59, 999);\n    return day >= start && day <= end;\n  });\n}\n\nfunction shortDate(day: Date) {\n  return day.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });\n}\n\nexport function RecruitingCalendarCard() {\n  const sports = getSports();\n  const [sport, setSport] = React.useState(sports[0] || 'Football');\n  const { data = [], isLoading } = useRecruitingPeriods(sport);\n  const today = new Date();\n  const weekDays = getWeekDays(today);\n\n  return (\n    <Paper variant=\"outlined\" sx={{ p: 2, mb: 3, borderRadius: '16px' }}>\n      <Stack direction={{ xs: 'column', md: 'row' }} alignItems=\"center\" justifyContent=\"space-between\" spacing={2} sx={{ mb: 2 }}>\n        <Typography variant=\"h6\">Recruiting Calendar</Typography>\n        <Select\n          size=\"small\"\n          value={sport}\n          onChange={(e: SelectChangeEvent) => setSport(e.target.value)}\n          data-testid=\"recruiting-calendar-sport\"\n        >\n          {sports.map((s) => (\n            <MenuItem key={s} value={s}>{formatSportLabel(s)}</MenuItem>\n          ))}\n        </Select>\n      </Stack>\n\n      <Stack direction=\"row\" spacing={1} sx={{ mb: 2, flexWrap: 'wrap' }}>\n        <Chip size=\"small\" label=\"Dead\" sx={{ bgcolor: typeColor.dead, color: '#fff' }} />\n        <Chip size=\"small\" label=\"Contact\" sx={{ bgcolor: typeColor.contact, color: '#fff' }} />\n        <Chip size=\"small\" label=\"Quiet\" sx={{ bgcolor: typeColor.quiet, color: '#fff' }} />\n        <Chip size=\"small\" label=\"Other/Test\" sx={{ bgcolor: typeColor.test, color: '#fff' }} />\n        <Chip size=\"small\" label=\"Today\" sx={{ bgcolor: '#fff', color: '#14151E', border: '1px solid #dcdfe4' }} />\n      </Stack>\n\n      {isLoading ? (\n        <Typography color=\"text.secondary\">Loading periods…</Typography>\n      ) : data.length === 0 ? (\n        <Typography color=\"text.secondary\">No periods available.</Typography>\n      ) : (\n        <Box sx={{ display: 'grid', gridTemplateColumns: 'repeat(7, minmax(110px, 1fr))', gap: 1 }}>\n          {weekDays.map((day) => {\n            const dayPeriods = findDayPeriods(day, data);\n            const color = dayPeriods[0] ? typeColor[dayPeriods[0].type] || typeColor.other : '#dcdfe4';\n            const isToday = day.toDateString() === today.toDateString();\n            return (\n              <Paper\n                key={day.toISOString()}\n                data-testid=\"calendar-day\"\n                variant=\"outlined\"\n                sx={{\n                  position: 'relative',\n                  p: 1.25,\n                  borderRadius: '12px',\n                  minHeight: 90,\n                  bgcolor: isToday ? '#fff' : dayPeriods[0] ? `${color}1a` : '#fff',\n                  border: `1px solid ${isToday ? '#dcdfe4' : dayPeriods[0] ? color : '#dcdfe4'}`,\n                }}\n              >\n                <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"flex-start\">\n                  <Typography variant=\"subtitle2\">{shortDate(day)}</Typography>\n                  <Stack direction=\"row\" spacing={0.5} justifyContent=\"flex-end\" sx={{ flexWrap: 'wrap', maxWidth: '70%' }}>\n                    {dayPeriods.slice(0, 2).map((p) => {\n                      const c = typeColor[p.type] || typeColor.other;\n                      return (\n                        <Chip\n                          key={p.id}\n                          size=\"small\"\n                          label={p.label}\n                          sx={{ bgcolor: c, color: '#fff' }}\n                          data-testid=\"calendar-period-chip\"\n                        />\n                      );\n                    })}\n                    {dayPeriods.length > 2 ? (\n                      <Chip size=\"small\" label={`+${dayPeriods.length - 2}`} sx={{ bgcolor: '#999DAA', color: '#fff' }} />\n                    ) : null}\n                  </Stack>\n                </Stack>\n                {dayPeriods.length > 0 ? (\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    {formatRange(dayPeriods[0].startDate, dayPeriods[0].endDate)}\n                  </Typography>\n                ) : (\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    No period\n                  </Typography>\n                )}\n              </Paper>\n            );\n          })}\n        </Box>\n      )}\n    </Paper>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 908, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/services/commits.ts"],"sourcesContent":["export type Commit = {\n  id: string;\n  sport: 'Football' | 'Basketball';\n  list: 'recent' | 'top';\n  rank?: number; // top only\n  name: string;\n  position?: string;\n  stars?: number;\n  university?: string;\n  commitDate?: string; // ISO for recent\n  source?: string;\n  logo?: string;\n  classYear?: string;\n  hometown?: string;\n  highSchool?: string;\n};\n\nconst footballPositions = ['QB', 'RB', 'WR', 'DL', 'LB', 'CB', 'S', 'TE', 'OL'];\nconst basketballPositions = ['PG', 'SG', 'SF', 'PF', 'C'];\nconst sources = ['ESPN', 'Rivals', '247Sports'];\nconst universities = ['Alabama', 'Georgia', 'Ohio State', 'Texas', 'Duke', 'Kentucky', 'Kansas', 'Gonzaga', 'Michigan'];\n\nfunction isoDaysAgo(days: number) {\n  const d = new Date();\n  d.setDate(d.getDate() - days);\n  return d.toISOString().slice(0, 10);\n}\n\nfunction makeRecent(sport: Commit['sport'], prefix: string, positions: string[]): Commit[] {\n  return Array.from({ length: 50 }).map((_, i) => ({\n    id: `${prefix}-${i + 1}`,\n    sport,\n    list: 'recent' as const,\n    name: `${sport} Recent ${i + 1}`,\n    position: positions[i % positions.length],\n    university: universities[i % universities.length],\n    commitDate: isoDaysAgo(i * 5 + 1), // spread across ~250 days\n    source: sources[i % sources.length],\n  }));\n}\n\nfunction makeTop(sport: Commit['sport'], prefix: string, positions: string[]): Commit[] {\n  return Array.from({ length: 50 }).map((_, i) => ({\n    id: `${prefix}-${i + 1}`,\n    sport,\n    list: 'top' as const,\n    rank: i + 1,\n    name: `${sport} Top ${i + 1}`,\n    position: positions[i % positions.length],\n    university: universities[i % universities.length],\n    stars: 5 - (i % 3) || 5,\n    source: sources[i % sources.length],\n  }));\n}\n\nconst SEED: Commit[] = [\n  ...makeRecent('Football', 'fb-rec', footballPositions),\n  ...makeRecent('Basketball', 'bb-rec', basketballPositions),\n  ...makeTop('Football', 'fb-top', footballPositions),\n  ...makeTop('Basketball', 'bb-top', basketballPositions),\n];\n\nlet COMMITS: Commit[] = [...SEED];\nlet SCRAPED_FOOTBALL = false;\nlet SCRAPED_BASKETBALL = false;\n\nexport function listCommits(sport: Commit['sport'], list: Commit['list']) {\n  const filtered = COMMITS.filter((c) => c.sport === sport && c.list === list);\n  if (list === 'recent') {\n    return filtered\n      .sort((a, b) => (b.commitDate || '').localeCompare(a.commitDate || ''))\n      .slice(0, 50);\n  }\n  return filtered\n    .sort((a, b) => (a.rank ?? 9999) - (b.rank ?? 9999))\n    .slice(0, 50);\n}\n\nexport function filterCommits(commits: Commit[], filters: { position?: string; university?: string }) {\n  return commits.filter((c) => {\n    const posMatch = filters.position ? (c.position || '').toLowerCase().includes(filters.position.toLowerCase()) : true;\n    const uniMatch = filters.university ? (c.university || '').toLowerCase().includes(filters.university.toLowerCase()) : true;\n    return posMatch && uniMatch;\n  });\n}\n\nexport function upsertCommits(commits: Commit[]) {\n  COMMITS = commits;\n  return COMMITS;\n}\n\nexport function footballScrapeStatus() {\n  return { scraped: SCRAPED_FOOTBALL };\n}\n\nexport function basketballScrapeStatus() {\n  return { scraped: SCRAPED_BASKETBALL };\n}\n\nexport function listCommitsServer(sport: Commit['sport'], list: Commit['list']) {\n  // server-side version that does not touch localStorage\n  const filtered = COMMITS.filter((c) => c.sport === sport && c.list === list);\n  if (list === 'recent') {\n    return filtered\n      .sort((a, b) => (b.commitDate || '').localeCompare(a.commitDate || ''))\n      .slice(0, 50);\n  }\n  return filtered\n    .sort((a, b) => (a.rank ?? 9999) - (b.rank ?? 9999))\n    .slice(0, 50);\n}\n\n// Load live football data from scraper (server-side only) at startup\nasync function loadFootballFromScrape() {\n  if (typeof window !== 'undefined') return; // client skip\n  try {\n    const { scrapeFootballTop } = await import('./commitsScraper');\n    const top = await scrapeFootballTop();\n    if (top.length) {\n      SCRAPED_FOOTBALL = true;\n      const topMapped: Commit[] = top.slice(0, 50).map((c) => ({\n        id: c.id,\n        sport: 'Football',\n        list: 'top',\n        rank: c.rank,\n        name: c.name,\n        position: c.position,\n        university: c.university,\n        stars: 5,\n        logo: c.logo,\n        classYear: c.classYear,\n        hometown: c.hometown,\n        highSchool: c.highSchool,\n        source: 'ESPN 300',\n      }));\n      const recent: Commit[] = topMapped.map((c, idx) => ({\n        ...c,\n        id: `${c.id}-recent`,\n        list: 'recent',\n        rank: undefined,\n        commitDate: new Date(Date.now() - idx * 24 * 3600 * 1000).toISOString().slice(0, 10),\n      }));\n      // Merge: keep basketball from current store (may be scraped), replace football\n      const existing = COMMITS.filter((c) => c.sport === 'Basketball');\n      COMMITS = [...existing, ...topMapped, ...recent];\n    } else {\n      // mark placeholders so tests can detect non-live data\n      COMMITS = COMMITS.map((c) =>\n        c.sport === 'Football' ? { ...c, name: `${c.name} (placeholder)` } : c\n      );\n    }\n  } catch (e) {\n    // ignore and keep seed\n  }\n}\n\nasync function loadBasketballFromScrape() {\n  if (typeof window !== 'undefined') return; // client skip\n  try {\n    const { scrapeBasketballTop } = await import('./commitsScraper');\n    const top = await scrapeBasketballTop();\n    if (top.length) {\n      SCRAPED_BASKETBALL = true;\n      const topMapped: Commit[] = top.slice(0, 50).map((c) => ({\n        id: c.id,\n        sport: 'Basketball',\n        list: 'top',\n        rank: c.rank,\n        name: c.name,\n        position: c.position,\n        university: c.university,\n        stars: 5,\n        logo: c.logo,\n        classYear: c.classYear,\n        hometown: c.hometown,\n        highSchool: c.highSchool,\n        source: 'ESPN 300',\n      }));\n      const recent: Commit[] = topMapped.map((c, idx) => ({\n        ...c,\n        id: `${c.id}-recent`,\n        list: 'recent',\n        rank: undefined,\n        commitDate: new Date(Date.now() - idx * 24 * 3600 * 1000).toISOString().slice(0, 10),\n      }));\n      // Merge: keep football from current store (may be scraped), replace basketball\n      const existing = COMMITS.filter((c) => c.sport === 'Football');\n      COMMITS = [...existing, ...topMapped, ...recent];\n    } else {\n      COMMITS = COMMITS.map((c) =>\n        c.sport === 'Basketball' ? { ...c, name: `${c.name} (placeholder)` } : c\n      );\n    }\n  } catch (e) {\n    // ignore and keep seed\n  }\n}\n\n// Trigger server-side load\nloadFootballFromScrape();\nloadBasketballFromScrape();\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1058, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/features/commits/CommitsTable.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { Paper, Table, TableHead, TableRow, TableCell, TableBody, TextField, Stack, Typography, Box } from '@mui/material';\nimport { Commit, filterCommits } from '@/services/commits';\n\nexport function CommitsTable({\n  title,\n  rows,\n  showRank,\n  dataTestId,\n}: {\n  title: string;\n  rows: Commit[];\n  showRank?: boolean;\n  dataTestId: string;\n}) {\n  const [position, setPosition] = React.useState('');\n  const [university, setUniversity] = React.useState('');\n\n  const filtered = filterCommits(rows, { position, university });\n\n  return (\n    <Paper variant=\"outlined\" sx={{ p: 2, borderRadius: 2 }}>\n      <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" sx={{ mb: 2 }}>\n        <Typography variant=\"h6\">{title}</Typography>\n        <Stack direction=\"row\" spacing={1}>\n          <TextField\n            size=\"small\"\n            label=\"Position\"\n            value={position}\n            onChange={(e) => setPosition(e.target.value)}\n            data-testid={`${dataTestId}-filter-position`}\n          />\n          <TextField\n            size=\"small\"\n            label=\"University\"\n            value={university}\n            onChange={(e) => setUniversity(e.target.value)}\n            data-testid={`${dataTestId}-filter-university`}\n          />\n        </Stack>\n      </Stack>\n      <Box sx={{ maxHeight: 420, overflow: 'auto' }}>\n        <Table size=\"small\" stickyHeader data-testid={dataTestId}>\n          <TableHead>\n            <TableRow>\n              {showRank && <TableCell>Rank</TableCell>}\n              <TableCell>Name</TableCell>\n              <TableCell>Position</TableCell>\n              <TableCell>University</TableCell>\n              <TableCell>Logo</TableCell>\n              {!showRank && <TableCell>Commit Date</TableCell>}\n              <TableCell>Source</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {filtered.map((c) => (\n              <TableRow key={c.id}>\n                {showRank && <TableCell>{c.rank ?? '-'}</TableCell>}\n                <TableCell>{c.name}</TableCell>\n                <TableCell>{c.position || '-'}</TableCell>\n                <TableCell>{c.university || '-'}</TableCell>\n                <TableCell>\n                  {c.logo ? (\n                    <Box component=\"img\" src={c.logo} alt={c.university || 'logo'} sx={{ width: 28, height: 28, objectFit: 'contain' }} />\n                  ) : (\n                    '-'\n                  )}\n                </TableCell>\n                {!showRank && <TableCell>{c.commitDate || '-'}</TableCell>}\n                <TableCell>{c.source || '-'}</TableCell>\n              </TableRow>\n            ))}\n            {filtered.length === 0 && (\n              <TableRow>\n                <TableCell colSpan={showRank ? 5 : 5} align=\"center\">\n                  No commits match the filters.\n                </TableCell>\n              </TableRow>\n            )}\n          </TableBody>\n        </Table>\n      </Box>\n    </Paper>\n  );\n}\n\n\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAHA;;;;AAKO,SAAS,aAAa,EAC3B,KAAK,EACL,IAAI,EACJ,QAAQ,EACR,UAAU,EAMX;;IACC,MAAM,CAAC,UAAU,YAAY,GAAG,wKAAK,CAAC,QAAQ,CAAC;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,wKAAK,CAAC,QAAQ,CAAC;IAEnD,MAAM,WAAW,IAAA,uIAAa,EAAC,MAAM;QAAE;QAAU;IAAW;IAE5D,qBACE,6LAAC,0MAAK;QAAC,SAAQ;QAAW,IAAI;YAAE,GAAG;YAAG,cAAc;QAAE;;0BACpD,6LAAC,0MAAK;gBAAC,WAAU;gBAAM,gBAAe;gBAAgB,YAAW;gBAAS,IAAI;oBAAE,IAAI;gBAAE;;kCACpF,6LAAC,8NAAU;wBAAC,SAAQ;kCAAM;;;;;;kCAC1B,6LAAC,0MAAK;wBAAC,WAAU;wBAAM,SAAS;;0CAC9B,6LAAC,0NAAS;gCACR,MAAK;gCACL,OAAM;gCACN,OAAO;gCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;gCAC3C,eAAa,GAAG,WAAW,gBAAgB,CAAC;;;;;;0CAE9C,6LAAC,0NAAS;gCACR,MAAK;gCACL,OAAM;gCACN,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;gCAC7C,eAAa,GAAG,WAAW,kBAAkB,CAAC;;;;;;;;;;;;;;;;;;0BAIpD,6LAAC,kMAAG;gBAAC,IAAI;oBAAE,WAAW;oBAAK,UAAU;gBAAO;0BAC1C,cAAA,6LAAC,0MAAK;oBAAC,MAAK;oBAAQ,YAAY;oBAAC,eAAa;;sCAC5C,6LAAC,0NAAS;sCACR,cAAA,6LAAC,sNAAQ;;oCACN,0BAAY,6LAAC,0NAAS;kDAAC;;;;;;kDACxB,6LAAC,0NAAS;kDAAC;;;;;;kDACX,6LAAC,0NAAS;kDAAC;;;;;;kDACX,6LAAC,0NAAS;kDAAC;;;;;;kDACX,6LAAC,0NAAS;kDAAC;;;;;;oCACV,CAAC,0BAAY,6LAAC,0NAAS;kDAAC;;;;;;kDACzB,6LAAC,0NAAS;kDAAC;;;;;;;;;;;;;;;;;sCAGf,6LAAC,0NAAS;;gCACP,SAAS,GAAG,CAAC,CAAC,kBACb,6LAAC,sNAAQ;;4CACN,0BAAY,6LAAC,0NAAS;0DAAE,EAAE,IAAI,IAAI;;;;;;0DACnC,6LAAC,0NAAS;0DAAE,EAAE,IAAI;;;;;;0DAClB,6LAAC,0NAAS;0DAAE,EAAE,QAAQ,IAAI;;;;;;0DAC1B,6LAAC,0NAAS;0DAAE,EAAE,UAAU,IAAI;;;;;;0DAC5B,6LAAC,0NAAS;0DACP,EAAE,IAAI,iBACL,6LAAC,kMAAG;oDAAC,WAAU;oDAAM,KAAK,EAAE,IAAI;oDAAE,KAAK,EAAE,UAAU,IAAI;oDAAQ,IAAI;wDAAE,OAAO;wDAAI,QAAQ;wDAAI,WAAW;oDAAU;;;;;2DAEjH;;;;;;4CAGH,CAAC,0BAAY,6LAAC,0NAAS;0DAAE,EAAE,UAAU,IAAI;;;;;;0DAC1C,6LAAC,0NAAS;0DAAE,EAAE,MAAM,IAAI;;;;;;;uCAbX,EAAE,EAAE;;;;;gCAgBpB,SAAS,MAAM,KAAK,mBACnB,6LAAC,sNAAQ;8CACP,cAAA,6LAAC,0NAAS;wCAAC,SAAS,WAAW,IAAI;wCAAG,OAAM;kDAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUrE;GAhFgB;KAAA"}},
    {"offset": {"line": 1345, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/features/commits/CommitsSection.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { Stack, Typography } from '@mui/material';\nimport { CommitsTable } from './CommitsTable';\nimport { Commit, listCommits } from '@/services/commits';\nimport { useQuery } from '@tanstack/react-query';\n\nasync function fetchCommits(sport: 'Football' | 'Basketball', list: 'recent' | 'top') {\n  const res = await fetch(`/api/commits?sport=${sport}&list=${list}`);\n  if (!res.ok) throw new Error('Failed to load commits');\n  const data = await res.json();\n  return (data?.data as Commit[]) || [];\n}\n\nexport function CommitsSection({ sport }: { sport: 'Football' | 'Basketball' }) {\n  const initialRecent = React.useMemo(() => listCommits(sport, 'recent'), [sport]);\n  const initialTop = React.useMemo(() => listCommits(sport, 'top'), [sport]);\n\n  const baseQueryOpts = {\n    staleTime: 24 * 60 * 60 * 1000, // 24h\n    gcTime: 25 * 60 * 60 * 1000,\n    refetchOnWindowFocus: false,\n    refetchOnMount: 'always' as const,\n  };\n\n  const recentQ = useQuery<Commit[]>({\n    queryKey: ['commits', sport, 'recent'],\n    queryFn: () => fetchCommits(sport, 'recent'),\n    initialData: initialRecent,\n    placeholderData: initialRecent,\n    ...baseQueryOpts,\n  });\n  const topQ = useQuery<Commit[]>({\n    queryKey: ['commits', sport, 'top'],\n    queryFn: () => fetchCommits(sport, 'top'),\n    initialData: initialTop,\n    placeholderData: initialTop,\n    ...baseQueryOpts,\n  });\n\n  return (\n    <Stack spacing={2}>\n      <Typography variant=\"h5\">{sport} Commits</Typography>\n      <CommitsTable\n        title=\"Recent Commits (last 365 days)\"\n        rows={recentQ.data || []}\n        showRank={false}\n        dataTestId={`commits-${sport.toLowerCase()}-recent-table`}\n      />\n      <CommitsTable\n        title=\"Top 50 Recruits\"\n        rows={topQ.data || []}\n        showRank\n        dataTestId={`commits-${sport.toLowerCase()}-top-table`}\n      />\n    </Stack>\n  );\n}\n\n\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AACA;AACA;AACA;;;AALA;;;;;;AAOA,eAAe,aAAa,KAAgC,EAAE,IAAsB;IAClF,MAAM,MAAM,MAAM,MAAM,CAAC,mBAAmB,EAAE,MAAM,MAAM,EAAE,MAAM;IAClE,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,AAAC,MAAM,QAAqB,EAAE;AACvC;AAEO,SAAS,eAAe,EAAE,KAAK,EAAwC;;IAC5E,MAAM,gBAAgB,wKAAK,CAAC,OAAO;iDAAC,IAAM,IAAA,qIAAW,EAAC,OAAO;gDAAW;QAAC;KAAM;IAC/E,MAAM,aAAa,wKAAK,CAAC,OAAO;8CAAC,IAAM,IAAA,qIAAW,EAAC,OAAO;6CAAQ;QAAC;KAAM;IAEzE,MAAM,gBAAgB;QACpB,WAAW,KAAK,KAAK,KAAK;QAC1B,QAAQ,KAAK,KAAK,KAAK;QACvB,sBAAsB;QACtB,gBAAgB;IAClB;IAEA,MAAM,UAAU,IAAA,0LAAQ,EAAW;QACjC,UAAU;YAAC;YAAW;YAAO;SAAS;QACtC,OAAO;gDAAE,IAAM,aAAa,OAAO;;QACnC,aAAa;QACb,iBAAiB;QACjB,GAAG,aAAa;IAClB;IACA,MAAM,OAAO,IAAA,0LAAQ,EAAW;QAC9B,UAAU;YAAC;YAAW;YAAO;SAAM;QACnC,OAAO;6CAAE,IAAM,aAAa,OAAO;;QACnC,aAAa;QACb,iBAAiB;QACjB,GAAG,aAAa;IAClB;IAEA,qBACE,6LAAC,0MAAK;QAAC,SAAS;;0BACd,6LAAC,8NAAU;gBAAC,SAAQ;;oBAAM;oBAAM;;;;;;;0BAChC,6LAAC,uJAAY;gBACX,OAAM;gBACN,MAAM,QAAQ,IAAI,IAAI,EAAE;gBACxB,UAAU;gBACV,YAAY,CAAC,QAAQ,EAAE,MAAM,WAAW,GAAG,aAAa,CAAC;;;;;;0BAE3D,6LAAC,uJAAY;gBACX,OAAM;gBACN,MAAM,KAAK,IAAI,IAAI,EAAE;gBACrB,QAAQ;gBACR,YAAY,CAAC,QAAQ,EAAE,MAAM,WAAW,GAAG,UAAU,CAAC;;;;;;;;;;;;AAI9D;GA3CgB;;QAWE,0LAAQ;QAOX,0LAAQ;;;KAlBP"}},
    {"offset": {"line": 1471, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/dashboard/metrics.ts"],"sourcesContent":["export type MetricsDay = { date: string; sends: number; opens: number; clicks: number };\nexport type MetricsResponse = { days: MetricsDay[]; totals?: { sends: number; opens: number }; openRate?: number };\n\nfunction sliceWindow(days: MetricsDay[], windowSize: number) {\n  const window = Math.max(1, windowSize);\n  const current = days.slice(-window);\n  const previous = days.slice(-window * 2, -window);\n  return { current, previous };\n}\n\nfunction sumDays(days: MetricsDay[], key: 'sends' | 'opens' | 'clicks') {\n  return days.reduce((acc, day) => acc + (Number(day?.[key]) || 0), 0);\n}\n\nfunction percentDelta(current: number, previous: number) {\n  if (previous > 0) return ((current - previous) / previous) * 100;\n  return current > 0 ? 100 : 0;\n}\n\nexport function computeEmailMetrics(\n  stats: MetricsResponse | null,\n  fallbackCount: number,\n  windowDays = 30,\n) {\n  const days = stats?.days ?? [];\n  const { current, previous } = sliceWindow(days, windowDays);\n  const currentSends = sumDays(current, 'sends');\n  const previousSends = sumDays(previous, 'sends');\n  const emailsSent = currentSends || stats?.totals?.sends || fallbackCount || 0;\n  const deltaPct = percentDelta(currentSends, previousSends);\n  return { emailsSent, deltaPct };\n}\n\nexport function computeOpenRateMetrics(\n  stats: MetricsResponse | null,\n  overrideRate: number | undefined,\n  windowDays = 30,\n) {\n  const days = stats?.days ?? [];\n  const { current, previous } = sliceWindow(days, windowDays);\n  const currentSends = sumDays(current, 'sends');\n  const currentOpens = sumDays(current, 'opens');\n  const previousSends = sumDays(previous, 'sends');\n  const previousOpens = sumDays(previous, 'opens');\n\n  const resolvedOverride =\n    Number.isFinite(overrideRate) && (overrideRate as number) >= 0 ? (overrideRate as number) : undefined;\n  const computedRate =\n    currentSends > 0 ? currentOpens / currentSends : stats?.openRate ?? 0;\n  const openRate = resolvedOverride ?? computedRate;\n\n  const previousRate = previousSends > 0 ? previousOpens / previousSends : openRate;\n  const deltaPct = percentDelta(openRate, previousRate);\n\n  return { openRate, deltaPct };\n}\n\nexport function countAddedThisMonth(clients: Array<{ createdAt?: string }>) {\n  const now = new Date();\n  return clients.reduce((acc, client) => {\n    if (!client?.createdAt) return acc;\n    const created = new Date(client.createdAt);\n    if (Number.isNaN(created.getTime())) return acc;\n    return created.getFullYear() === now.getFullYear() && created.getMonth() === now.getMonth()\n      ? acc + 1\n      : acc;\n  }, 0);\n}\n\nexport function formatDelta(deltaPct: number) {\n  const rounded = Math.round(deltaPct || 0);\n  return `${rounded >= 0 ? '+' : ''}${rounded}%`;\n}\n\n"],"names":[],"mappings":";;;;;;;;;;AAGA,SAAS,YAAY,IAAkB,EAAE,UAAkB;IACzD,MAAM,SAAS,KAAK,GAAG,CAAC,GAAG;IAC3B,MAAM,UAAU,KAAK,KAAK,CAAC,CAAC;IAC5B,MAAM,WAAW,KAAK,KAAK,CAAC,CAAC,SAAS,GAAG,CAAC;IAC1C,OAAO;QAAE;QAAS;IAAS;AAC7B;AAEA,SAAS,QAAQ,IAAkB,EAAE,GAAiC;IACpE,OAAO,KAAK,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,CAAC,OAAO,KAAK,CAAC,IAAI,KAAK,CAAC,GAAG;AACpE;AAEA,SAAS,aAAa,OAAe,EAAE,QAAgB;IACrD,IAAI,WAAW,GAAG,OAAO,AAAC,CAAC,UAAU,QAAQ,IAAI,WAAY;IAC7D,OAAO,UAAU,IAAI,MAAM;AAC7B;AAEO,SAAS,oBACd,KAA6B,EAC7B,aAAqB,EACrB,aAAa,EAAE;IAEf,MAAM,OAAO,OAAO,QAAQ,EAAE;IAC9B,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,YAAY,MAAM;IAChD,MAAM,eAAe,QAAQ,SAAS;IACtC,MAAM,gBAAgB,QAAQ,UAAU;IACxC,MAAM,aAAa,gBAAgB,OAAO,QAAQ,SAAS,iBAAiB;IAC5E,MAAM,WAAW,aAAa,cAAc;IAC5C,OAAO;QAAE;QAAY;IAAS;AAChC;AAEO,SAAS,uBACd,KAA6B,EAC7B,YAAgC,EAChC,aAAa,EAAE;IAEf,MAAM,OAAO,OAAO,QAAQ,EAAE;IAC9B,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,YAAY,MAAM;IAChD,MAAM,eAAe,QAAQ,SAAS;IACtC,MAAM,eAAe,QAAQ,SAAS;IACtC,MAAM,gBAAgB,QAAQ,UAAU;IACxC,MAAM,gBAAgB,QAAQ,UAAU;IAExC,MAAM,mBACJ,OAAO,QAAQ,CAAC,iBAAiB,AAAC,gBAA2B,IAAK,eAA0B;IAC9F,MAAM,eACJ,eAAe,IAAI,eAAe,eAAe,OAAO,YAAY;IACtE,MAAM,WAAW,oBAAoB;IAErC,MAAM,eAAe,gBAAgB,IAAI,gBAAgB,gBAAgB;IACzE,MAAM,WAAW,aAAa,UAAU;IAExC,OAAO;QAAE;QAAU;IAAS;AAC9B;AAEO,SAAS,oBAAoB,OAAsC;IACxE,MAAM,MAAM,IAAI;IAChB,OAAO,QAAQ,MAAM,CAAC,CAAC,KAAK;QAC1B,IAAI,CAAC,QAAQ,WAAW,OAAO;QAC/B,MAAM,UAAU,IAAI,KAAK,OAAO,SAAS;QACzC,IAAI,OAAO,KAAK,CAAC,QAAQ,OAAO,KAAK,OAAO;QAC5C,OAAO,QAAQ,WAAW,OAAO,IAAI,WAAW,MAAM,QAAQ,QAAQ,OAAO,IAAI,QAAQ,KACrF,MAAM,IACN;IACN,GAAG;AACL;AAEO,SAAS,YAAY,QAAgB;IAC1C,MAAM,UAAU,KAAK,KAAK,CAAC,YAAY;IACvC,OAAO,GAAG,WAAW,IAAI,MAAM,KAAK,QAAQ,CAAC,CAAC;AAChD"}},
    {"offset": {"line": 1546, "column": 0}, "map": {"version":3,"sources":["file:///Users/mrjames/Desktop/athletenarrative/web/web-app/app/%28app%29/dashboard/page.tsx"],"sourcesContent":["'use client';\nimport React from 'react';\nimport { useSession } from '@/features/auth/session';\nimport { useQuery } from '@tanstack/react-query';\nimport { listAgencies } from '@/services/agencies';\nimport { listClientsByAgencyEmail } from '@/services/clients';\nimport { Typography, Box, Skeleton, Stack } from '@mui/material';\nimport { DataGrid, GridColDef } from '@mui/x-data-grid';\nimport { getMailEntries } from '@/services/mailStatus';\nimport { getScholarships, setScholarships } from '@/services/scholarships';\nimport { IoMailOpenOutline, IoPaperPlaneOutline, IoPersonAddOutline, IoTrendingUpOutline, IoFastFoodOutline } from 'react-icons/io5';\nimport { MetricCard } from './MetricCard';\nimport { RecruitingCalendarCard } from '@/features/recruiter/RecruitingCalendarCard';\nimport { CommitsSection } from '@/features/commits/CommitsSection';\nimport { computeEmailMetrics, computeOpenRateMetrics, countAddedThisMonth, formatDelta, type MetricsResponse } from './metrics';\n\ntype MailEntry = { clientId?: string };\n\nexport default function DashboardPage() {\n  const { session } = useSession();\n  const isParent = session?.role === 'parent';\n  const q = useQuery<any[]>({\n    queryKey: ['dashboard', session?.role, session?.agencyId],\n    queryFn: () => isParent ? listAgencies() : listClientsByAgencyEmail(session!.email),\n    enabled: !!session && (isParent || !!session?.email),\n  });\n  const [schInput, setSchInput] = React.useState<string>('');\n  const [metrics, setMetrics] = React.useState<MetricsResponse | null>(null);\n  const isLoading = q.isInitialLoading;\n\n  React.useEffect(() => {\n    if (!session?.email || isParent) return;\n    if (typeof window === 'undefined' || typeof fetch === 'undefined') return;\n    // load computed stats from server\n    fetch(`/api/metrics/stats?agencyEmail=${encodeURIComponent(session.email)}&days=60`)\n      .then(r => r.json())\n      .then(d => {\n        if (d?.ok) {\n          setMetrics(d);\n        }\n      })\n      .catch(() => {});\n    setSchInput(String(getScholarships(session.email)));\n  }, [session?.email, isParent]);\n  if (!session) return null;\n\n  if (isParent) {\n    const rows = q.data ?? [];\n    const columns: GridColDef[] = [{ field: 'name', headerName: 'Agency', flex: 1 }];\n    return (\n      <>\n        <Typography variant=\"h4\" gutterBottom>Dashboard</Typography>\n        <div style={{ height: 520 }}>\n          <DataGrid\n            rows={rows as any[]}\n            columns={columns}\n            getRowId={(r)=>r.id}\n            loading={isLoading}\n          />\n        </div>\n      </>\n    );\n  }\n\n  // Agency dashboard\n  const clients = (q.data ?? []) as any[];\n  const clientIds = new Set<string>(clients.map(c => c.id));\n  const totalClients = clients.length;\n\n  // Emails sent (count mail logs whose clientId belongs to this agency)\n  const mail = (getMailEntries() as MailEntry[]).filter((m) => m.clientId && clientIds.has(m.clientId));\n  const emailsFallback = mail.length;\n\n  const placeholderRate = Number(process.env.NEXT_PUBLIC_OPEN_RATE_PLACEHOLDER ?? '');\n  const { emailsSent, deltaPct: emailsDelta } = computeEmailMetrics(metrics, emailsFallback);\n  const { openRate, deltaPct: openRateDelta } = computeOpenRateMetrics(\n    metrics,\n    Number.isFinite(placeholderRate) ? placeholderRate : undefined,\n  );\n  const addedThisMonth = countAddedThisMonth(clients);\n\n  // Grad year breakdown: current year..current+3 (inclusive)\n  const thisYear = new Date().getFullYear();\n  const years = [thisYear, thisYear + 1, thisYear + 2, thisYear + 3];\n  const byYear: Record<number, number> = { [years[0]]: 0, [years[1]]: 0, [years[2]]: 0, [years[3]]: 0 };\n  clients.forEach(c => {\n    const gy = Number(c?.radar?.graduationYear || c?.graduationYear || 0);\n    if (years.includes(gy)) byYear[gy] = (byYear[gy] || 0) + 1;\n  });\n\n  function saveScholarships() {\n    if (!session?.email) return;\n    setScholarships(session.email, Number(schInput) || 0);\n    setSchInput(String(getScholarships(session.email)));\n  }\n\n  return (\n    <>\n      <Typography variant=\"h4\" gutterBottom>Dashboard</Typography>\n\n      {isLoading ? (\n        <Skeleton variant=\"rectangular\" height={260} sx={{ mb: 3, borderRadius: 2 }} />\n      ) : (\n      <RecruitingCalendarCard />\n      )}\n\n      {isLoading ? (\n        <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(3, 1fr)' }, gap: 2, mb: 3 }}>\n          {[1, 2, 3].map((k) => (\n            <Skeleton key={k} variant=\"rectangular\" height={140} sx={{ borderRadius: 2 }} />\n          ))}\n        </Box>\n      ) : (\n      <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(3, 1fr)' }, gap: 2, mb: 3 }}>\n        <MetricCard\n          title=\"Emails Sent\"\n          value={emailsSent}\n          icon={<IoPaperPlaneOutline size={20} />}\n          footer={\n            <>\n              <IoTrendingUpOutline color=\"#15b79f\" size={18} />\n              <Typography variant=\"body2\" sx={{ color: '#667085' }}>\n                <Box component=\"span\" sx={{ color: '#15b79f' }}>{formatDelta(emailsDelta)}</Box> vs last 30d\n              </Typography>\n            </>\n          }\n        />\n        <MetricCard\n          title=\"Open Rate\"\n          value={`${Math.round((openRate || 0) * 100)}%`}\n          icon={<IoMailOpenOutline size={20} />}\n          footer={\n            <>\n              <IoTrendingUpOutline color=\"#15b79f\" size={18} />\n              <Typography variant=\"body2\" sx={{ color: '#667085' }}>\n                <Box component=\"span\" sx={{ color: '#15b79f' }}>{formatDelta(openRateDelta)}</Box> vs last 30d\n              </Typography>\n            </>\n          }\n        />\n        <MetricCard\n          title=\"Total Athletes\"\n          value={totalClients}\n          icon={<IoPersonAddOutline size={20} />}\n          footer={\n            <>\n              <IoTrendingUpOutline color=\"#15b79f\" size={18} />\n              <Typography variant=\"body2\" sx={{ color: '#667085' }}>\n                <Box component=\"span\" sx={{ color: '#15b79f' }}>+{addedThisMonth}</Box> added this month\n              </Typography>\n            </>\n          }\n        />\n      </Box>\n      )}\n\n      {isLoading ? (\n        <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(4, 1fr)' }, gap: 2, mb: 3 }}>\n          {[1, 2, 3, 4].map((k) => (\n            <Skeleton key={k} variant=\"rectangular\" height={120} sx={{ borderRadius: 2 }} />\n          ))}\n        </Box>\n      ) : (\n      <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(4, 1fr)' }, gap: 2, mb: 3 }}>\n        {years.map((y, idx) => (\n          <MetricCard\n            key={y}\n            title={`Class of ${y}`}\n            value={byYear[y] || 0}\n            icon={<IoFastFoodOutline size={20} />}\n            bgColor={idx === 0 ? '#5D4AFB' : undefined}\n            textColor={idx === 0 ? '#FFFFFF' : undefined}\n            bgImage={idx === 0 ? '/marketing/bg-an.png' : undefined}\n          />\n        ))}\n      </Box>\n      )}\n\n      <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: '1fr 1fr' }, gap: 3, mb: 4 }}>\n        <CommitsSection sport=\"Football\" />\n        <CommitsSection sport=\"Basketball\" />\n      </Box>\n    </>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}