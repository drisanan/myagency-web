(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3566,56846,33329,59991,e=>{"use strict";var t=e.i(81974);e.s(["Dialog",()=>t.default],3566);var a=e.i(10081);e.s(["DialogActions",()=>a.default],56846);var i=e.i(39126);e.s(["DialogContent",()=>i.default],33329);var l=e.i(24167);e.s(["DialogTitle",()=>l.default],59991)},76418,e=>{"use strict";var t=e.i(54616),a=e.i(66027),i=e.i(12598);async function l(e,t){let a=new URLSearchParams;a.set("agencyEmail",e),t&&a.set("athleteId",t);let i=await fetch(`/api/tasks?${a.toString()}`),l=await i.json();return l?.data||[]}async function s(e,t){let a=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,agencyEmail:e})});if(!a.ok)throw Error("Failed to create task");return a.json()}async function n(e,t){let a=await fetch("/api/tasks",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,agencyEmail:e})});if(!a.ok)throw Error("Failed to update task");return a.json()}async function r(e,t){let a=await fetch("/api/tasks",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,agencyEmail:e})});if(!a.ok)throw Error("Failed to delete task");return a.json()}function o(e,o){let c=(0,i.useQueryClient)(),d=["tasks",e,o||"all"],u=(0,a.useQuery)({queryKey:d,enabled:!!e,queryFn:()=>l(e,o)}),h=(0,t.useMutation)({mutationFn:t=>s(e,t),onSuccess:()=>c.invalidateQueries({queryKey:d})}),p=(0,t.useMutation)({mutationFn:t=>n(e,t),onSuccess:()=>c.invalidateQueries({queryKey:d})}),g=(0,t.useMutation)({mutationFn:t=>r(e,t),onSuccess:()=>c.invalidateQueries({queryKey:d})});return{query:u,tasks:u.data??[],createTask:h.mutateAsync,updateTask:p.mutateAsync,deleteTask:g.mutateAsync,creating:"pending"===h.status,updating:"pending"===p.status,deleting:"pending"===g.status}}e.s(["useTasks",()=>o])},11152,e=>{"use strict";var t=e.i(40141);function a(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(e)}function i(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function l(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function s(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 348.106V80c0-26.51-21.49-48-48-48H48C21.49 32 0 53.49 0 80v351.988c0 26.51 21.49 48 48 48h268.118a48 48 0 0 0 33.941-14.059l83.882-83.882A48 48 0 0 0 448 348.106zm-128 80v-76.118h76.118L320 428.106zM400 80v223.988H296c-13.255 0-24 10.745-24 24v104H48V80h352z"},child:[]}]})(e)}e.s(["FaBell",()=>a,"FaEdit",()=>i,"FaRegStickyNote",()=>s,"FaTrash",()=>l])},87345,e=>{"use strict";var t=e.i(43476),a=e.i(71645),i=e.i(76552),l=e.i(34251),s=e.i(97555),n=e.i(3566),r=e.i(56846),o=e.i(33329),c=e.i(59991),d=e.i(69120),u=e.i(11458),h=e.i(32963),p=e.i(63745),g=e.i(69437),x=e.i(66796),v=e.i(76418),m=e.i(11152),y=e.i(33906),f=e.i(66027),j=e.i(90349);let k=[{value:"todo",label:"To do"},{value:"in-progress",label:"In progress"},{value:"done",label:"Done"}];function T({athleteId:e}){let{session:T}=(0,y.useSession)(),S=T?.email||"",{tasks:b,query:C,createTask:w,updateTask:I,deleteTask:A}=(0,v.useTasks)(S,e),F=(0,f.useQuery)({queryKey:["tasks-clients",S],queryFn:()=>(0,j.listClientsByAgencyEmail)(S),enabled:!!(S&&!e)}),[D,z]=a.default.useState(!1),[B,E]=a.default.useState(null),[M,H]=a.default.useState(""),[L,N]=a.default.useState(""),[P,O]=a.default.useState("todo"),[V,Q]=a.default.useState(""),[q,R]=a.default.useState(""),[W,G]=a.default.useState(""),U=async()=>{if(!M.trim())return void G("Title is required");let t=V?new Date(V).getTime():void 0;B?await I({id:B,title:M.trim(),description:L,status:P,dueAt:t??null}):await w({title:M.trim(),description:L,status:P,dueAt:t,athleteId:(e??q)||null}),z(!1)},$=async e=>{await A(e)},J=a.default.useMemo(()=>{let e={};return(F.data||[]).forEach(t=>{e[t.id]=`${t.firstName||""} ${t.lastName||""}`.trim()||t.id}),e},[F.data]);return(0,t.jsxs)(i.Box,{children:[(0,t.jsxs)(p.Stack,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[(0,t.jsx)(x.Typography,{variant:"h6",children:"Tasks"}),(0,t.jsx)(l.Button,{variant:"contained",onClick:()=>{E(null),H(""),N(""),O("todo"),Q(""),R(""),G(""),z(!0)},startIcon:(0,t.jsx)(m.FaBell,{}),children:"Add task"})]}),C.isLoading?(0,t.jsx)(x.Typography,{children:"Loading..."}):0===b.length?(0,t.jsx)(x.Typography,{color:"text.secondary",children:"No tasks yet."}):(0,t.jsx)(p.Stack,{spacing:1.5,children:b.map(e=>(0,t.jsxs)(h.Paper,{variant:"outlined",sx:{p:1.5,display:"flex",gap:1,alignItems:"flex-start"},"data-testid":"task-item",children:[(0,t.jsxs)(p.Stack,{spacing:.5,sx:{flex:1,minWidth:0},children:[(0,t.jsxs)(p.Stack,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap"},children:[(0,t.jsx)(s.Chip,{size:"small",label:k.find(t=>t.value===e.status)?.label||e.status}),e.dueAt?(0,t.jsx)(s.Chip,{size:"small",color:"warning",label:`Due ${new Date(e.dueAt).toLocaleString()}`}):null,e.athleteId&&J[e.athleteId]?(0,t.jsx)(s.Chip,{size:"small",label:J[e.athleteId]}):null]}),(0,t.jsx)(x.Typography,{variant:"subtitle1",sx:{fontWeight:700},children:e.title}),e.description?(0,t.jsx)(x.Typography,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-wrap"},children:e.description}):null]}),(0,t.jsxs)(p.Stack,{direction:"row",spacing:1,children:[(0,t.jsx)(d.IconButton,{"aria-label":"Edit task",onClick:()=>{var t;let a;return t=e.id,void((a=b.find(e=>e.id===t))&&(E(t),H(a.title),N(a.description||""),O(a.status),Q(a.dueAt?new Date(a.dueAt).toISOString().slice(0,16):""),R(a.athleteId||""),G(""),z(!0)))},size:"small",children:(0,t.jsx)(m.FaEdit,{})}),(0,t.jsx)(d.IconButton,{"aria-label":"Delete task",onClick:()=>$(e.id),size:"small",children:(0,t.jsx)(m.FaTrash,{})})]})]},e.id))}),(0,t.jsxs)(n.Dialog,{open:D,onClose:()=>z(!1),fullWidth:!0,maxWidth:"sm",children:[(0,t.jsx)(c.DialogTitle,{children:B?"Edit task":"Add task"}),(0,t.jsxs)(o.DialogContent,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,t.jsx)(g.TextField,{label:"Title",value:M,onChange:e=>H(e.target.value),required:!0}),(0,t.jsx)(g.TextField,{label:"Description",value:L,onChange:e=>N(e.target.value),multiline:!0,minRows:3}),e?null:(0,t.jsxs)(g.TextField,{select:!0,label:"Assign athlete (optional)",value:q,onChange:e=>R(e.target.value),SelectProps:{displayEmpty:!0},children:[(0,t.jsx)(u.MenuItem,{value:"",children:"Unassigned"}),(F.data||[]).map(e=>(0,t.jsxs)(u.MenuItem,{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]}),(0,t.jsx)(g.TextField,{select:!0,label:"Status",value:P,onChange:e=>O(e.target.value),children:k.map(e=>(0,t.jsx)(u.MenuItem,{value:e.value,children:e.label},e.value))}),(0,t.jsx)(g.TextField,{label:"Due date/time",type:"datetime-local",value:V,onChange:e=>Q(e.target.value),InputLabelProps:{shrink:!0}}),W?(0,t.jsx)(x.Typography,{color:"error",variant:"body2",children:W}):null]}),(0,t.jsxs)(r.DialogActions,{children:[(0,t.jsx)(l.Button,{onClick:()=>z(!1),children:"Cancel"}),(0,t.jsx)(l.Button,{variant:"contained",onClick:U,children:"Save"})]})]})]})}e.s(["TasksPanel",()=>T])}]);